{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5812528536344568, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0054977935178612825, "policy_loss": -0.01778133366072628, "vf_loss": 0.00936414930135167, "vf_explained_var": 0.35736439358443023, "kl": 0.014596951495857288, "entropy": 1.9315765481442213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.3285252148169, "num_env_steps_trained_throughput_per_sec": 217.3285252148169, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 18405.097, "sample_time_ms": 11430.445, "learn_time_ms": 6928.94, "learn_throughput": 577.289, "synch_weights_time_ms": 44.938}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "80fdd_00000", "date": "2023-09-10_13-00-31", "timestamp": 1694365231, "time_this_iter_s": 18.410889863967896, "time_total_s": 18.410889863967896, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1346ada60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 18.410889863967896, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 33.082142857142856, "ram_util_percent": 31.814285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6672880465940882, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013419797072856454, "policy_loss": -0.0203448740770303, "vf_loss": 0.004008530709082455, "vf_explained_var": 0.04901993405073881, "kl": 0.01458272993542623, "entropy": 1.9256060261279344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.83077587612172, "num_env_steps_trained_throughput_per_sec": 233.83077587612172, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17755.732, "sample_time_ms": 10699.86, "learn_time_ms": 7009.668, "learn_throughput": 570.64, "synch_weights_time_ms": 45.507}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "80fdd_00000", "date": "2023-09-10_13-00-49", "timestamp": 1694365249, "time_this_iter_s": 17.11135482788086, "time_total_s": 35.522244691848755, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1346ad0d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35.522244691848755, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.66, "ram_util_percent": 31.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8539173111009101, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017669933249150442, "policy_loss": -0.022084508650004865, "vf_loss": 0.001318008729685971, "vf_explained_var": 0.5071933439001441, "kl": 0.015482835087039367, "entropy": 1.886125694712003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.89743421309313, "num_env_steps_trained_throughput_per_sec": 241.89743421309313, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17349.126, "sample_time_ms": 10242.68, "learn_time_ms": 7061.878, "learn_throughput": 566.422, "synch_weights_time_ms": 43.914}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "80fdd_00000", "date": "2023-09-10_13-01-07", "timestamp": 1694365267, "time_this_iter_s": 16.53994607925415, "time_total_s": 52.062190771102905, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x134448f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 52.062190771102905, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.553846153846152, "ram_util_percent": 31.84230769230769}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9830647677804033, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011741873861319618, "policy_loss": -0.022194423554659202, "vf_loss": 0.0075507722947804725, "vf_explained_var": 0.6371517529090246, "kl": 0.01450888799470245, "entropy": 1.8502902840574582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}}, "episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.58899389910016, "num_env_steps_trained_throughput_per_sec": 235.58899389910016, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17256.52, "sample_time_ms": 10162.031, "learn_time_ms": 7050.32, "learn_throughput": 567.35, "synch_weights_time_ms": 43.501}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "80fdd_00000", "date": "2023-09-10_13-01-26", "timestamp": 1694365286, "time_this_iter_s": 16.986087799072266, "time_total_s": 69.04827857017517, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352045e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 69.04827857017517, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 25.946153846153848, "ram_util_percent": 31.957692307692305}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9868753268693884, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.019662766232734916, "policy_loss": -0.02369219634322993, "vf_loss": 0.0006298479638038164, "vf_explained_var": -0.15857420954853296, "kl": 0.016997914173827646, "entropy": 1.8173906811823448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}}, "episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.6419082953349, "num_env_steps_trained_throughput_per_sec": 230.6419082953349, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 17273.793, "sample_time_ms": 10201.135, "learn_time_ms": 7028.235, "learn_throughput": 569.133, "synch_weights_time_ms": 43.777}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "80fdd_00000", "date": "2023-09-10_13-01-45", "timestamp": 1694365305, "time_this_iter_s": 17.34796690940857, "time_total_s": 86.39624547958374, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135204a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 86.39624547958374, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.13214285714286, "ram_util_percent": 32.15714285714285}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0130715681239963, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01825221693094742, "policy_loss": -0.021721095681520333, "vf_loss": 0.00028952360033448105, "vf_explained_var": -0.2188731413334608, "kl": 0.015896778960776223, "entropy": 1.7891809372852245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}}, "episode_reward_max": -1.070000000000001, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -1.183000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -1.070000000000001}, "policy_reward_mean": {"red_0": -1.183000000000001}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42138049038107284, "mean_inference_ms": 1.8247736014104645, "mean_action_processing_ms": 0.11142490060533454, "mean_env_wait_ms": 0.16331474606801685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10908842086791992, "StateBufferConnector_ms": 0.008988380432128906, "ViewRequirementAgentConnector_ms": 0.1240086555480957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.00429928023928, "num_env_steps_trained_throughput_per_sec": 234.00429928023928, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 17243.774, "sample_time_ms": 10174.668, "learn_time_ms": 7024.973, "learn_throughput": 569.397, "synch_weights_time_ms": 43.473}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 10, "training_iteration": 6, "trial_id": "80fdd_00000", "date": "2023-09-10_13-02-04", "timestamp": 1694365324, "time_this_iter_s": 17.09884810447693, "time_total_s": 103.49509358406067, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13522ee50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 103.49509358406067, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.222222222222218, "ram_util_percent": 32.16666666666667}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1230402143051228, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006660719716213255, "policy_loss": -0.0188538917383994, "vf_loss": 0.009502225809410448, "vf_explained_var": 0.48394405624518794, "kl": 0.013454730981737847, "entropy": 1.7699086376776298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -0.26000000000000034, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.7880000000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -0.26000000000000034}, "policy_reward_mean": {"red_0": -0.7880000000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204915852426144, "mean_inference_ms": 1.8211256797459405, "mean_action_processing_ms": 0.111098090633256, "mean_env_wait_ms": 0.16227781118177426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10571002960205078, "StateBufferConnector_ms": 0.008716583251953125, "ViewRequirementAgentConnector_ms": 0.12247562408447266}}, "episode_reward_max": -0.26000000000000034, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.7880000000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": -0.26000000000000034}, "policy_reward_mean": {"red_0": -0.7880000000000007}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204915852426144, "mean_inference_ms": 1.8211256797459405, "mean_action_processing_ms": 0.111098090633256, "mean_env_wait_ms": 0.16227781118177426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10571002960205078, "StateBufferConnector_ms": 0.008716583251953125, "ViewRequirementAgentConnector_ms": 0.12247562408447266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.6944584583904, "num_env_steps_trained_throughput_per_sec": 241.6944584583904, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 17144.635, "sample_time_ms": 10110.26, "learn_time_ms": 6990.452, "learn_throughput": 572.209, "synch_weights_time_ms": 43.271}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "80fdd_00000", "date": "2023-09-10_13-02-23", "timestamp": 1694365343, "time_this_iter_s": 16.555941104888916, "time_total_s": 120.05103468894958, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13456e550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 120.05103468894958, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.477777777777778, "ram_util_percent": 32.10370370370371}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1579818326358995, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01069269169359662, "policy_loss": -0.019679910251337182, "vf_loss": 0.006445998724908956, "vf_explained_var": 0.3217247329031428, "kl": 0.012706098864183939, "entropy": 1.7379362874974806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.706770833333334, "episode_len_mean": 1246.2857142857142, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.706770833333334}, "custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42017765134092144, "mean_inference_ms": 1.8174503553664796, "mean_action_processing_ms": 0.11102444759156327, "mean_env_wait_ms": 0.161860008328531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10391871134440105, "StateBufferConnector_ms": 0.008520625886462983, "ViewRequirementAgentConnector_ms": 0.12212821415492467}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.706770833333334, "episode_len_mean": 1246.2857142857142, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.706770833333334}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42017765134092144, "mean_inference_ms": 1.8174503553664796, "mean_action_processing_ms": 0.11102444759156327, "mean_env_wait_ms": 0.161860008328531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10391871134440105, "StateBufferConnector_ms": 0.008520625886462983, "ViewRequirementAgentConnector_ms": 0.12212821415492467}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.7925217356101, "num_env_steps_trained_throughput_per_sec": 243.7925217356101, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 17052.478, "sample_time_ms": 10043.63, "learn_time_ms": 6965.144, "learn_throughput": 574.288, "synch_weights_time_ms": 43.06}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 21, "training_iteration": 8, "trial_id": "80fdd_00000", "date": "2023-09-10_13-02-41", "timestamp": 1694365361, "time_this_iter_s": 16.412657976150513, "time_total_s": 136.4636926651001, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13449d8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 136.4636926651001, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.896153846153844, "ram_util_percent": 32.15384615384615}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1713633310670655, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015716337392344334, "policy_loss": -0.01892621300163834, "vf_loss": 0.0004671081218020845, "vf_explained_var": -0.47897118932257093, "kl": 0.013713836501330796, "entropy": 1.7026629312584798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.706770833333334, "episode_len_mean": 1246.2857142857142, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.706770833333334}, "custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42017765134092144, "mean_inference_ms": 1.8174503553664796, "mean_action_processing_ms": 0.11102444759156327, "mean_env_wait_ms": 0.161860008328531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10391871134440105, "StateBufferConnector_ms": 0.008520625886462983, "ViewRequirementAgentConnector_ms": 0.12212821415492467}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.706770833333334, "episode_len_mean": 1246.2857142857142, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.706770833333334}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42017765134092144, "mean_inference_ms": 1.8174503553664796, "mean_action_processing_ms": 0.11102444759156327, "mean_env_wait_ms": 0.161860008328531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10391871134440105, "StateBufferConnector_ms": 0.008520625886462983, "ViewRequirementAgentConnector_ms": 0.12212821415492467}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.01092731635103, "num_env_steps_trained_throughput_per_sec": 240.01092731635103, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 17009.523, "sample_time_ms": 10026.092, "learn_time_ms": 6939.971, "learn_throughput": 576.371, "synch_weights_time_ms": 42.82}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 21, "training_iteration": 9, "trial_id": "80fdd_00000", "date": "2023-09-10_13-03-00", "timestamp": 1694365380, "time_this_iter_s": 16.671045780181885, "time_total_s": 153.13473844528198, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1345b3040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 153.13473844528198, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.218518518518515, "ram_util_percent": 32.05185185185185}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2013437499913076, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01472754343994893, "policy_loss": -0.01926222962429165, "vf_loss": 0.0021749484752641973, "vf_explained_var": 0.6912901252508163, "kl": 0.011798690369642638, "entropy": 1.6357313877592483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.45366927083333397, "episode_len_mean": 1256.3, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.45366927083333397}, "custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41837197253117553, "mean_inference_ms": 1.8144339341053144, "mean_action_processing_ms": 0.1104845281720853, "mean_env_wait_ms": 0.1611320224253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10379234949747722, "StateBufferConnector_ms": 0.008530616760253906, "ViewRequirementAgentConnector_ms": 0.1224970817565918}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.45366927083333397, "episode_len_mean": 1256.3, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.45366927083333397}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41837197253117553, "mean_inference_ms": 1.8144339341053144, "mean_action_processing_ms": 0.1104845281720853, "mean_env_wait_ms": 0.1611320224253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10379234949747722, "StateBufferConnector_ms": 0.008530616760253906, "ViewRequirementAgentConnector_ms": 0.1224970817565918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.42008444415669, "num_env_steps_trained_throughput_per_sec": 240.42008444415669, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 16972.324, "sample_time_ms": 10008.183, "learn_time_ms": 6920.508, "learn_throughput": 577.992, "synch_weights_time_ms": 42.996}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "80fdd_00000", "date": "2023-09-10_13-03-19", "timestamp": 1694365399, "time_this_iter_s": 16.643664121627808, "time_total_s": 169.7784025669098, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1346adf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 169.7784025669098, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.57692307692308, "ram_util_percent": 32.13076923076923}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3151819684542716, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006558449349540751, "policy_loss": -0.013486090418882667, "vf_loss": 0.00507435922906249, "vf_explained_var": 0.4348330253114303, "kl": 0.009266410194734924, "entropy": 1.613458914682269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.45366927083333397, "episode_len_mean": 1256.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.45366927083333397}, "custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41837197253117553, "mean_inference_ms": 1.8144339341053144, "mean_action_processing_ms": 0.1104845281720853, "mean_env_wait_ms": 0.1611320224253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10379234949747722, "StateBufferConnector_ms": 0.008530616760253906, "ViewRequirementAgentConnector_ms": 0.1224970817565918}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.45366927083333397, "episode_len_mean": 1256.3, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.45366927083333397}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41837197253117553, "mean_inference_ms": 1.8144339341053144, "mean_action_processing_ms": 0.1104845281720853, "mean_env_wait_ms": 0.1611320224253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10379234949747722, "StateBufferConnector_ms": 0.008530616760253906, "ViewRequirementAgentConnector_ms": 0.1224970817565918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.90390121226523, "num_env_steps_trained_throughput_per_sec": 233.90390121226523, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 16841.913, "sample_time_ms": 9843.481, "learn_time_ms": 6955.156, "learn_throughput": 575.113, "synch_weights_time_ms": 42.619}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "80fdd_00000", "date": "2023-09-10_13-03-38", "timestamp": 1694365418, "time_this_iter_s": 17.10718321800232, "time_total_s": 186.8855857849121, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1346ad700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 186.8855857849121, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.928571428571434, "ram_util_percent": 32.089285714285715}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06451612903225806, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.355148731606702, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013916286456151283, "policy_loss": -0.017509088183578568, "vf_loss": 0.00031995516510505693, "vf_explained_var": -0.26145726249863704, "kl": 0.016364233160614274, "entropy": 1.5862057102223237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.4338734879032264, "episode_len_mean": 1257.0645161290322, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.4338734879032264}, "custom_metrics": {"red_0/door_open_done_mean": 0.06451612903225806, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418135868563873, "mean_inference_ms": 1.8123612773901383, "mean_action_processing_ms": 0.11042331836853547, "mean_env_wait_ms": 0.16092363715995256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10325908660888672, "StateBufferConnector_ms": 0.008406177643806703, "ViewRequirementAgentConnector_ms": 0.12224258915070564}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.4338734879032264, "episode_len_mean": 1257.0645161290322, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.4338734879032264}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418135868563873, "mean_inference_ms": 1.8123612773901383, "mean_action_processing_ms": 0.11042331836853547, "mean_env_wait_ms": 0.16092363715995256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10325908660888672, "StateBufferConnector_ms": 0.008406177643806703, "ViewRequirementAgentConnector_ms": 0.12224258915070564}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.67833895166177, "num_env_steps_trained_throughput_per_sec": 236.67833895166177, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 16821.331, "sample_time_ms": 9841.96, "learn_time_ms": 6936.273, "learn_throughput": 576.679, "synch_weights_time_ms": 42.443}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 31, "training_iteration": 12, "trial_id": "80fdd_00000", "date": "2023-09-10_13-03-58", "timestamp": 1694365438, "time_this_iter_s": 16.906620740890503, "time_total_s": 203.7922065258026, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13449d0d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 203.7922065258026, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.085185185185182, "ram_util_percent": 32.07407407407408}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1621753677725792, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020883394736180585, "policy_loss": -0.02497455680835022, "vf_loss": 0.002082533754886147, "vf_explained_var": 0.8344109521557888, "kl": 0.0100431386600813, "entropy": 1.5857745035241047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.2655019531250005, "episode_len_mean": 1262.225, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.2655019531250005}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41712672929349087, "mean_inference_ms": 1.810626159007522, "mean_action_processing_ms": 0.1101204074193309, "mean_env_wait_ms": 0.16048934618968952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10031759738922119, "StateBufferConnector_ms": 0.008400678634643555, "ViewRequirementAgentConnector_ms": 0.12017488479614258}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.2655019531250005, "episode_len_mean": 1262.225, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.2655019531250005}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41712672929349087, "mean_inference_ms": 1.810626159007522, "mean_action_processing_ms": 0.1101204074193309, "mean_env_wait_ms": 0.16048934618968952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10031759738922119, "StateBufferConnector_ms": 0.008400678634643555, "ViewRequirementAgentConnector_ms": 0.12017488479614258}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.82510810257315, "num_env_steps_trained_throughput_per_sec": 237.82510810257315, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 16849.646, "sample_time_ms": 9918.809, "learn_time_ms": 6887.149, "learn_throughput": 580.792, "synch_weights_time_ms": 43.029}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "80fdd_00000", "date": "2023-09-10_13-04-17", "timestamp": 1694365457, "time_this_iter_s": 16.826574087142944, "time_total_s": 220.61878061294556, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13437fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 220.61878061294556, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.877777777777776, "ram_util_percent": 32.155555555555566}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.199026552711924, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014285319395457918, "policy_loss": -0.01637567331745231, "vf_loss": 0.000240540758378908, "vf_explained_var": 0.24928179153551658, "kl": 0.009249064825310785, "entropy": 1.5608066463222106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.2655019531250005, "episode_len_mean": 1262.225, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.2655019531250005}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41712672929349087, "mean_inference_ms": 1.810626159007522, "mean_action_processing_ms": 0.1101204074193309, "mean_env_wait_ms": 0.16048934618968952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10031759738922119, "StateBufferConnector_ms": 0.008400678634643555, "ViewRequirementAgentConnector_ms": 0.12017488479614258}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.2655019531250005, "episode_len_mean": 1262.225, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.2655019531250005}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41712672929349087, "mean_inference_ms": 1.810626159007522, "mean_action_processing_ms": 0.1101204074193309, "mean_env_wait_ms": 0.16048934618968952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10031759738922119, "StateBufferConnector_ms": 0.008400678634643555, "ViewRequirementAgentConnector_ms": 0.12017488479614258}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.21818236890027, "num_env_steps_trained_throughput_per_sec": 242.21818236890027, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 16803.177, "sample_time_ms": 9903.948, "learn_time_ms": 6855.634, "learn_throughput": 583.462, "synch_weights_time_ms": 42.943}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 40, "training_iteration": 14, "trial_id": "80fdd_00000", "date": "2023-09-10_13-04-35", "timestamp": 1694365475, "time_this_iter_s": 16.519946813583374, "time_total_s": 237.13872742652893, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13449d700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 237.13872742652893, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.744444444444444, "ram_util_percent": 32.140740740740746}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.070061173196882, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009932573496371333, "policy_loss": -0.01280307962030444, "vf_loss": 0.0007156578278833573, "vf_explained_var": 0.12338389909515778, "kl": 0.010774242148349345, "entropy": 1.521371247371038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.25048971036585416, "episode_len_mean": 1262.658536585366, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.25048971036585416}, "custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169796772463892, "mean_inference_ms": 1.8091196990974696, "mean_action_processing_ms": 0.11007817689063724, "mean_env_wait_ms": 0.16034639370666115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10060856981975276, "StateBufferConnector_ms": 0.008359187986792587, "ViewRequirementAgentConnector_ms": 0.12013970351800686}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.25048971036585416, "episode_len_mean": 1262.658536585366, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.25048971036585416}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169796772463892, "mean_inference_ms": 1.8091196990974696, "mean_action_processing_ms": 0.11007817689063724, "mean_env_wait_ms": 0.16034639370666115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10060856981975276, "StateBufferConnector_ms": 0.008359187986792587, "ViewRequirementAgentConnector_ms": 0.12013970351800686}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.38114452799644, "num_env_steps_trained_throughput_per_sec": 237.38114452799644, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 16753.941, "sample_time_ms": 9848.856, "learn_time_ms": 6860.853, "learn_throughput": 583.018, "synch_weights_time_ms": 43.558}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 41, "training_iteration": 15, "trial_id": "80fdd_00000", "date": "2023-09-10_13-04-54", "timestamp": 1694365494, "time_this_iter_s": 16.85655117034912, "time_total_s": 253.99527859687805, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1346adb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 253.99527859687805, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 25.96666666666667, "ram_util_percent": 32.162962962962965}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3972826574618618, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015590469808254662, "policy_loss": -0.018524595730317134, "vf_loss": 8.525205101932443e-05, "vf_explained_var": -0.8297261108954748, "kl": 0.014244368881202582, "entropy": 1.461701287701726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.1284015625000004, "episode_len_mean": 1265.78, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.1284015625000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41639390333581344, "mean_inference_ms": 1.8079365706592299, "mean_action_processing_ms": 0.1098530813246958, "mean_env_wait_ms": 0.15999638476236458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10733890533447266, "StateBufferConnector_ms": 0.008234977722167969, "ViewRequirementAgentConnector_ms": 0.1208491325378418}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.1284015625000004, "episode_len_mean": 1265.78, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.1284015625000004}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41639390333581344, "mean_inference_ms": 1.8079365706592299, "mean_action_processing_ms": 0.1098530813246958, "mean_env_wait_ms": 0.15999638476236458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10733890533447266, "StateBufferConnector_ms": 0.008234977722167969, "ViewRequirementAgentConnector_ms": 0.1208491325378418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.39750915277713, "num_env_steps_trained_throughput_per_sec": 229.39750915277713, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 16788.269, "sample_time_ms": 9861.822, "learn_time_ms": 6882.174, "learn_throughput": 581.212, "synch_weights_time_ms": 43.59}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "80fdd_00000", "date": "2023-09-10_13-05-14", "timestamp": 1694365514, "time_this_iter_s": 17.444343090057373, "time_total_s": 271.4396216869354, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13451f3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 271.4396216869354, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.60357142857143, "ram_util_percent": 32.29999999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1996230735753974, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01106729733079798, "policy_loss": -0.01414040456826721, "vf_loss": 0.001684823165396665, "vf_explained_var": 0.7922236182416479, "kl": 0.006941421438465756, "entropy": 1.4417658399790525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.1284015625000004, "episode_len_mean": 1265.78, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.1284015625000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41639390333581344, "mean_inference_ms": 1.8079365706592299, "mean_action_processing_ms": 0.1098530813246958, "mean_env_wait_ms": 0.15999638476236458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10733890533447266, "StateBufferConnector_ms": 0.008234977722167969, "ViewRequirementAgentConnector_ms": 0.1208491325378418}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.1284015625000004, "episode_len_mean": 1265.78, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.1284015625000004}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41639390333581344, "mean_inference_ms": 1.8079365706592299, "mean_action_processing_ms": 0.1098530813246958, "mean_env_wait_ms": 0.15999638476236458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10733890533447266, "StateBufferConnector_ms": 0.008234977722167969, "ViewRequirementAgentConnector_ms": 0.1208491325378418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.57449487651397, "num_env_steps_trained_throughput_per_sec": 226.57449487651397, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 16898.711, "sample_time_ms": 9927.423, "learn_time_ms": 6926.888, "learn_throughput": 577.46, "synch_weights_time_ms": 43.717}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 50, "training_iteration": 17, "trial_id": "80fdd_00000", "date": "2023-09-10_13-05-34", "timestamp": 1694365534, "time_this_iter_s": 17.659910202026367, "time_total_s": 289.0995318889618, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1345243a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 289.0995318889618, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.12857142857143, "ram_util_percent": 32.38214285714285}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2817270403107008, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012357370907072134, "policy_loss": -0.014537700558624541, "vf_loss": 0.00014463547008366126, "vf_explained_var": -0.3770129580050707, "kl": 0.010178470551831964, "entropy": 1.4463695763299862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.11725643382352981, "episode_len_mean": 1266.0588235294117, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.11725643382352981}, "custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.416294622600341, "mean_inference_ms": 1.8070606181313822, "mean_action_processing_ms": 0.10983633868619636, "mean_env_wait_ms": 0.15992798065877442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10757586535285502, "StateBufferConnector_ms": 0.008240868063534008, "ViewRequirementAgentConnector_ms": 0.12142564736160577}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.11725643382352981, "episode_len_mean": 1266.0588235294117, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.11725643382352981}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.416294622600341, "mean_inference_ms": 1.8070606181313822, "mean_action_processing_ms": 0.10983633868619636, "mean_env_wait_ms": 0.15992798065877442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10757586535285502, "StateBufferConnector_ms": 0.008240868063534008, "ViewRequirementAgentConnector_ms": 0.12142564736160577}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.72710125923078, "num_env_steps_trained_throughput_per_sec": 220.72710125923078, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 17070.164, "sample_time_ms": 10039.7, "learn_time_ms": 6986.031, "learn_throughput": 572.571, "synch_weights_time_ms": 43.74}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 51, "training_iteration": 18, "trial_id": "80fdd_00000", "date": "2023-09-10_13-05-54", "timestamp": 1694365554, "time_this_iter_s": 18.127817153930664, "time_total_s": 307.22734904289246, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13452f3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 307.22734904289246, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 28.734482758620693, "ram_util_percent": 32.182758620689654}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4963305672630667, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015684431183459916, "policy_loss": -0.017934290484602874, "vf_loss": 5.6792168913943895e-05, "vf_explained_var": -0.9989158324897289, "kl": 0.010965337848122215, "entropy": 1.3718598660081625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.11725643382352981, "episode_len_mean": 1266.0588235294117, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.11725643382352981}, "custom_metrics": {"red_0/door_open_done_mean": 0.0392156862745098, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.416294622600341, "mean_inference_ms": 1.8070606181313822, "mean_action_processing_ms": 0.10983633868619636, "mean_env_wait_ms": 0.15992798065877442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10757586535285502, "StateBufferConnector_ms": 0.008240868063534008, "ViewRequirementAgentConnector_ms": 0.12142564736160577}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.11725643382352981, "episode_len_mean": 1266.0588235294117, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.11725643382352981}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.416294622600341, "mean_inference_ms": 1.8070606181313822, "mean_action_processing_ms": 0.10983633868619636, "mean_env_wait_ms": 0.15992798065877442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10757586535285502, "StateBufferConnector_ms": 0.008240868063534008, "ViewRequirementAgentConnector_ms": 0.12142564736160577}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.31791970993675, "num_env_steps_trained_throughput_per_sec": 246.31791970993675, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 17027.49, "sample_time_ms": 9981.093, "learn_time_ms": 7001.664, "learn_throughput": 571.293, "synch_weights_time_ms": 44.047}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 51, "training_iteration": 19, "trial_id": "80fdd_00000", "date": "2023-09-10_13-06-13", "timestamp": 1694365573, "time_this_iter_s": 16.24503183364868, "time_total_s": 323.47238087654114, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352041f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 323.47238087654114, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.853846153846153, "ram_util_percent": 32.24615384615384}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4513237634052834, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01631838105507389, "policy_loss": -0.02470351166751546, "vf_loss": 0.00508409083956091, "vf_explained_var": 0.532805418347319, "kl": 0.01650519679387609, "entropy": 1.3500732558468977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.03033463541666702, "episode_len_mean": 1268.15, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.03033463541666702}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41566448553891283, "mean_inference_ms": 1.8067005185023783, "mean_action_processing_ms": 0.1096773980319973, "mean_env_wait_ms": 0.15978620784813924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10723789532979329, "StateBufferConnector_ms": 0.008323987325032553, "ViewRequirementAgentConnector_ms": 0.12134273846944173}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.03033463541666702, "episode_len_mean": 1268.15, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.03033463541666702}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41566448553891283, "mean_inference_ms": 1.8067005185023783, "mean_action_processing_ms": 0.1096773980319973, "mean_env_wait_ms": 0.15978620784813924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10723789532979329, "StateBufferConnector_ms": 0.008323987325032553, "ViewRequirementAgentConnector_ms": 0.12134273846944173}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.38823630449235, "num_env_steps_trained_throughput_per_sec": 243.38823630449235, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 17007.201, "sample_time_ms": 9960.267, "learn_time_ms": 7002.444, "learn_throughput": 571.229, "synch_weights_time_ms": 43.804}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 60, "training_iteration": 20, "trial_id": "80fdd_00000", "date": "2023-09-10_13-06-32", "timestamp": 1694365592, "time_this_iter_s": 16.4414381980896, "time_total_s": 339.91381907463074, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13452f5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 339.91381907463074, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 25.374074074074073, "ram_util_percent": 32.162962962962965}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03278688524590164, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4840783791306118, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016925496163457864, "policy_loss": -0.01966506941753323, "vf_loss": 0.00041302209904188204, "vf_explained_var": 0.8050799472878377, "kl": 0.011632756354379126, "entropy": 1.2674919597804546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.022624231557377396, "episode_len_mean": 1268.344262295082, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.022624231557377396}, "custom_metrics": {"red_0/door_open_done_mean": 0.03278688524590164, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155564355887246, "mean_inference_ms": 1.8057219430045097, "mean_action_processing_ms": 0.10964781422034554, "mean_env_wait_ms": 0.15971644502663904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1067759560756996, "StateBufferConnector_ms": 0.008260617490674629, "ViewRequirementAgentConnector_ms": 0.12093254777251697}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.022624231557377396, "episode_len_mean": 1268.344262295082, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.022624231557377396}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155564355887246, "mean_inference_ms": 1.8057219430045097, "mean_action_processing_ms": 0.10964781422034554, "mean_env_wait_ms": 0.15971644502663904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1067759560756996, "StateBufferConnector_ms": 0.008260617490674629, "ViewRequirementAgentConnector_ms": 0.12093254777251697}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.06912735103415, "num_env_steps_trained_throughput_per_sec": 223.06912735103415, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 17090.266, "sample_time_ms": 9976.827, "learn_time_ms": 7068.288, "learn_throughput": 565.908, "synch_weights_time_ms": 44.49}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 61, "training_iteration": 21, "trial_id": "80fdd_00000", "date": "2023-09-10_13-06-52", "timestamp": 1694365612, "time_this_iter_s": 17.938912868499756, "time_total_s": 357.8527319431305, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13451f670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 357.8527319431305, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.685714285714287, "ram_util_percent": 32.26428571428572}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03278688524590164, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5540204651653766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015947006467104074, "policy_loss": -0.018822652542439755, "vf_loss": 5.284743513698231e-05, "vf_explained_var": -0.8760499654958646, "kl": 0.014113995005126074, "entropy": 1.2056998793035745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.022624231557377396, "episode_len_mean": 1268.344262295082, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.022624231557377396}, "custom_metrics": {"red_0/door_open_done_mean": 0.03278688524590164, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155564355887246, "mean_inference_ms": 1.8057219430045097, "mean_action_processing_ms": 0.10964781422034554, "mean_env_wait_ms": 0.15971644502663904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1067759560756996, "StateBufferConnector_ms": 0.008260617490674629, "ViewRequirementAgentConnector_ms": 0.12093254777251697}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": -0.022624231557377396, "episode_len_mean": 1268.344262295082, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": -0.022624231557377396}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155564355887246, "mean_inference_ms": 1.8057219430045097, "mean_action_processing_ms": 0.10964781422034554, "mean_env_wait_ms": 0.15971644502663904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1067759560756996, "StateBufferConnector_ms": 0.008260617490674629, "ViewRequirementAgentConnector_ms": 0.12093254777251697}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.81508433935994, "num_env_steps_trained_throughput_per_sec": 207.81508433935994, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 17324.997, "sample_time_ms": 10018.896, "learn_time_ms": 7260.852, "learn_throughput": 550.9, "synch_weights_time_ms": 44.583}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 61, "training_iteration": 22, "trial_id": "80fdd_00000", "date": "2023-09-10_13-07-13", "timestamp": 1694365633, "time_this_iter_s": 19.254194974899292, "time_total_s": 377.1069269180298, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135204ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 377.1069269180298, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.641935483870967, "ram_util_percent": 32.58387096774194}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.02857142857142857, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5426182258253296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005708824492467101, "policy_loss": -0.009326568663527723, "vf_loss": 0.0024000284331881024, "vf_explained_var": 0.7831654046972593, "kl": 0.006088579263881873, "entropy": 1.1910169132053852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04028459821428542, "episode_len_mean": 1269.8428571428572, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04028459821428542}, "custom_metrics": {"red_0/door_open_done_mean": 0.02857142857142857, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149963374271425, "mean_inference_ms": 1.8059754009969855, "mean_action_processing_ms": 0.10954290483621094, "mean_env_wait_ms": 0.15967024862153995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10525703430175781, "StateBufferConnector_ms": 0.008278914860316686, "ViewRequirementAgentConnector_ms": 0.12056078229631696}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04028459821428542, "episode_len_mean": 1269.8428571428572, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04028459821428542}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149963374271425, "mean_inference_ms": 1.8059754009969855, "mean_action_processing_ms": 0.10954290483621094, "mean_env_wait_ms": 0.15967024862153995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10525703430175781, "StateBufferConnector_ms": 0.008278914860316686, "ViewRequirementAgentConnector_ms": 0.12056078229631696}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.16017721520933, "num_env_steps_trained_throughput_per_sec": 243.16017721520933, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 17288.095, "sample_time_ms": 9982.075, "learn_time_ms": 7261.148, "learn_throughput": 550.877, "synch_weights_time_ms": 44.199}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 70, "training_iteration": 23, "trial_id": "80fdd_00000", "date": "2023-09-10_13-07-32", "timestamp": 1694365652, "time_this_iter_s": 16.45744800567627, "time_total_s": 393.56437492370605, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13449d4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 393.56437492370605, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 27.17407407407407, "ram_util_percent": 32.62222222222223}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.028169014084507043, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5496379163737097, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011820789572084323, "policy_loss": -0.013948224746854976, "vf_loss": 0.000351875378476052, "vf_explained_var": 0.4659166608005762, "kl": 0.008877799720509835, "entropy": 1.2067358310023943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04633692781690112, "episode_len_mean": 1269.9859154929577, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04633692781690112}, "custom_metrics": {"red_0/door_open_done_mean": 0.028169014084507043, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148989225646136, "mean_inference_ms": 1.8051971631590658, "mean_action_processing_ms": 0.1095204475584303, "mean_env_wait_ms": 0.15961570342399256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1051187515258789, "StateBufferConnector_ms": 0.008252305044254787, "ViewRequirementAgentConnector_ms": 0.1206918501518142}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04633692781690112, "episode_len_mean": 1269.9859154929577, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04633692781690112}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148989225646136, "mean_inference_ms": 1.8051971631590658, "mean_action_processing_ms": 0.1095204475584303, "mean_env_wait_ms": 0.15961570342399256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1051187515258789, "StateBufferConnector_ms": 0.008252305044254787, "ViewRequirementAgentConnector_ms": 0.1206918501518142}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.1027237734085, "num_env_steps_trained_throughput_per_sec": 240.1027237734085, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 17302.645, "sample_time_ms": 9994.832, "learn_time_ms": 7263.046, "learn_throughput": 550.733, "synch_weights_time_ms": 44.074}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 71, "training_iteration": 24, "trial_id": "80fdd_00000", "date": "2023-09-10_13-07-51", "timestamp": 1694365671, "time_this_iter_s": 16.666332960128784, "time_total_s": 410.23070788383484, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x134511b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 410.23070788383484, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.0, "ram_util_percent": 32.25769230769231}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.028169014084507043, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6273617124805848, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011532672767134499, "policy_loss": -0.013453079865818533, "vf_loss": 4.903105743305029e-05, "vf_explained_var": -0.952990597859025, "kl": 0.009356878156029324, "entropy": 1.2457532846679291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04633692781690112, "episode_len_mean": 1269.9859154929577, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04633692781690112}, "custom_metrics": {"red_0/door_open_done_mean": 0.028169014084507043, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148989225646136, "mean_inference_ms": 1.8051971631590658, "mean_action_processing_ms": 0.1095204475584303, "mean_env_wait_ms": 0.15961570342399256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1051187515258789, "StateBufferConnector_ms": 0.008252305044254787, "ViewRequirementAgentConnector_ms": 0.1206918501518142}}, "episode_reward_max": 0.9178124999999999, "episode_reward_min": -1.2900000000000011, "episode_reward_mean": 0.04633692781690112, "episode_len_mean": 1269.9859154929577, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2900000000000011}, "policy_reward_max": {"red_0": 0.9178124999999999}, "policy_reward_mean": {"red_0": 0.04633692781690112}, "hist_stats": {"episode_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 572, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1277, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.2900000000000011, -1.240000000000001, -1.2600000000000013, -1.1200000000000012, -1.2800000000000011, -1.200000000000001, -1.180000000000001, -1.070000000000001, -1.070000000000001, -1.120000000000001, -0.4800000000000005, -0.5200000000000005, -0.3300000000000004, -0.4700000000000005, -0.34000000000000036, -0.4800000000000004, -0.3900000000000004, -0.31000000000000033, -0.35000000000000037, -0.26000000000000034, 0.9178124999999999, 0.09999999999999974, 0.1699999999999997, 0.21999999999999975, 0.1699999999999997, 0.18999999999999972, 0.12999999999999978, -0.050000000000000204, 0.09210937499999974, 0.20999999999999974, 0.15999999999999975, 0.3899999999999999, 0.2899999999999998, 0.34999999999999987, 0.2899999999999998, 0.24999999999999983, 0.2799999999999998, 0.3599999999999999, 0.35999999999999993, 0.2599999999999998, 0.34999999999999987, 0.47, 0.42999999999999994, 0.3699999999999999, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.4099999999999999, 0.43999999999999995, 0.43999999999999995, 0.49, 0.47, 0.48, 0.45999999999999996, 0.4099999999999999, 0.47, 0.42999999999999994, 0.47, 0.48, 0.43999999999999995, 0.43999999999999995, 0.44999999999999996, 0.45, 0.44999999999999996, 0.48, 0.48, 0.5, 0.47, 0.48, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4148989225646136, "mean_inference_ms": 1.8051971631590658, "mean_action_processing_ms": 0.1095204475584303, "mean_env_wait_ms": 0.15961570342399256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1051187515258789, "StateBufferConnector_ms": 0.008252305044254787, "ViewRequirementAgentConnector_ms": 0.1206918501518142}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.0318533880924, "num_env_steps_trained_throughput_per_sec": 247.0318533880924, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 17236.815, "sample_time_ms": 9947.775, "learn_time_ms": 7244.526, "learn_throughput": 552.141, "synch_weights_time_ms": 43.832}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 71, "training_iteration": 25, "trial_id": "80fdd_00000", "date": "2023-09-10_13-08-09", "timestamp": 1694365689, "time_this_iter_s": 16.199393033981323, "time_total_s": 426.43010091781616, "pid": 79943, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.01}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1345b3280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 426.43010091781616, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.374074074074073, "ram_util_percent": 32.10740740740741}}
