{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.337417340961595, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5560776628553867, "policy_loss": -0.014405874850247831, "vf_loss": 3.5671836491674185, "vf_explained_var": 0.015610320369402568, "kl": 0.01649943409039843, "entropy": 1.9297592593977848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.14610073606787, "num_env_steps_trained_throughput_per_sec": 234.14610073606787, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 17083.215, "sample_time_ms": 9380.87, "learn_time_ms": 7645.414, "learn_throughput": 523.189, "synch_weights_time_ms": 55.885}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "b7eea_00000", "date": "2023-09-10_12-19-06", "timestamp": 1694362746, "time_this_iter_s": 17.089787244796753, "time_total_s": 17.089787244796753, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c6670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 17.089787244796753, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.096153846153847, "ram_util_percent": 30.346153846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.027369857455294, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7785349477548152, "policy_loss": -0.024176344240064887, "vf_loss": 0.7988436150054137, "vf_explained_var": 0.20536022937546175, "kl": 0.019338394329263136, "entropy": 1.9075753326217333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.2989856117748, "num_env_steps_trained_throughput_per_sec": 208.2989856117748, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 18143.178, "sample_time_ms": 10211.774, "learn_time_ms": 7877.545, "learn_throughput": 507.772, "synch_weights_time_ms": 53.016}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "b7eea_00000", "date": "2023-09-10_12-19-26", "timestamp": 1694362766, "time_this_iter_s": 19.2093288898468, "time_total_s": 36.299116134643555, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13524fee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36.299116134643555, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.5896551724138, "ram_util_percent": 30.627586206896556}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.590265666258832, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.874908946827054, "policy_loss": -0.014089962563108809, "vf_loss": 0.8864733704055349, "vf_explained_var": 0.16130259105314812, "kl": 0.01262769537027245, "entropy": 1.8770614961783092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": -56.599765625, "episode_reward_min": -56.599765625, "episode_reward_mean": -56.599765625, "episode_len_mean": 853.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -56.599765625}, "policy_reward_max": {"red_0": -56.599765625}, "policy_reward_mean": {"red_0": -56.599765625}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625], "episode_lengths": [853], "policy_red_0_reward": [-56.599765625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42443033261263396, "mean_inference_ms": 1.8131486779942698, "mean_action_processing_ms": 0.11079019551273189, "mean_env_wait_ms": 0.16298897558207515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12362003326416016, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.15692710876464844}}, "episode_reward_max": -56.599765625, "episode_reward_min": -56.599765625, "episode_reward_mean": -56.599765625, "episode_len_mean": 853.0, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -56.599765625}, "policy_reward_max": {"red_0": -56.599765625}, "policy_reward_mean": {"red_0": -56.599765625}, "hist_stats": {"episode_reward": [-56.599765625], "episode_lengths": [853], "policy_red_0_reward": [-56.599765625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42443033261263396, "mean_inference_ms": 1.8131486779942698, "mean_action_processing_ms": 0.11079019551273189, "mean_env_wait_ms": 0.16298897558207515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12362003326416016, "StateBufferConnector_ms": 0.005817413330078125, "ViewRequirementAgentConnector_ms": 0.15692710876464844}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.37589268346002, "num_env_steps_trained_throughput_per_sec": 199.37589268346002, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 18782.979, "sample_time_ms": 11008.721, "learn_time_ms": 7724.248, "learn_throughput": 517.85, "synch_weights_time_ms": 49.151}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "trial_id": "b7eea_00000", "date": "2023-09-10_12-19-48", "timestamp": 1694362788, "time_this_iter_s": 20.066808938980103, "time_total_s": 56.36592507362366, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135fc45e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 56.36592507362366, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.73548387096774, "ram_util_percent": 30.748387096774195}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.343573963207503, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6762093053509791, "policy_loss": -0.0215601740089672, "vf_loss": 0.6948500645036498, "vf_explained_var": 0.16338608531902235, "kl": 0.014597075682226894, "entropy": 1.8436615125586588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -55.5, "episode_reward_min": -77.0, "episode_reward_mean": -65.8099765625, "episode_len_mean": 1237.3, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -55.5}, "policy_reward_mean": {"red_0": -65.8099765625}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43793138508673685, "mean_inference_ms": 1.9791072000358558, "mean_action_processing_ms": 0.11890578022872758, "mean_env_wait_ms": 0.17934195664576663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10250568389892578, "StateBufferConnector_ms": 0.00812530517578125, "ViewRequirementAgentConnector_ms": 0.12845516204833984}}, "episode_reward_max": -55.5, "episode_reward_min": -77.0, "episode_reward_mean": -65.8099765625, "episode_len_mean": 1237.3, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -55.5}, "policy_reward_mean": {"red_0": -65.8099765625}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43793138508673685, "mean_inference_ms": 1.9791072000358558, "mean_action_processing_ms": 0.11890578022872758, "mean_env_wait_ms": 0.17934195664576663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10250568389892578, "StateBufferConnector_ms": 0.00812530517578125, "ViewRequirementAgentConnector_ms": 0.12845516204833984}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.43400103776517, "num_env_steps_trained_throughput_per_sec": 217.43400103776517, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 18686.326, "sample_time_ms": 10945.504, "learn_time_ms": 7691.511, "learn_throughput": 520.054, "synch_weights_time_ms": 48.44}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "b7eea_00000", "date": "2023-09-10_12-20-08", "timestamp": 1694362808, "time_this_iter_s": 18.402536869049072, "time_total_s": 74.76846194267273, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c6430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 74.76846194267273, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.03448275862069, "ram_util_percent": 30.731034482758623}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.340160002373159, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47205085737320285, "policy_loss": -0.012006676414603134, "vf_loss": 0.48227648908893267, "vf_explained_var": 0.08084783361603816, "kl": 0.008905216113887575, "entropy": 1.8080309117833773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -55.5, "episode_reward_min": -77.0, "episode_reward_mean": -65.8099765625, "episode_len_mean": 1237.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -55.5}, "policy_reward_mean": {"red_0": -65.8099765625}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43793138508673685, "mean_inference_ms": 1.9791072000358558, "mean_action_processing_ms": 0.11890578022872758, "mean_env_wait_ms": 0.17934195664576663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10250568389892578, "StateBufferConnector_ms": 0.00812530517578125, "ViewRequirementAgentConnector_ms": 0.12845516204833984}}, "episode_reward_max": -55.5, "episode_reward_min": -77.0, "episode_reward_mean": -65.8099765625, "episode_len_mean": 1237.3, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -55.5}, "policy_reward_mean": {"red_0": -65.8099765625}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43793138508673685, "mean_inference_ms": 1.9791072000358558, "mean_action_processing_ms": 0.11890578022872758, "mean_env_wait_ms": 0.17934195664576663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10250568389892578, "StateBufferConnector_ms": 0.00812530517578125, "ViewRequirementAgentConnector_ms": 0.12845516204833984}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.14292273729956, "num_env_steps_trained_throughput_per_sec": 247.14292273729956, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 18186.049, "sample_time_ms": 10617.541, "learn_time_ms": 7520.833, "learn_throughput": 531.856, "synch_weights_time_ms": 46.797}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "b7eea_00000", "date": "2023-09-10_12-20-27", "timestamp": 1694362827, "time_this_iter_s": 16.19087791442871, "time_total_s": 90.95933985710144, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13524f040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 90.95933985710144, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.65384615384615, "ram_util_percent": 30.638461538461545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.446451674370716, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18165601771494647, "policy_loss": -0.018382515941630116, "vf_loss": 0.19650293564579138, "vf_explained_var": 0.0016205303370952606, "kl": 0.01767799088205777, "entropy": 1.7668256303916374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -27.0, "episode_reward_min": -77.0, "episode_reward_mean": -62.281796875000005, "episode_len_mean": 1241.1818181818182, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -27.0}, "policy_reward_mean": {"red_0": -62.281796875000005}, "custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43586408736978427, "mean_inference_ms": 1.9598220756569829, "mean_action_processing_ms": 0.1178874753295395, "mean_env_wait_ms": 0.17733391395231413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10224038904363458, "StateBufferConnector_ms": 0.008182092146439985, "ViewRequirementAgentConnector_ms": 0.12703592127019708}}, "episode_reward_max": -27.0, "episode_reward_min": -77.0, "episode_reward_mean": -62.281796875000005, "episode_len_mean": 1241.1818181818182, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -27.0}, "policy_reward_mean": {"red_0": -62.281796875000005}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43586408736978427, "mean_inference_ms": 1.9598220756569829, "mean_action_processing_ms": 0.1178874753295395, "mean_env_wait_ms": 0.17733391395231413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10224038904363458, "StateBufferConnector_ms": 0.008182092146439985, "ViewRequirementAgentConnector_ms": 0.12703592127019708}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.0818662801256, "num_env_steps_trained_throughput_per_sec": 242.0818662801256, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 17908.927, "sample_time_ms": 10440.347, "learn_time_ms": 7421.638, "learn_throughput": 538.965, "synch_weights_time_ms": 46.105}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 11, "training_iteration": 6, "trial_id": "b7eea_00000", "date": "2023-09-10_12-20-45", "timestamp": 1694362845, "time_this_iter_s": 16.528441190719604, "time_total_s": 107.48778104782104, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135131040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 107.48778104782104, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.166666666666668, "ram_util_percent": 30.51851851851852}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1512016255718966, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13883781181381588, "policy_loss": -0.013867911325360183, "vf_loss": 0.15061913069803268, "vf_explained_var": 0.03334838505834341, "kl": 0.010432965711315016, "entropy": 1.7514151403059561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -77.0, "episode_reward_mean": -43.00498828125, "episode_len_mean": 1258.65, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -16.0}, "policy_reward_mean": {"red_0": -43.00498828125}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4293382459466879, "mean_inference_ms": 1.9172088914271128, "mean_action_processing_ms": 0.11509460716067066, "mean_env_wait_ms": 0.17238441227873652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09791254997253418, "StateBufferConnector_ms": 0.00858306884765625, "ViewRequirementAgentConnector_ms": 0.12161612510681152}}, "episode_reward_max": -16.0, "episode_reward_min": -77.0, "episode_reward_mean": -43.00498828125, "episode_len_mean": 1258.65, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -16.0}, "policy_reward_mean": {"red_0": -43.00498828125}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4293382459466879, "mean_inference_ms": 1.9172088914271128, "mean_action_processing_ms": 0.11509460716067066, "mean_env_wait_ms": 0.17238441227873652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09791254997253418, "StateBufferConnector_ms": 0.00858306884765625, "ViewRequirementAgentConnector_ms": 0.12161612510681152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.98205390379454, "num_env_steps_trained_throughput_per_sec": 248.98205390379454, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 17645.565, "sample_time_ms": 10276.308, "learn_time_ms": 7321.368, "learn_throughput": 546.346, "synch_weights_time_ms": 47.013}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "b7eea_00000", "date": "2023-09-10_12-21-04", "timestamp": 1694362864, "time_this_iter_s": 16.072132110595703, "time_total_s": 123.55991315841675, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135fc4160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 123.55991315841675, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.276000000000003, "ram_util_percent": 30.592000000000002}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9620415446038048, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07448949238605565, "policy_loss": -0.012083770406024995, "vf_loss": 0.08395932542625814, "vf_explained_var": 0.08942337060968081, "kl": 0.013069689691359087, "entropy": 1.7251126577456792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -16.0, "episode_reward_min": -77.0, "episode_reward_mean": -43.00498828125, "episode_len_mean": 1258.65, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -16.0}, "policy_reward_mean": {"red_0": -43.00498828125}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4293382459466879, "mean_inference_ms": 1.9172088914271128, "mean_action_processing_ms": 0.11509460716067066, "mean_env_wait_ms": 0.17238441227873652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09791254997253418, "StateBufferConnector_ms": 0.00858306884765625, "ViewRequirementAgentConnector_ms": 0.12161612510681152}}, "episode_reward_max": -16.0, "episode_reward_min": -77.0, "episode_reward_mean": -43.00498828125, "episode_len_mean": 1258.65, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -16.0}, "policy_reward_mean": {"red_0": -43.00498828125}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4293382459466879, "mean_inference_ms": 1.9172088914271128, "mean_action_processing_ms": 0.11509460716067066, "mean_env_wait_ms": 0.17238441227873652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09791254997253418, "StateBufferConnector_ms": 0.00858306884765625, "ViewRequirementAgentConnector_ms": 0.12161612510681152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.00501003724068, "num_env_steps_trained_throughput_per_sec": 239.00501003724068, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 17531.872, "sample_time_ms": 10166.97, "learn_time_ms": 7317.733, "learn_throughput": 546.617, "synch_weights_time_ms": 46.314}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "b7eea_00000", "date": "2023-09-10_12-21-23", "timestamp": 1694362883, "time_this_iter_s": 16.742430925369263, "time_total_s": 140.302344083786, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353dcc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 140.302344083786, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 27.06666666666667, "ram_util_percent": 30.592592592592595}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8774433072345952, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04090057171597437, "policy_loss": -0.012161042739414067, "vf_loss": 0.051121660224938144, "vf_explained_var": 0.3646639702220758, "kl": 0.009699770031486803, "entropy": 1.7062965370714664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -7.0, "episode_reward_min": -77.0, "episode_reward_mean": -41.290465029761904, "episode_len_mean": 1259.6666666666667, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -7.0}, "policy_reward_mean": {"red_0": -41.290465029761904}, "custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283155433477927, "mean_inference_ms": 1.9080522563649494, "mean_action_processing_ms": 0.11462451033615106, "mean_env_wait_ms": 0.17144904159421195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09821256001790364, "StateBufferConnector_ms": 0.008879389081682478, "ViewRequirementAgentConnector_ms": 0.12154125031970796}}, "episode_reward_max": -7.0, "episode_reward_min": -77.0, "episode_reward_mean": -41.290465029761904, "episode_len_mean": 1259.6666666666667, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -7.0}, "policy_reward_mean": {"red_0": -41.290465029761904}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4283155433477927, "mean_inference_ms": 1.9080522563649494, "mean_action_processing_ms": 0.11462451033615106, "mean_env_wait_ms": 0.17144904159421195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09821256001790364, "StateBufferConnector_ms": 0.008879389081682478, "ViewRequirementAgentConnector_ms": 0.12154125031970796}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.437539486553, "num_env_steps_trained_throughput_per_sec": 241.437539486553, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 17424.71, "sample_time_ms": 10110.141, "learn_time_ms": 7268.08, "learn_throughput": 550.352, "synch_weights_time_ms": 45.659}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 21, "training_iteration": 9, "trial_id": "b7eea_00000", "date": "2023-09-10_12-21-41", "timestamp": 1694362901, "time_this_iter_s": 16.573216915130615, "time_total_s": 156.87556099891663, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c68b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 156.87556099891663, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 26.2, "ram_util_percent": 30.837037037037035}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8460645268360774, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.021078135906979392, "policy_loss": -0.012702891749601502, "vf_loss": 0.0319193663696448, "vf_explained_var": 0.2976183629905184, "kl": 0.009308303144170431, "entropy": 1.7100213336447874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -77.0, "episode_reward_mean": -30.5199921875, "episode_len_mean": 1265.7666666666667, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -3.5}, "policy_reward_mean": {"red_0": -30.5199921875}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4239800160928123, "mean_inference_ms": 1.8809422421437454, "mean_action_processing_ms": 0.11286023182096842, "mean_env_wait_ms": 0.1681700493659548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09530782699584961, "StateBufferConnector_ms": 0.009171168009440104, "ViewRequirementAgentConnector_ms": 0.11881828308105469}}, "episode_reward_max": -3.5, "episode_reward_min": -77.0, "episode_reward_mean": -30.5199921875, "episode_len_mean": 1265.7666666666667, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -3.5}, "policy_reward_mean": {"red_0": -30.5199921875}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4239800160928123, "mean_inference_ms": 1.8809422421437454, "mean_action_processing_ms": 0.11286023182096842, "mean_env_wait_ms": 0.1681700493659548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09530782699584961, "StateBufferConnector_ms": 0.009171168009440104, "ViewRequirementAgentConnector_ms": 0.11881828308105469}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.1284245401018, "num_env_steps_trained_throughput_per_sec": 250.1284245401018, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 17281.415, "sample_time_ms": 10027.209, "learn_time_ms": 7207.926, "learn_throughput": 554.945, "synch_weights_time_ms": 45.473}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "b7eea_00000", "date": "2023-09-10_12-21-59", "timestamp": 1694362919, "time_this_iter_s": 15.998164892196655, "time_total_s": 172.87372589111328, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c6160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 172.87372589111328, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.81153846153846, "ram_util_percent": 30.72692307692308}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.861215905783077, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02388032821387848, "policy_loss": -0.010312882973691255, "vf_loss": 0.032177448743217006, "vf_explained_var": 0.23820596107592185, "kl": 0.010078813611458107, "entropy": 1.6951490748673677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -3.5, "episode_reward_min": -77.0, "episode_reward_mean": -30.5199921875, "episode_len_mean": 1265.7666666666667, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -3.5}, "policy_reward_mean": {"red_0": -30.5199921875}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4239800160928123, "mean_inference_ms": 1.8809422421437454, "mean_action_processing_ms": 0.11286023182096842, "mean_env_wait_ms": 0.1681700493659548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09530782699584961, "StateBufferConnector_ms": 0.009171168009440104, "ViewRequirementAgentConnector_ms": 0.11881828308105469}}, "episode_reward_max": -3.5, "episode_reward_min": -77.0, "episode_reward_mean": -30.5199921875, "episode_len_mean": 1265.7666666666667, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -3.5}, "policy_reward_mean": {"red_0": -30.5199921875}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4239800160928123, "mean_inference_ms": 1.8809422421437454, "mean_action_processing_ms": 0.11286023182096842, "mean_env_wait_ms": 0.1681700493659548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09530782699584961, "StateBufferConnector_ms": 0.009171168009440104, "ViewRequirementAgentConnector_ms": 0.11881828308105469}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.0900073213484, "num_env_steps_trained_throughput_per_sec": 248.0900073213484, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 17185.41, "sample_time_ms": 10024.292, "learn_time_ms": 7116.056, "learn_throughput": 562.109, "synch_weights_time_ms": 44.3}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "b7eea_00000", "date": "2023-09-10_12-22-18", "timestamp": 1694362938, "time_this_iter_s": 16.12886881828308, "time_total_s": 189.00259470939636, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135378ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 189.00259470939636, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 25.72307692307692, "ram_util_percent": 30.592307692307696}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03225806451612903, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9194065000551442, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01284398172198659, "policy_loss": -0.015708353658070943, "vf_loss": 0.02583254456888729, "vf_explained_var": 0.11731154980758826, "kl": 0.013598957169383547, "entropy": 1.6385048917184273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -29.551605342741937, "episode_len_mean": 1266.225806451613, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -29.551605342741937}, "custom_metrics": {"red_0/door_open_done_mean": 0.03225806451612903, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.423311593964647, "mean_inference_ms": 1.8752207851518472, "mean_action_processing_ms": 0.11257251676390195, "mean_env_wait_ms": 0.1675913052532281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09485367805727067, "StateBufferConnector_ms": 0.009089900601294732, "ViewRequirementAgentConnector_ms": 0.11821639153265184}}, "episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -29.551605342741937, "episode_len_mean": 1266.225806451613, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -29.551605342741937}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.423311593964647, "mean_inference_ms": 1.8752207851518472, "mean_action_processing_ms": 0.11257251676390195, "mean_env_wait_ms": 0.1675913052532281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09485367805727067, "StateBufferConnector_ms": 0.009089900601294732, "ViewRequirementAgentConnector_ms": 0.11821639153265184}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.64647361541395, "num_env_steps_trained_throughput_per_sec": 247.64647361541395, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 16880.299, "sample_time_ms": 9842.859, "learn_time_ms": 6993.205, "learn_throughput": 571.984, "synch_weights_time_ms": 43.458}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 31, "training_iteration": 12, "trial_id": "b7eea_00000", "date": "2023-09-10_12-22-36", "timestamp": 1694362956, "time_this_iter_s": 16.157733917236328, "time_total_s": 205.1603286266327, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353d85e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 205.1603286266327, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 26.126923076923074, "ram_util_percent": 30.646153846153844}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8240029148757457, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004685725507806637, "policy_loss": -0.011122075837435356, "vf_loss": 0.004461954877721534, "vf_explained_var": -0.01500852374980847, "kl": 0.009871976265116706, "entropy": 1.6165760684758426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -23.252494140625, "episode_len_mean": 1269.325, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -23.252494140625}, "custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.420139046462319, "mean_inference_ms": 1.8548504664500727, "mean_action_processing_ms": 0.11125768643960932, "mean_env_wait_ms": 0.16529186207424146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09498119354248047, "StateBufferConnector_ms": 0.00895678997039795, "ViewRequirementAgentConnector_ms": 0.11635243892669678}}, "episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -23.252494140625, "episode_len_mean": 1269.325, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -23.252494140625}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.420139046462319, "mean_inference_ms": 1.8548504664500727, "mean_action_processing_ms": 0.11125768643960932, "mean_env_wait_ms": 0.16529186207424146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09498119354248047, "StateBufferConnector_ms": 0.00895678997039795, "ViewRequirementAgentConnector_ms": 0.11635243892669678}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.12449783982848, "num_env_steps_trained_throughput_per_sec": 250.12449783982848, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 16473.242, "sample_time_ms": 9515.76, "learn_time_ms": 6913.355, "learn_throughput": 578.59, "synch_weights_time_ms": 43.383}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "b7eea_00000", "date": "2023-09-10_12-22-54", "timestamp": 1694362974, "time_this_iter_s": 15.998458862304688, "time_total_s": 221.15878748893738, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135131f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 221.15878748893738, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.653846153846153, "ram_util_percent": 30.711538461538467}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8498265179805458, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0029292704310743527, "policy_loss": -0.009855003124296975, "vf_loss": 0.005081391331865841, "vf_explained_var": 0.10386369538803895, "kl": 0.00922170576359654, "entropy": 1.5926541162033876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -23.252494140625, "episode_len_mean": 1269.325, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -23.252494140625}, "custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.420139046462319, "mean_inference_ms": 1.8548504664500727, "mean_action_processing_ms": 0.11125768643960932, "mean_env_wait_ms": 0.16529186207424146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09498119354248047, "StateBufferConnector_ms": 0.00895678997039795, "ViewRequirementAgentConnector_ms": 0.11635243892669678}}, "episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -23.252494140625, "episode_len_mean": 1269.325, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -23.252494140625}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.420139046462319, "mean_inference_ms": 1.8548504664500727, "mean_action_processing_ms": 0.11125768643960932, "mean_env_wait_ms": 0.16529186207424146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09498119354248047, "StateBufferConnector_ms": 0.00895678997039795, "ViewRequirementAgentConnector_ms": 0.11635243892669678}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.8501159127934, "num_env_steps_trained_throughput_per_sec": 247.8501159127934, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 16247.482, "sample_time_ms": 9377.733, "learn_time_ms": 6826.152, "learn_throughput": 585.982, "synch_weights_time_ms": 42.871}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 40, "training_iteration": 14, "trial_id": "b7eea_00000", "date": "2023-09-10_12-23-13", "timestamp": 1694362993, "time_this_iter_s": 16.144307851791382, "time_total_s": 237.30309534072876, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13532bd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 237.30309534072876, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.51153846153846, "ram_util_percent": 30.71538461538462}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8814406263952453, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010162852717985515, "policy_loss": -0.012247382691324067, "vf_loss": 0.00013516160062560328, "vf_explained_var": -0.07411428298801184, "kl": 0.009746843256218203, "entropy": 1.6044249664992094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -22.69755525914634, "episode_len_mean": 1269.5853658536585, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -22.69755525914634}, "custom_metrics": {"red_0/door_open_done_mean": 0.024390243902439025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.419734011252267, "mean_inference_ms": 1.8514011369122627, "mean_action_processing_ms": 0.1110831882728108, "mean_env_wait_ms": 0.16493918813096617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09470451168897676, "StateBufferConnector_ms": 0.008992450993235519, "ViewRequirementAgentConnector_ms": 0.11611682612721513}}, "episode_reward_max": -0.5, "episode_reward_min": -77.0, "episode_reward_mean": -22.69755525914634, "episode_len_mean": 1269.5853658536585, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": -0.5}, "policy_reward_mean": {"red_0": -22.69755525914634}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.419734011252267, "mean_inference_ms": 1.8514011369122627, "mean_action_processing_ms": 0.1110831882728108, "mean_env_wait_ms": 0.16493918813096617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09470451168897676, "StateBufferConnector_ms": 0.008992450993235519, "ViewRequirementAgentConnector_ms": 0.11611682612721513}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.5465182786273, "num_env_steps_trained_throughput_per_sec": 237.5465182786273, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 16312.866, "sample_time_ms": 9438.756, "learn_time_ms": 6830.525, "learn_throughput": 585.607, "synch_weights_time_ms": 42.883}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 41, "training_iteration": 15, "trial_id": "b7eea_00000", "date": "2023-09-10_12-23-32", "timestamp": 1694363012, "time_this_iter_s": 16.844589948654175, "time_total_s": 254.14768528938293, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353d8040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 254.14768528938293, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 28.122222222222224, "ram_util_percent": 30.740740740740744}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.783598672458902, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010670997888094764, "policy_loss": -0.015854130198810403, "vf_loss": 0.0022909990571633896, "vf_explained_var": -0.016784927683571975, "kl": 0.014460664856562295, "entropy": 1.5782632386932771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.81390059047118, "num_env_steps_trained_throughput_per_sec": 241.81390059047118, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 16314.697, "sample_time_ms": 9444.731, "learn_time_ms": 6826.182, "learn_throughput": 585.979, "synch_weights_time_ms": 43.083}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "b7eea_00000", "date": "2023-09-10_12-23-51", "timestamp": 1694363031, "time_this_iter_s": 16.548447132110596, "time_total_s": 270.69613242149353, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353c0ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 270.69613242149353, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 26.0962962962963, "ram_util_percent": 30.6925925925926}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9087719577364624, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01105354697817044, "policy_loss": -0.01381637038793997, "vf_loss": 5.1703872411697675e-05, "vf_explained_var": -0.18336852937936782, "kl": 0.01355559637895328, "entropy": 1.547596931581696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.45261819773833, "num_env_steps_trained_throughput_per_sec": 247.45261819773833, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 16324.627, "sample_time_ms": 9437.314, "learn_time_ms": 6844.66, "learn_throughput": 584.397, "synch_weights_time_ms": 42.0}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 50, "training_iteration": 17, "trial_id": "b7eea_00000", "date": "2023-09-10_12-24-09", "timestamp": 1694363049, "time_this_iter_s": 16.17111897468567, "time_total_s": 286.8672513961792, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1351318b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 286.8672513961792, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 25.611538461538462, "ram_util_percent": 30.77307692307692}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8685707629347841, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0026264259170299437, "policy_loss": -0.010148960123963964, "vf_loss": 0.005328431454715125, "vf_explained_var": 0.05909971793492635, "kl": 0.01097051640242602, "entropy": 1.5426423789312442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "custom_metrics": {"red_0/door_open_done_mean": 0.02, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.6319953125, "episode_len_mean": 1271.46, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.6319953125}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4175824543040854, "mean_inference_ms": 1.8373513429977268, "mean_action_processing_ms": 0.1101859962392125, "mean_env_wait_ms": 0.16332554928166307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10300111770629883, "StateBufferConnector_ms": 0.008809566497802734, "ViewRequirementAgentConnector_ms": 0.1159515380859375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.9723363938763, "num_env_steps_trained_throughput_per_sec": 248.9723363938763, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 16257.626, "sample_time_ms": 9433.678, "learn_time_ms": 6781.014, "learn_throughput": 589.882, "synch_weights_time_ms": 42.295}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 50, "training_iteration": 18, "trial_id": "b7eea_00000", "date": "2023-09-10_12-24-28", "timestamp": 1694363068, "time_this_iter_s": 16.073823928833008, "time_total_s": 302.9410753250122, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13532bc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 302.9410753250122, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.576923076923077, "ram_util_percent": 30.861538461538455}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0196078431372549, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9065031029594441, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01087102328092442, "policy_loss": -0.019868787477753357, "vf_loss": 0.006641982742318457, "vf_explained_var": 0.19349714430669943, "kl": 0.011778906189545354, "entropy": 1.5352558640142282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.286269914215687, "episode_len_mean": 1271.6274509803923, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.286269914215687}, "custom_metrics": {"red_0/door_open_done_mean": 0.0196078431372549, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41725837781696895, "mean_inference_ms": 1.835261786780814, "mean_action_processing_ms": 0.1100674950102274, "mean_env_wait_ms": 0.16308330194784482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10260133182301241, "StateBufferConnector_ms": 0.008804190392587698, "ViewRequirementAgentConnector_ms": 0.11584010778688918}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -18.286269914215687, "episode_len_mean": 1271.6274509803923, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -18.286269914215687}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41725837781696895, "mean_inference_ms": 1.835261786780814, "mean_action_processing_ms": 0.1100674950102274, "mean_env_wait_ms": 0.16308330194784482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10260133182301241, "StateBufferConnector_ms": 0.008804190392587698, "ViewRequirementAgentConnector_ms": 0.11584010778688918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.45162111118003, "num_env_steps_trained_throughput_per_sec": 237.45162111118003, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 16285.436, "sample_time_ms": 9439.499, "learn_time_ms": 6802.66, "learn_throughput": 588.005, "synch_weights_time_ms": 42.641}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 51, "training_iteration": 19, "trial_id": "b7eea_00000", "date": "2023-09-10_12-24-47", "timestamp": 1694363087, "time_this_iter_s": 16.852148056030273, "time_total_s": 319.7932233810425, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135378a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 319.7932233810425, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 26.48214285714286, "ram_util_percent": 30.807142857142857}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.016666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9684950009609262, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006108100037818076, "policy_loss": -0.011045787549907498, "vf_loss": 0.0030320649029818014, "vf_explained_var": 0.07851509811977546, "kl": 0.009528114242851398, "entropy": 1.5357983817656835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.576662760416667, "episode_len_mean": 1272.8833333333334, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.576662760416667}, "custom_metrics": {"red_0/door_open_done_mean": 0.016666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41574575642579215, "mean_inference_ms": 1.8261422784875974, "mean_action_processing_ms": 0.10946984172306694, "mean_env_wait_ms": 0.16203606833975576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10106643040974934, "StateBufferConnector_ms": 0.00857869784037272, "ViewRequirementAgentConnector_ms": 0.11829972267150879}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.576662760416667, "episode_len_mean": 1272.8833333333334, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.576662760416667}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41574575642579215, "mean_inference_ms": 1.8261422784875974, "mean_action_processing_ms": 0.10946984172306694, "mean_env_wait_ms": 0.16203606833975576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10106643040974934, "StateBufferConnector_ms": 0.00857869784037272, "ViewRequirementAgentConnector_ms": 0.11829972267150879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.1812190534157, "num_env_steps_trained_throughput_per_sec": 210.1812190534157, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 16589.377, "sample_time_ms": 9627.156, "learn_time_ms": 6918.578, "learn_throughput": 578.153, "synch_weights_time_ms": 43.001}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 60, "training_iteration": 20, "trial_id": "b7eea_00000", "date": "2023-09-10_12-25-08", "timestamp": 1694363108, "time_this_iter_s": 19.039777040481567, "time_total_s": 338.83300042152405, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135378790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 338.83300042152405, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.689999999999998, "ram_util_percent": 31.209999999999997}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.016666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0046114666076997, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01381272842178684, "policy_loss": -0.01630897034216711, "vf_loss": 0.00011790433255403817, "vf_explained_var": -0.6275336937357981, "kl": 0.011891690000661311, "entropy": 1.542047660301129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.576662760416667, "episode_len_mean": 1272.8833333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.576662760416667}, "custom_metrics": {"red_0/door_open_done_mean": 0.016666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41574575642579215, "mean_inference_ms": 1.8261422784875974, "mean_action_processing_ms": 0.10946984172306694, "mean_env_wait_ms": 0.16203606833975576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10106643040974934, "StateBufferConnector_ms": 0.00857869784037272, "ViewRequirementAgentConnector_ms": 0.11829972267150879}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.576662760416667, "episode_len_mean": 1272.8833333333334, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.576662760416667}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41574575642579215, "mean_inference_ms": 1.8261422784875974, "mean_action_processing_ms": 0.10946984172306694, "mean_env_wait_ms": 0.16203606833975576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10106643040974934, "StateBufferConnector_ms": 0.00857869784037272, "ViewRequirementAgentConnector_ms": 0.11829972267150879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.45659286364653, "num_env_steps_trained_throughput_per_sec": 219.45659286364653, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 16799.743, "sample_time_ms": 9784.022, "learn_time_ms": 6972.086, "learn_throughput": 573.716, "synch_weights_time_ms": 42.98}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 60, "training_iteration": 21, "trial_id": "b7eea_00000", "date": "2023-09-10_12-25-28", "timestamp": 1694363128, "time_this_iter_s": 18.233049154281616, "time_total_s": 357.06604957580566, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135378dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 357.06604957580566, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 29.727586206896554, "ram_util_percent": 31.310344827586203}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.01639344262295082, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9942250466595094, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011730802734867514, "policy_loss": -0.013661541666563911, "vf_loss": 2.2604762348995186e-05, "vf_explained_var": -0.981714738967518, "kl": 0.009540672160656795, "entropy": 1.540873326237003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.321307633196723, "episode_len_mean": 1273.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.321307633196723}, "custom_metrics": {"red_0/door_open_done_mean": 0.01639344262295082, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155442824217506, "mean_inference_ms": 1.8250236504094024, "mean_action_processing_ms": 0.10941018152350108, "mean_env_wait_ms": 0.16189221244833224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10071621566522317, "StateBufferConnector_ms": 0.008603393054399335, "ViewRequirementAgentConnector_ms": 0.11823724527828029}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -15.321307633196723, "episode_len_mean": 1273.0, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -15.321307633196723}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4155442824217506, "mean_inference_ms": 1.8250236504094024, "mean_action_processing_ms": 0.10941018152350108, "mean_env_wait_ms": 0.16189221244833224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10071621566522317, "StateBufferConnector_ms": 0.008603393054399335, "ViewRequirementAgentConnector_ms": 0.11823724527828029}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.9907330428618, "num_env_steps_trained_throughput_per_sec": 236.9907330428618, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 16872.367, "sample_time_ms": 9850.306, "learn_time_ms": 6978.288, "learn_throughput": 573.207, "synch_weights_time_ms": 43.139}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 61, "training_iteration": 22, "trial_id": "b7eea_00000", "date": "2023-09-10_12-25-48", "timestamp": 1694363148, "time_this_iter_s": 16.88556480407715, "time_total_s": 373.9516143798828, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135325c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 373.9516143798828, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.911111111111108, "ram_util_percent": 31.27777777777778}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.014285714285714285, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7978395669876287, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007276413253566716, "policy_loss": -0.011025878860770414, "vf_loss": 0.0016739184987632902, "vf_explained_var": -0.24406056130925816, "kl": 0.010377733984886816, "entropy": 1.5178742961337168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.358568080357143, "episode_len_mean": 1273.9, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.358568080357143}, "custom_metrics": {"red_0/door_open_done_mean": 0.014285714285714285, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145953936252305, "mean_inference_ms": 1.8194958403822499, "mean_action_processing_ms": 0.10905134620707747, "mean_env_wait_ms": 0.16120704008965783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10010208402361188, "StateBufferConnector_ms": 0.008625984191894531, "ViewRequirementAgentConnector_ms": 0.11792761938912528}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.358568080357143, "episode_len_mean": 1273.9, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.358568080357143}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145953936252305, "mean_inference_ms": 1.8194958403822499, "mean_action_processing_ms": 0.10905134620707747, "mean_env_wait_ms": 0.16120704008965783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10010208402361188, "StateBufferConnector_ms": 0.008625984191894531, "ViewRequirementAgentConnector_ms": 0.11792761938912528}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.53310649207245, "num_env_steps_trained_throughput_per_sec": 242.53310649207245, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 16922.422, "sample_time_ms": 9878.793, "learn_time_ms": 6999.158, "learn_throughput": 571.497, "synch_weights_time_ms": 43.819}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 70, "training_iteration": 23, "trial_id": "b7eea_00000", "date": "2023-09-10_12-26-06", "timestamp": 1694363166, "time_this_iter_s": 16.50289011001587, "time_total_s": 390.4545044898987, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135131ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 390.4545044898987, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.74074074074074, "ram_util_percent": 31.0962962962963}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.014285714285714285, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0069212758603194, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012609565713986134, "policy_loss": -0.015337061807319212, "vf_loss": 2.079284344063126e-05, "vf_explained_var": -0.6989695045476159, "kl": 0.013533520498159231, "entropy": 1.5231714212646088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.358568080357143, "episode_len_mean": 1273.9, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.358568080357143}, "custom_metrics": {"red_0/door_open_done_mean": 0.014285714285714285, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145953936252305, "mean_inference_ms": 1.8194958403822499, "mean_action_processing_ms": 0.10905134620707747, "mean_env_wait_ms": 0.16120704008965783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10010208402361188, "StateBufferConnector_ms": 0.008625984191894531, "ViewRequirementAgentConnector_ms": 0.11792761938912528}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.358568080357143, "episode_len_mean": 1273.9, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.358568080357143}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4145953936252305, "mean_inference_ms": 1.8194958403822499, "mean_action_processing_ms": 0.10905134620707747, "mean_env_wait_ms": 0.16120704008965783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10010208402361188, "StateBufferConnector_ms": 0.008625984191894531, "ViewRequirementAgentConnector_ms": 0.11792761938912528}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.50749737295413, "num_env_steps_trained_throughput_per_sec": 215.50749737295413, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 17164.628, "sample_time_ms": 10012.838, "learn_time_ms": 7107.457, "learn_throughput": 562.789, "synch_weights_time_ms": 43.684}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 70, "training_iteration": 24, "trial_id": "b7eea_00000", "date": "2023-09-10_12-26-27", "timestamp": 1694363187, "time_this_iter_s": 18.56722593307495, "time_total_s": 409.02173042297363, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135325820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 409.02173042297363, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 28.655172413793103, "ram_util_percent": 31.348275862068963}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.014084507042253521, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.990683886470894, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013135403121971952, "policy_loss": -0.01557043263843904, "vf_loss": 5.587308306568654e-06, "vf_explained_var": -0.99916341577967, "kl": 0.012147211631457822, "entropy": 1.5064468612273534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.17041923415493, "episode_len_mean": 1273.9859154929577, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.17041923415493}, "custom_metrics": {"red_0/door_open_done_mean": 0.014084507042253521, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41448710697230634, "mean_inference_ms": 1.818990564299082, "mean_action_processing_ms": 0.10902734779080395, "mean_env_wait_ms": 0.16113990729757244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10020128438170527, "StateBufferConnector_ms": 0.008624372347979479, "ViewRequirementAgentConnector_ms": 0.11826803986455353}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -13.17041923415493, "episode_len_mean": 1273.9859154929577, "episodes_this_iter": 1, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -13.17041923415493}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41448710697230634, "mean_inference_ms": 1.818990564299082, "mean_action_processing_ms": 0.10902734779080395, "mean_env_wait_ms": 0.16113990729757244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10020128438170527, "StateBufferConnector_ms": 0.008624372347979479, "ViewRequirementAgentConnector_ms": 0.11826803986455353}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.35297621634552, "num_env_steps_trained_throughput_per_sec": 198.35297621634552, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 17497.354, "sample_time_ms": 10243.534, "learn_time_ms": 7208.888, "learn_throughput": 554.871, "synch_weights_time_ms": 44.286}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 71, "training_iteration": 25, "trial_id": "b7eea_00000", "date": "2023-09-10_12-26-49", "timestamp": 1694363209, "time_this_iter_s": 20.17284083366394, "time_total_s": 429.1945712566376, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c6b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 429.1945712566376, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 28.90625, "ram_util_percent": 31.521875}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5466463142074645, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007632543872265766, "policy_loss": -0.010716430847727073, "vf_loss": 0.000839679144264475, "vf_explained_var": -0.6109544010212024, "kl": 0.011221038133358108, "entropy": 1.4652321178466081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -11.701247070312501, "episode_len_mean": 1274.6625, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -11.701247070312501}, "custom_metrics": {"red_0/door_open_done_mean": 0.0125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141521370405994, "mean_inference_ms": 1.8186611558239811, "mean_action_processing_ms": 0.10896993851863875, "mean_env_wait_ms": 0.16098261912939377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10073304176330566, "StateBufferConnector_ms": 0.008504688739776611, "ViewRequirementAgentConnector_ms": 0.12088030576705933}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -11.701247070312501, "episode_len_mean": 1274.6625, "episodes_this_iter": 9, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -11.701247070312501}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141521370405994, "mean_inference_ms": 1.8186611558239811, "mean_action_processing_ms": 0.10896993851863875, "mean_env_wait_ms": 0.16098261912939377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10073304176330566, "StateBufferConnector_ms": 0.008504688739776611, "ViewRequirementAgentConnector_ms": 0.12088030576705933}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.8794728570313, "num_env_steps_trained_throughput_per_sec": 218.8794728570313, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 17670.679, "sample_time_ms": 10391.915, "learn_time_ms": 7234.157, "learn_throughput": 552.932, "synch_weights_time_ms": 43.947}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 80, "training_iteration": 26, "trial_id": "b7eea_00000", "date": "2023-09-10_12-27-10", "timestamp": 1694363230, "time_this_iter_s": 18.28229308128357, "time_total_s": 447.47686433792114, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352c6040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 447.47686433792114, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 26.986206896551725, "ram_util_percent": 31.744827586206906}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0340533403058847, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011393676897326562, "policy_loss": -0.013572293793549762, "vf_loss": 1.0536358215536742e-05, "vf_explained_var": -0.520310105321308, "kl": 0.01084040366022427, "entropy": 1.4505695795019469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -11.701247070312501, "episode_len_mean": 1274.6625, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -11.701247070312501}, "custom_metrics": {"red_0/door_open_done_mean": 0.0125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141521370405994, "mean_inference_ms": 1.8186611558239811, "mean_action_processing_ms": 0.10896993851863875, "mean_env_wait_ms": 0.16098261912939377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10073304176330566, "StateBufferConnector_ms": 0.008504688739776611, "ViewRequirementAgentConnector_ms": 0.12088030576705933}}, "episode_reward_max": 0.0, "episode_reward_min": -77.0, "episode_reward_mean": -11.701247070312501, "episode_len_mean": 1274.6625, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -77.0}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -11.701247070312501}, "hist_stats": {"episode_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [853, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-56.599765625, -77.0, -69.0, -55.5, -73.5, -66.5, -67.0, -63.0, -66.5, -63.5, -27.0, -19.5, -23.0, -21.5, -17.5, -22.5, -17.5, -16.0, -18.5, -19.0, -7.0, -6.5, -3.5, -8.5, -3.5, -3.5, -7.0, -6.0, -6.5, -3.5, -0.5, -0.5, -1.0, -1.0, -3.0, -1.5, -3.0, -2.0, -1.0, -1.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -1.0, 0.0, -0.5, 0.0, -0.5, -0.5, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.5, 0.0, -0.5, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4141521370405994, "mean_inference_ms": 1.8186611558239811, "mean_action_processing_ms": 0.10896993851863875, "mean_env_wait_ms": 0.16098261912939377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10073304176330566, "StateBufferConnector_ms": 0.008504688739776611, "ViewRequirementAgentConnector_ms": 0.12088030576705933}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.07203120261443, "num_env_steps_trained_throughput_per_sec": 194.07203120261443, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 18115.298, "sample_time_ms": 10674.016, "learn_time_ms": 7396.58, "learn_throughput": 540.791, "synch_weights_time_ms": 44.029}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 80, "training_iteration": 27, "trial_id": "b7eea_00000", "date": "2023-09-10_12-27-33", "timestamp": 1694363253, "time_this_iter_s": 20.61855697631836, "time_total_s": 468.0954213142395, "pid": 78781, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.5}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1352a7ee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 468.0954213142395, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.642424242424244, "ram_util_percent": 31.818181818181817}}
