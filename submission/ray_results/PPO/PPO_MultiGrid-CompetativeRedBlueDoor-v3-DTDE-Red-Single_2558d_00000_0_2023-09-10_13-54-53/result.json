{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5828345777156453, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0043949899435877645, "policy_loss": -0.017113638584366223, "vf_loss": 0.01002385347795401, "vf_explained_var": 0.3568244330585003, "kl": 0.01347397676975255, "entropy": 1.9327118152131637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.31460252874686, "num_env_steps_trained_throughput_per_sec": 240.31460252874686, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 16644.666, "sample_time_ms": 9800.966, "learn_time_ms": 6799.198, "learn_throughput": 588.305, "synch_weights_time_ms": 43.758}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "2558d_00000", "date": "2023-09-10_13-55-11", "timestamp": 1694368511, "time_this_iter_s": 16.650060892105103, "time_total_s": 16.650060892105103, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c28b940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 16.650060892105103, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.892, "ram_util_percent": 30.712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7522715993846456, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014821100556340146, "policy_loss": -0.01992796219177156, "vf_loss": 0.0025995974076067794, "vf_explained_var": 0.571627154139181, "kl": 0.012536323941574988, "entropy": 1.9147076514859995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.74530804795748, "num_env_steps_trained_throughput_per_sec": 241.74530804795748, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 16595.491, "sample_time_ms": 9733.428, "learn_time_ms": 6817.653, "learn_throughput": 586.712, "synch_weights_time_ms": 43.704}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "2558d_00000", "date": "2023-09-10_13-55-29", "timestamp": 1694368529, "time_this_iter_s": 16.5515079498291, "time_total_s": 33.201568841934204, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15fe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 33.201568841934204, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 27.575, "ram_util_percent": 30.691666666666663}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8893391405853133, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015157765709136583, "policy_loss": -0.018668202028493397, "vf_loss": 0.0007297234223945755, "vf_explained_var": -0.1330759685486555, "kl": 0.013903563947431896, "entropy": 1.8707723026474317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.5872343749999999, "episode_reward_mean": 0.5872343749999999, "episode_len_mean": 1109.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.5872343749999999}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.5872343749999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999], "episode_lengths": [1109], "policy_red_0_reward": [0.5872343749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40237274296972575, "mean_inference_ms": 1.6705956089804312, "mean_action_processing_ms": 0.10166557305659184, "mean_env_wait_ms": 0.14683169985095426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14731884002685547, "StateBufferConnector_ms": 0.009918212890625, "ViewRequirementAgentConnector_ms": 0.11832714080810547}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.5872343749999999, "episode_reward_mean": 0.5872343749999999, "episode_len_mean": 1109.0, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.5872343749999999}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.5872343749999999}, "hist_stats": {"episode_reward": [0.5872343749999999], "episode_lengths": [1109], "policy_red_0_reward": [0.5872343749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40237274296972575, "mean_inference_ms": 1.6705956089804312, "mean_action_processing_ms": 0.10166557305659184, "mean_env_wait_ms": 0.14683169985095426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14731884002685547, "StateBufferConnector_ms": 0.009918212890625, "ViewRequirementAgentConnector_ms": 0.11832714080810547}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.49666291400223, "num_env_steps_trained_throughput_per_sec": 233.49666291400223, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 16773.942, "sample_time_ms": 9721.574, "learn_time_ms": 7009.49, "learn_throughput": 570.655, "synch_weights_time_ms": 42.167}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "trial_id": "2558d_00000", "date": "2023-09-10_13-55-47", "timestamp": 1694368547, "time_this_iter_s": 17.135534048080444, "time_total_s": 50.33710289001465, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c417040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 50.33710289001465, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 24.73333333333333, "ram_util_percent": 31.01851851851852}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0645548404504857, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008826498814596562, "policy_loss": -0.022232046886589765, "vf_loss": 0.010559661033767043, "vf_explained_var": 0.4305835978438457, "kl": 0.014229434149049798, "entropy": 1.853758772710959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.35762343749999986, "episode_len_mean": 1262.9, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.35762343749999986}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41648424903474635, "mean_inference_ms": 1.7347423429872098, "mean_action_processing_ms": 0.10464594302950944, "mean_env_wait_ms": 0.15235456080684898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10410070419311523, "StateBufferConnector_ms": 0.009479522705078125, "ViewRequirementAgentConnector_ms": 0.11769533157348633}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.35762343749999986, "episode_len_mean": 1262.9, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.35762343749999986}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41648424903474635, "mean_inference_ms": 1.7347423429872098, "mean_action_processing_ms": 0.10464594302950944, "mean_env_wait_ms": 0.15235456080684898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10410070419311523, "StateBufferConnector_ms": 0.009479522705078125, "ViewRequirementAgentConnector_ms": 0.11769533157348633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.2432513844349, "num_env_steps_trained_throughput_per_sec": 220.2432513844349, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17120.885, "sample_time_ms": 9786.481, "learn_time_ms": 7288.41, "learn_throughput": 548.817, "synch_weights_time_ms": 45.279}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "2558d_00000", "date": "2023-09-10_13-56-08", "timestamp": 1694368568, "time_this_iter_s": 18.169408082962036, "time_total_s": 68.50651097297668, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15fb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 68.50651097297668, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.23793103448276, "ram_util_percent": 31.255172413793098}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9911872449641427, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013395808971229902, "policy_loss": -0.016024031815565346, "vf_loss": 0.00020670159936647298, "vf_explained_var": -0.5582120111212134, "kl": 0.012107609584149153, "entropy": 1.8524941635628542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.35762343749999986, "episode_len_mean": 1262.9, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.35762343749999986}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41648424903474635, "mean_inference_ms": 1.7347423429872098, "mean_action_processing_ms": 0.10464594302950944, "mean_env_wait_ms": 0.15235456080684898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10410070419311523, "StateBufferConnector_ms": 0.009479522705078125, "ViewRequirementAgentConnector_ms": 0.11769533157348633}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.35762343749999986, "episode_len_mean": 1262.9, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.35762343749999986}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41648424903474635, "mean_inference_ms": 1.7347423429872098, "mean_action_processing_ms": 0.10464594302950944, "mean_env_wait_ms": 0.15235456080684898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10410070419311523, "StateBufferConnector_ms": 0.009479522705078125, "ViewRequirementAgentConnector_ms": 0.11769533157348633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.02994965086089, "num_env_steps_trained_throughput_per_sec": 241.02994965086089, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 17015.794, "sample_time_ms": 9741.276, "learn_time_ms": 7229.276, "learn_throughput": 553.306, "synch_weights_time_ms": 44.558}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "2558d_00000", "date": "2023-09-10_13-56-26", "timestamp": 1694368586, "time_this_iter_s": 16.60097098350525, "time_total_s": 85.10748195648193, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c331c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 85.10748195648193, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 26.02692307692308, "ram_util_percent": 31.26923076923077}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0055617436145743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017417136725513652, "policy_loss": -0.020533594900674263, "vf_loss": 4.639100945761735e-05, "vf_explained_var": -0.49316054775069157, "kl": 0.015350339176711714, "entropy": 1.828298341979583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.36065767045454533, "episode_len_mean": 1264.4545454545455, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.36065767045454533}, "custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41641756851413786, "mean_inference_ms": 1.738289100483838, "mean_action_processing_ms": 0.10496683930067909, "mean_env_wait_ms": 0.1528129801592562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10474595156582919, "StateBufferConnector_ms": 0.009692798961292614, "ViewRequirementAgentConnector_ms": 0.11970346624200995}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.36065767045454533, "episode_len_mean": 1264.4545454545455, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.36065767045454533}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41641756851413786, "mean_inference_ms": 1.738289100483838, "mean_action_processing_ms": 0.10496683930067909, "mean_env_wait_ms": 0.1528129801592562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10474595156582919, "StateBufferConnector_ms": 0.009692798961292614, "ViewRequirementAgentConnector_ms": 0.11970346624200995}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.77506212306986, "num_env_steps_trained_throughput_per_sec": 245.77506212306986, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 16892.332, "sample_time_ms": 9694.497, "learn_time_ms": 7153.013, "learn_throughput": 559.205, "synch_weights_time_ms": 44.153}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 11, "training_iteration": 6, "trial_id": "2558d_00000", "date": "2023-09-10_13-56-45", "timestamp": 1694368605, "time_this_iter_s": 16.281047105789185, "time_total_s": 101.38852906227112, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf29310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 101.38852906227112, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.018518518518515, "ram_util_percent": 31.011111111111106}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1005018548419079, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014866834145262449, "policy_loss": -0.01936952559699421, "vf_loss": 0.002285539832670717, "vf_explained_var": 0.8499129196008046, "kl": 0.011085754523391245, "entropy": 1.809218674649795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.2956785153773, "num_env_steps_trained_throughput_per_sec": 235.2956785153773, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 16907.694, "sample_time_ms": 9707.678, "learn_time_ms": 7154.996, "learn_throughput": 559.05, "synch_weights_time_ms": 44.329}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "2558d_00000", "date": "2023-09-10_13-57-04", "timestamp": 1694368624, "time_this_iter_s": 17.00666618347168, "time_total_s": 118.3951952457428, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c331e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 118.3951952457428, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.3962962962963, "ram_util_percent": 30.97777777777778}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1576627051457762, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014400197093345923, "policy_loss": -0.016553525328830195, "vf_loss": 5.0650100214018796e-05, "vf_explained_var": -0.9758725291738908, "kl": 0.010513389554346494, "entropy": 1.7828020486980676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.93449061111284, "num_env_steps_trained_throughput_per_sec": 246.93449061111284, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16819.058, "sample_time_ms": 9660.422, "learn_time_ms": 7114.048, "learn_throughput": 562.268, "synch_weights_time_ms": 43.911}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "2558d_00000", "date": "2023-09-10_13-57-22", "timestamp": 1694368642, "time_this_iter_s": 16.204204082489014, "time_total_s": 134.5993993282318, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c28b9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 134.5993993282318, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.784615384615385, "ram_util_percent": 31.06923076923077}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1908642540375391, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020273402623934088, "policy_loss": -0.023500768117082772, "vf_loss": 3.248651670257156e-05, "vf_explained_var": -0.9985866109530132, "kl": 0.01597439427815947, "entropy": 1.7372198905795813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3638117187499999, "episode_len_mean": 1271.45, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3638117187499999}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418186022178615, "mean_inference_ms": 1.7335950677266592, "mean_action_processing_ms": 0.10485327433925333, "mean_env_wait_ms": 0.152433873917609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11110544204711914, "StateBufferConnector_ms": 0.009857416152954102, "ViewRequirementAgentConnector_ms": 0.12513279914855957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.4448905670683, "num_env_steps_trained_throughput_per_sec": 246.4448905670683, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 16753.695, "sample_time_ms": 9634.821, "learn_time_ms": 7074.291, "learn_throughput": 565.428, "synch_weights_time_ms": 43.902}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 20, "training_iteration": 9, "trial_id": "2558d_00000", "date": "2023-09-10_13-57-41", "timestamp": 1694368661, "time_this_iter_s": 16.235740900039673, "time_total_s": 150.83514022827148, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c2cd550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 150.83514022827148, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.711538461538467, "ram_util_percent": 31.19615384615385}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.212821970631679, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016240663754676157, "policy_loss": -0.02242466285727763, "vf_loss": 0.003712725432554483, "vf_explained_var": 0.7342915039509534, "kl": 0.012356365210369263, "entropy": 1.7165509560455878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.13013750861472, "num_env_steps_trained_throughput_per_sec": 247.13013750861472, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 16696.904, "sample_time_ms": 9616.164, "learn_time_ms": 7036.359, "learn_throughput": 568.476, "synch_weights_time_ms": 43.696}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "2558d_00000", "date": "2023-09-10_13-57-59", "timestamp": 1694368679, "time_this_iter_s": 16.19250798225403, "time_total_s": 167.0276482105255, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c096040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 167.0276482105255, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.834615384615386, "ram_util_percent": 31.103846153846156}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1263204726700982, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018825669278521674, "policy_loss": -0.021220767697377595, "vf_loss": 0.0001832070824358804, "vf_explained_var": 0.511902462442716, "kl": 0.011059456056759879, "entropy": 1.6825502034276725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.8571470983175, "num_env_steps_trained_throughput_per_sec": 212.8571470983175, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 16911.629, "sample_time_ms": 9631.333, "learn_time_ms": 7234.358, "learn_throughput": 552.917, "synch_weights_time_ms": 45.253}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "2558d_00000", "date": "2023-09-10_13-58-20", "timestamp": 1694368700, "time_this_iter_s": 18.80001211166382, "time_total_s": 185.82766032218933, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c417700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 185.82766032218933, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.873333333333335, "ram_util_percent": 31.276666666666664}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3418166797608138, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018457968637206553, "policy_loss": -0.02127971847561033, "vf_loss": 4.250070717451611e-05, "vf_explained_var": -0.9928973142057658, "kl": 0.01389624305905039, "entropy": 1.6415351311365762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3823744791666665, "episode_len_mean": 1274.3, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3823744791666665}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41731394566097535, "mean_inference_ms": 1.7281664212350785, "mean_action_processing_ms": 0.10446651863652108, "mean_env_wait_ms": 0.15177155011534682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10849873224894206, "StateBufferConnector_ms": 0.009267330169677734, "ViewRequirementAgentConnector_ms": 0.12203137079874675}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.45754760070585, "num_env_steps_trained_throughput_per_sec": 232.45754760070585, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 16977.739, "sample_time_ms": 9702.318, "learn_time_ms": 7229.896, "learn_throughput": 553.258, "synch_weights_time_ms": 44.836}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 30, "training_iteration": 12, "trial_id": "2558d_00000", "date": "2023-09-10_13-58-39", "timestamp": 1694368719, "time_this_iter_s": 17.2131290435791, "time_total_s": 203.04078936576843, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c096d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 203.04078936576843, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.88148148148148, "ram_util_percent": 31.56296296296296}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4051673542397718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012415610987106144, "policy_loss": -0.01887918420494922, "vf_loss": 0.00395650158772393, "vf_explained_var": 0.7439946136747797, "kl": 0.012535356836908325, "entropy": 1.6450547820578019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3985058593749999, "episode_len_mean": 1275.725, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3985058593749999}, "custom_metrics": {"red_0/door_open_done_mean": 0.025, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4171015577336427, "mean_inference_ms": 1.7289408783518723, "mean_action_processing_ms": 0.10449140203832749, "mean_env_wait_ms": 0.1516707015015212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10655760765075684, "StateBufferConnector_ms": 0.008717775344848633, "ViewRequirementAgentConnector_ms": 0.12005984783172607}}, "episode_reward_max": 0.5872343749999999, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.3985058593749999, "episode_len_mean": 1275.725, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 0.5872343749999999}, "policy_reward_mean": {"red_0": 0.3985058593749999}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4171015577336427, "mean_inference_ms": 1.7289408783518723, "mean_action_processing_ms": 0.10449140203832749, "mean_env_wait_ms": 0.1516707015015212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10655760765075684, "StateBufferConnector_ms": 0.008717775344848633, "ViewRequirementAgentConnector_ms": 0.12005984783172607}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.34450647003175, "num_env_steps_trained_throughput_per_sec": 246.34450647003175, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 16888.395, "sample_time_ms": 9671.067, "learn_time_ms": 7171.447, "learn_throughput": 557.767, "synch_weights_time_ms": 45.193}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "2558d_00000", "date": "2023-09-10_13-58-58", "timestamp": 1694368738, "time_this_iter_s": 16.243359088897705, "time_total_s": 219.28414845466614, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c417c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 219.28414845466614, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 25.574074074074073, "ram_util_percent": 31.248148148148154}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3393294516640404, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006992630505556008, "policy_loss": -0.01650034922422492, "vf_loss": 0.007088365400310674, "vf_explained_var": 0.3527470656981071, "kl": 0.012096765048516053, "entropy": 1.6118457042922576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.42033765243902427, "episode_len_mean": 1251.560975609756, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.42033765243902427}, "custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41717715018280943, "mean_inference_ms": 1.7346202656400302, "mean_action_processing_ms": 0.10461632516797181, "mean_env_wait_ms": 0.15185961125072595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10792860170690025, "StateBufferConnector_ms": 0.008865100581471512, "ViewRequirementAgentConnector_ms": 0.1202647278948528}}, "episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.42033765243902427, "episode_len_mean": 1251.560975609756, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.42033765243902427}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41717715018280943, "mean_inference_ms": 1.7346202656400302, "mean_action_processing_ms": 0.10461632516797181, "mean_env_wait_ms": 0.15185961125072595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10792860170690025, "StateBufferConnector_ms": 0.008865100581471512, "ViewRequirementAgentConnector_ms": 0.1202647278948528}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.31851116969153, "num_env_steps_trained_throughput_per_sec": 247.31851116969153, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 16689.568, "sample_time_ms": 9621.421, "learn_time_ms": 7023.658, "learn_throughput": 569.504, "synch_weights_time_ms": 43.799}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 41, "training_iteration": 14, "trial_id": "2558d_00000", "date": "2023-09-10_13-59-16", "timestamp": 1694368756, "time_this_iter_s": 16.17920994758606, "time_total_s": 235.4633584022522, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c23b430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 235.4633584022522, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 25.08076923076923, "ram_util_percent": 31.203846153846158}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4586385514587163, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014981685808258286, "policy_loss": -0.01942565085773822, "vf_loss": 0.00031884675217952463, "vf_explained_var": -0.40262333005666734, "kl": 0.02062558900897223, "entropy": 1.6088114293913047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.42033765243902427, "episode_len_mean": 1251.560975609756, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.42033765243902427}, "custom_metrics": {"red_0/door_open_done_mean": 0.04878048780487805, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41717715018280943, "mean_inference_ms": 1.7346202656400302, "mean_action_processing_ms": 0.10461632516797181, "mean_env_wait_ms": 0.15185961125072595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10792860170690025, "StateBufferConnector_ms": 0.008865100581471512, "ViewRequirementAgentConnector_ms": 0.1202647278948528}}, "episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.42033765243902427, "episode_len_mean": 1251.560975609756, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.42033765243902427}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41717715018280943, "mean_inference_ms": 1.7346202656400302, "mean_action_processing_ms": 0.10461632516797181, "mean_env_wait_ms": 0.15185961125072595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10792860170690025, "StateBufferConnector_ms": 0.008865100581471512, "ViewRequirementAgentConnector_ms": 0.1202647278948528}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.0557792288527, "num_env_steps_trained_throughput_per_sec": 244.0557792288527, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 16668.992, "sample_time_ms": 9637.146, "learn_time_ms": 6987.552, "learn_throughput": 572.447, "synch_weights_time_ms": 43.601}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 41, "training_iteration": 15, "trial_id": "2558d_00000", "date": "2023-09-10_13-59-35", "timestamp": 1694368775, "time_this_iter_s": 16.3953378200531, "time_total_s": 251.8586962223053, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c2ba160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 251.8586962223053, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.35769230769231, "ram_util_percent": 31.138461538461545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4094724167138337, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013403215747045276, "policy_loss": -0.018100049700782012, "vf_loss": 0.001674053121776827, "vf_explained_var": 0.3837489693115155, "kl": 0.010075936124783413, "entropy": 1.567931193485856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.43005406249999983, "episode_len_mean": 1251.82, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.43005406249999983}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4166127782090723, "mean_inference_ms": 1.7285425924011124, "mean_action_processing_ms": 0.10447162025717298, "mean_env_wait_ms": 0.1514932138520644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1116037368774414, "StateBufferConnector_ms": 0.008647441864013672, "ViewRequirementAgentConnector_ms": 0.11958694458007812}}, "episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.43005406249999983, "episode_len_mean": 1251.82, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.43005406249999983}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4166127782090723, "mean_inference_ms": 1.7285425924011124, "mean_action_processing_ms": 0.10447162025717298, "mean_env_wait_ms": 0.1514932138520644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1116037368774414, "StateBufferConnector_ms": 0.008647441864013672, "ViewRequirementAgentConnector_ms": 0.11958694458007812}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.98775464442625, "num_env_steps_trained_throughput_per_sec": 247.98775464442625, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 16654.471, "sample_time_ms": 9620.323, "learn_time_ms": 6989.72, "learn_throughput": 572.269, "synch_weights_time_ms": 43.735}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "2558d_00000", "date": "2023-09-10_13-59-53", "timestamp": 1694368793, "time_this_iter_s": 16.137075901031494, "time_total_s": 267.9957721233368, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c1e9b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 267.9957721233368, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 23.81923076923077, "ram_util_percent": 31.2076923076923}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.09433962264150944, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.588500066784521, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0016388275752736567, "policy_loss": -0.017109960439362717, "vf_loss": 0.01582445308449678, "vf_explained_var": 0.3517436124384403, "kl": 0.009747783008678483, "entropy": 1.5619006385405858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.4614519457547168, "episode_len_mean": 1216.8867924528302, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.4614519457547168}, "custom_metrics": {"red_0/door_open_done_mean": 0.09433962264150944, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4165705066057578, "mean_inference_ms": 1.7314311666829358, "mean_action_processing_ms": 0.10450936836358259, "mean_env_wait_ms": 0.15151660737197467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1109806996471477, "StateBufferConnector_ms": 0.008553828833238134, "ViewRequirementAgentConnector_ms": 0.1191840981537441}}, "episode_reward_max": 1.293609375, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.4614519457547168, "episode_len_mean": 1216.8867924528302, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.293609375}, "policy_reward_mean": {"red_0": 0.4614519457547168}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4165705066057578, "mean_inference_ms": 1.7314311666829358, "mean_action_processing_ms": 0.10450936836358259, "mean_env_wait_ms": 0.15151660737197467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1109806996471477, "StateBufferConnector_ms": 0.008553828833238134, "ViewRequirementAgentConnector_ms": 0.1191840981537441}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.55598999951812, "num_env_steps_trained_throughput_per_sec": 238.55598999951812, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 16631.237, "sample_time_ms": 9634.254, "learn_time_ms": 6952.716, "learn_throughput": 575.315, "synch_weights_time_ms": 43.584}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 53, "training_iteration": 17, "trial_id": "2558d_00000", "date": "2023-09-10_14-00-12", "timestamp": 1694368812, "time_this_iter_s": 16.775933980941772, "time_total_s": 284.77170610427856, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf2aa60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 284.77170610427856, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.866666666666667, "ram_util_percent": 31.311111111111106}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1724137931034483, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5001393733546138, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.000928423024379299, "policy_loss": -0.015103993121253248, "vf_loss": 0.013343265068154626, "vf_explained_var": 0.3988911793256799, "kl": 0.008963837906851839, "entropy": 1.5234477366010348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1.363140625, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.514202047413793, "episode_len_mean": 1159.0689655172414, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.363140625}, "policy_reward_mean": {"red_0": 0.514202047413793}, "custom_metrics": {"red_0/door_open_done_mean": 0.1724137931034483, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41615936049483604, "mean_inference_ms": 1.7290805353613699, "mean_action_processing_ms": 0.10445849741585057, "mean_env_wait_ms": 0.15144338536894053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11119719209342167, "StateBufferConnector_ms": 0.008641029226368871, "ViewRequirementAgentConnector_ms": 0.11920189035349879}}, "episode_reward_max": 1.363140625, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.514202047413793, "episode_len_mean": 1159.0689655172414, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.363140625}, "policy_reward_mean": {"red_0": 0.514202047413793}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41615936049483604, "mean_inference_ms": 1.7290805353613699, "mean_action_processing_ms": 0.10445849741585057, "mean_env_wait_ms": 0.15144338536894053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11119719209342167, "StateBufferConnector_ms": 0.008641029226368871, "ViewRequirementAgentConnector_ms": 0.11920189035349879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.46391713851455, "num_env_steps_trained_throughput_per_sec": 241.46391713851455, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 16667.935, "sample_time_ms": 9662.464, "learn_time_ms": 6960.999, "learn_throughput": 574.63, "synch_weights_time_ms": 43.786}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 58, "training_iteration": 18, "trial_id": "2558d_00000", "date": "2023-09-10_14-00-31", "timestamp": 1694368831, "time_this_iter_s": 16.572930097579956, "time_total_s": 301.3446362018585, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15ff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 301.3446362018585, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.16666666666666, "ram_util_percent": 31.1925925925926}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.26153846153846155, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5697129043440023, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011060326998631353, "policy_loss": -0.014285431736789178, "vf_loss": 0.02280119588782933, "vf_explained_var": 0.4005595799535513, "kl": 0.008481875189583066, "entropy": 1.539064875120918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 1.3813125, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.5825100961538461, "episode_len_mean": 1083.2923076923078, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.3813125}, "policy_reward_mean": {"red_0": 0.5825100961538461}, "custom_metrics": {"red_0/door_open_done_mean": 0.26153846153846155, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41571446558463876, "mean_inference_ms": 1.7257684290768156, "mean_action_processing_ms": 0.10435748792278797, "mean_env_wait_ms": 0.15129553078719776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11007639077993539, "StateBufferConnector_ms": 0.008540887099045973, "ViewRequirementAgentConnector_ms": 0.1192775139441857}}, "episode_reward_max": 1.3813125, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.5825100961538461, "episode_len_mean": 1083.2923076923078, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.3813125}, "policy_reward_mean": {"red_0": 0.5825100961538461}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41571446558463876, "mean_inference_ms": 1.7257684290768156, "mean_action_processing_ms": 0.10435748792278797, "mean_env_wait_ms": 0.15129553078719776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11007639077993539, "StateBufferConnector_ms": 0.008540887099045973, "ViewRequirementAgentConnector_ms": 0.1192775139441857}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.43652843572414, "num_env_steps_trained_throughput_per_sec": 246.43652843572414, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 16667.99, "sample_time_ms": 9663.607, "learn_time_ms": 6960.188, "learn_throughput": 574.697, "synch_weights_time_ms": 43.503}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 65, "training_iteration": 19, "trial_id": "2558d_00000", "date": "2023-09-10_14-00-49", "timestamp": 1694368849, "time_this_iter_s": 16.238147735595703, "time_total_s": 317.5827839374542, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf290d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 317.5827839374542, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 25.988461538461536, "ram_util_percent": 31.142307692307693}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.34210526315789475, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5660124989847342, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.005112169881977024, "policy_loss": -0.014986816684540827, "vf_loss": 0.01778269479497491, "vf_explained_var": 0.6561510304609934, "kl": 0.007720973426353339, "entropy": 1.5357510613898435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 1.4365625, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.648061677631579, "episode_len_mean": 1009.3157894736842, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.4365625}, "policy_reward_mean": {"red_0": 0.648061677631579}, "custom_metrics": {"red_0/door_open_done_mean": 0.34210526315789475, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4153304912871503, "mean_inference_ms": 1.724961043609822, "mean_action_processing_ms": 0.10425408077797509, "mean_env_wait_ms": 0.15117699550636868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10936887640702098, "StateBufferConnector_ms": 0.008374452590942383, "ViewRequirementAgentConnector_ms": 0.11832086663497121}}, "episode_reward_max": 1.4365625, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.648061677631579, "episode_len_mean": 1009.3157894736842, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.4365625}, "policy_reward_mean": {"red_0": 0.648061677631579}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4153304912871503, "mean_inference_ms": 1.724961043609822, "mean_action_processing_ms": 0.10425408077797509, "mean_env_wait_ms": 0.15117699550636868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10936887640702098, "StateBufferConnector_ms": 0.008374452590942383, "ViewRequirementAgentConnector_ms": 0.11832086663497121}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.95553247310838, "num_env_steps_trained_throughput_per_sec": 246.95553247310838, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 16669.134, "sample_time_ms": 9644.473, "learn_time_ms": 6980.439, "learn_throughput": 573.03, "synch_weights_time_ms": 43.522}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 76, "training_iteration": 20, "trial_id": "2558d_00000", "date": "2023-09-10_14-01-08", "timestamp": 1694368868, "time_this_iter_s": 16.204489946365356, "time_total_s": 333.7872738838196, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf29f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 333.7872738838196, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 26.092307692307696, "ram_util_percent": 31.28461538461538}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.4574468085106383, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8029867552220822, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.028769450888891393, "policy_loss": -0.01790120147828323, "vf_loss": 0.04380044471666527, "vf_explained_var": 0.5848541820421815, "kl": 0.009567359032375104, "entropy": 1.5466564293950795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 1.4650625000000002, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.7774820478723403, "episode_len_mean": 857.4893617021277, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.4650625000000002}, "policy_reward_mean": {"red_0": 0.7774820478723403}, "custom_metrics": {"red_0/door_open_done_mean": 0.4574468085106383, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41500436940344965, "mean_inference_ms": 1.7321930422939027, "mean_action_processing_ms": 0.1042996967267094, "mean_env_wait_ms": 0.15127181002811432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10985288214176259, "StateBufferConnector_ms": 0.008231274625088306, "ViewRequirementAgentConnector_ms": 0.11872611147292117}}, "episode_reward_max": 1.4650625000000002, "episode_reward_min": 0.30899999999999983, "episode_reward_mean": 0.7774820478723403, "episode_len_mean": 857.4893617021277, "episodes_this_iter": 18, "policy_reward_min": {"red_0": 0.30899999999999983}, "policy_reward_max": {"red_0": 1.4650625000000002}, "policy_reward_mean": {"red_0": 0.7774820478723403}, "hist_stats": {"episode_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998], "episode_lengths": [1109, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81], "policy_red_0_reward": [0.5872343749999999, 0.30899999999999983, 0.33099999999999985, 0.30899999999999983, 0.34199999999999986, 0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41500436940344965, "mean_inference_ms": 1.7321930422939027, "mean_action_processing_ms": 0.1042996967267094, "mean_env_wait_ms": 0.15127181002811432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10985288214176259, "StateBufferConnector_ms": 0.008231274625088306, "ViewRequirementAgentConnector_ms": 0.11872611147292117}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.99457609500297, "num_env_steps_trained_throughput_per_sec": 249.99457609500297, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 16389.975, "sample_time_ms": 9586.317, "learn_time_ms": 6761.381, "learn_throughput": 591.595, "synch_weights_time_ms": 41.592}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 94, "training_iteration": 21, "trial_id": "2558d_00000", "date": "2023-09-10_14-01-26", "timestamp": 1694368886, "time_this_iter_s": 16.008445262908936, "time_total_s": 349.7957191467285, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c1b4dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 349.7957191467285, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 25.400000000000002, "ram_util_percent": 31.257692307692302}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.52, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7168290599559743, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0245588471871694, "policy_loss": -0.015476124109651816, "vf_loss": 0.037215519053279425, "vf_explained_var": 0.5305235259234905, "kl": 0.009398173793091649, "entropy": 1.535758193830649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 1.470984375, "episode_reward_min": 0.32899999999999985, "episode_reward_mean": 0.8503840625, "episode_len_mean": 776.3, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.32899999999999985}, "policy_reward_max": {"red_0": 1.470984375}, "policy_reward_mean": {"red_0": 0.8503840625}, "custom_metrics": {"red_0/door_open_done_mean": 0.52, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47], "policy_red_0_reward": [0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41476654572055693, "mean_inference_ms": 1.7319961054733344, "mean_action_processing_ms": 0.10427780163341811, "mean_env_wait_ms": 0.15121369222671177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10952949523925781, "StateBufferConnector_ms": 0.00814199447631836, "ViewRequirementAgentConnector_ms": 0.11896157264709473}}, "episode_reward_max": 1.470984375, "episode_reward_min": 0.32899999999999985, "episode_reward_mean": 0.8503840625, "episode_len_mean": 776.3, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.32899999999999985}, "policy_reward_max": {"red_0": 1.470984375}, "policy_reward_mean": {"red_0": 0.8503840625}, "hist_stats": {"episode_reward": [0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47], "policy_red_0_reward": [0.32899999999999985, 0.33799999999999986, 0.34199999999999986, 0.34799999999999986, 0.34099999999999986, 0.3909999999999999, 0.34299999999999986, 0.3639999999999999, 0.3669999999999999, 0.3589999999999999, 0.3999999999999999, 0.3679999999999999, 0.3589999999999999, 0.3809999999999999, 0.3679999999999999, 0.4079999999999999, 0.42699999999999994, 0.43199999999999994, 0.3999999999999999, 0.4139999999999999, 0.42899999999999994, 0.42099999999999993, 0.4149999999999999, 0.4169999999999999, 0.43199999999999994, 0.43199999999999994, 0.45599999999999996, 0.43899999999999995, 0.43999999999999995, 0.45299999999999996, 0.44399999999999995, 0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41476654572055693, "mean_inference_ms": 1.7319961054733344, "mean_action_processing_ms": 0.10427780163341811, "mean_env_wait_ms": 0.15121369222671177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10952949523925781, "StateBufferConnector_ms": 0.00814199447631836, "ViewRequirementAgentConnector_ms": 0.11896157264709473}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.3638477635998, "num_env_steps_trained_throughput_per_sec": 247.3638477635998, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 16286.282, "sample_time_ms": 9492.075, "learn_time_ms": 6751.607, "learn_throughput": 592.452, "synch_weights_time_ms": 41.928}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 105, "training_iteration": 22, "trial_id": "2558d_00000", "date": "2023-09-10_14-01-44", "timestamp": 1694368904, "time_this_iter_s": 16.17802596092224, "time_total_s": 365.97374510765076, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c1b48b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 365.97374510765076, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 26.365384615384617, "ram_util_percent": 31.27692307692308}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.81, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7378914176796874, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02418181367120269, "policy_loss": -0.022597365151159465, "vf_loss": 0.04341832690600616, "vf_explained_var": 0.6503294179836909, "kl": 0.011202838300247842, "entropy": 1.4468364921708903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 1.48875, "episode_reward_min": 0.3739999999999999, "episode_reward_mean": 1.142986875, "episode_len_mean": 440.04, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {"red_0": 0.3739999999999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.142986875}, "custom_metrics": {"red_0/door_open_done_mean": 0.81, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625], "episode_lengths": [1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47, 129, 198, 47, 58, 1280, 61, 45, 182, 82, 16, 74, 205, 93, 76, 92, 45, 855, 61, 41, 205, 80, 100, 1280, 63, 104, 40, 181, 70, 142, 90, 59], "policy_red_0_reward": [0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41324186524291856, "mean_inference_ms": 1.7304200280357838, "mean_action_processing_ms": 0.1040087997157185, "mean_env_wait_ms": 0.15094551944445883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10830426216125488, "StateBufferConnector_ms": 0.007764577865600586, "ViewRequirementAgentConnector_ms": 0.11838054656982422}}, "episode_reward_max": 1.48875, "episode_reward_min": 0.3739999999999999, "episode_reward_mean": 1.142986875, "episode_len_mean": 440.04, "episodes_this_iter": 31, "policy_reward_min": {"red_0": 0.3739999999999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.142986875}, "hist_stats": {"episode_reward": [0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625], "episode_lengths": [1280, 1280, 1280, 1280, 285, 1280, 1280, 1280, 1280, 1280, 1280, 1037, 1280, 1280, 1280, 305, 319, 529, 716, 179, 718, 589, 1044, 517, 975, 179, 156, 156, 161, 1280, 1080, 274, 164, 1280, 1248, 82, 76, 105, 521, 184, 82, 78, 81, 54, 82, 632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47, 129, 198, 47, 58, 1280, 61, 45, 182, 82, 16, 74, 205, 93, 76, 92, 45, 855, 61, 41, 205, 80, 100, 1280, 63, 104, 40, 181, 70, 142, 90, 59], "policy_red_0_reward": [0.44099999999999995, 0.45299999999999996, 0.45699999999999996, 0.45399999999999996, 1.293609375, 0.45699999999999996, 0.4179999999999999, 0.45299999999999996, 0.47, 0.4159999999999999, 0.44299999999999995, 0.713859375, 0.43899999999999995, 0.45899999999999996, 0.43799999999999994, 1.254546875, 1.261703125, 1.102046875, 0.9255625, 1.363140625, 0.9381562499999999, 1.037859375, 0.6979374999999999, 1.100484375, 0.765453125, 1.359140625, 1.3813125, 1.3763125, 1.358796875, 0.42399999999999993, 0.6806249999999999, 1.28334375, 1.3716875, 0.3819999999999999, 0.5155, 1.43134375, 1.4365625, 1.4081718749999999, 1.0996718749999999, 1.356625, 1.43634375, 1.4371562500000001, 1.438046875, 1.46203125, 1.4333437500000001, 0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41324186524291856, "mean_inference_ms": 1.7304200280357838, "mean_action_processing_ms": 0.1040087997157185, "mean_env_wait_ms": 0.15094551944445883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10830426216125488, "StateBufferConnector_ms": 0.007764577865600586, "ViewRequirementAgentConnector_ms": 0.11838054656982422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.39669651522567, "num_env_steps_trained_throughput_per_sec": 243.39669651522567, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 16305.948, "sample_time_ms": 9501.467, "learn_time_ms": 6761.871, "learn_throughput": 591.552, "synch_weights_time_ms": 41.94}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 136, "training_iteration": 23, "trial_id": "2558d_00000", "date": "2023-09-10_14-02-03", "timestamp": 1694368923, "time_this_iter_s": 16.44176697731018, "time_total_s": 382.41551208496094, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15f430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 382.41551208496094, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 26.140740740740743, "ram_util_percent": 31.21111111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.95, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8884279165416955, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.025068170008914117, "policy_loss": -0.02674049987253966, "vf_loss": 0.04752678046934307, "vf_explained_var": 0.6110883843153715, "kl": 0.014272961900978013, "entropy": 1.372648366789023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 1.48875, "episode_reward_min": 0.3739999999999999, "episode_reward_mean": 1.3601881250000005, "episode_len_mean": 171.48, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {"red_0": 0.3739999999999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.3601881250000005}, "custom_metrics": {"red_0/door_open_done_mean": 0.95, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625, 1.43190625, 1.475203125, 1.454703125, 1.444890625, 1.3839375, 1.4670625, 1.412328125, 1.4390468749999998, 1.443078125, 1.456515625, 1.474796875, 1.4237968749999999, 1.4471875, 1.40121875, 1.45059375, 1.4508125, 1.4441875, 1.483125, 1.467765625, 1.47890625, 1.4264999999999999, 1.4732812499999999, 1.44759375, 1.387375, 1.455734375, 1.3746874999999998, 1.43875, 1.483828125, 1.46265625, 1.456921875, 1.3682343750000001, 1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999], "episode_lengths": [632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47, 129, 198, 47, 58, 1280, 61, 45, 182, 82, 16, 74, 205, 93, 76, 92, 45, 855, 61, 41, 205, 80, 100, 1280, 63, 104, 40, 181, 70, 142, 90, 59, 94, 31, 63, 67, 148, 44, 119, 81, 71, 59, 33, 97, 68, 122, 66, 60, 68, 24, 43, 30, 96, 38, 66, 136, 53, 164, 80, 23, 46, 57, 149, 50, 74, 46, 33, 33, 31, 59, 92, 112, 82, 63, 47, 22, 1280], "policy_red_0_reward": [0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625, 1.43190625, 1.475203125, 1.454703125, 1.444890625, 1.3839375, 1.4670625, 1.412328125, 1.4390468749999998, 1.443078125, 1.456515625, 1.474796875, 1.4237968749999999, 1.4471875, 1.40121875, 1.45059375, 1.4508125, 1.4441875, 1.483125, 1.467765625, 1.47890625, 1.4264999999999999, 1.4732812499999999, 1.44759375, 1.387375, 1.455734375, 1.3746874999999998, 1.43875, 1.483828125, 1.46265625, 1.456921875, 1.3682343750000001, 1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4133237801958775, "mean_inference_ms": 1.7237812996989337, "mean_action_processing_ms": 0.10376931573992673, "mean_env_wait_ms": 0.15096335736062774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10692381858825684, "StateBufferConnector_ms": 0.00792837142944336, "ViewRequirementAgentConnector_ms": 0.12022876739501953}}, "episode_reward_max": 1.48875, "episode_reward_min": 0.3739999999999999, "episode_reward_mean": 1.3601881250000005, "episode_len_mean": 171.48, "episodes_this_iter": 45, "policy_reward_min": {"red_0": 0.3739999999999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.3601881250000005}, "hist_stats": {"episode_reward": [0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625, 1.43190625, 1.475203125, 1.454703125, 1.444890625, 1.3839375, 1.4670625, 1.412328125, 1.4390468749999998, 1.443078125, 1.456515625, 1.474796875, 1.4237968749999999, 1.4471875, 1.40121875, 1.45059375, 1.4508125, 1.4441875, 1.483125, 1.467765625, 1.47890625, 1.4264999999999999, 1.4732812499999999, 1.44759375, 1.387375, 1.455734375, 1.3746874999999998, 1.43875, 1.483828125, 1.46265625, 1.456921875, 1.3682343750000001, 1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999], "episode_lengths": [632, 139, 105, 204, 213, 348, 57, 138, 44, 161, 1280, 117, 81, 324, 42, 244, 189, 37, 458, 84, 1280, 110, 440, 47, 129, 198, 47, 58, 1280, 61, 45, 182, 82, 16, 74, 205, 93, 76, 92, 45, 855, 61, 41, 205, 80, 100, 1280, 63, 104, 40, 181, 70, 142, 90, 59, 94, 31, 63, 67, 148, 44, 119, 81, 71, 59, 33, 97, 68, 122, 66, 60, 68, 24, 43, 30, 96, 38, 66, 136, 53, 164, 80, 23, 46, 57, 149, 50, 74, 46, 33, 33, 31, 59, 92, 112, 82, 63, 47, 22, 1280], "policy_red_0_reward": [0.994625, 1.390265625, 1.4161718749999999, 1.3445624999999999, 1.331234375, 1.2283125, 1.457921875, 1.3869687499999999, 1.4650625000000002, 1.374796875, 0.3869999999999999, 1.407734375, 1.4390468749999998, 1.2431875, 1.4694687499999999, 1.3104375, 1.355109375, 1.470984375, 1.12396875, 1.4389375, 0.3969999999999999, 1.41465625, 1.1476250000000001, 1.461953125, 1.400296875, 1.34678125, 1.461953125, 1.4562187500000001, 0.3739999999999999, 1.4551093750000001, 1.463359375, 1.35603125, 1.43634375, 1.48875, 1.44296875, 1.3378593749999999, 1.425609375, 1.4455624999999999, 1.4303124999999999, 1.465359375, 0.8288281249999999, 1.452109375, 1.471171875, 1.338859375, 1.43975, 1.4246875, 0.3739999999999999, 1.452703125, 1.421875, 1.470875, 1.334734375, 1.44978125, 1.39415625, 1.43271875, 1.444515625, 1.43190625, 1.475203125, 1.454703125, 1.444890625, 1.3839375, 1.4670625, 1.412328125, 1.4390468749999998, 1.443078125, 1.456515625, 1.474796875, 1.4237968749999999, 1.4471875, 1.40121875, 1.45059375, 1.4508125, 1.4441875, 1.483125, 1.467765625, 1.47890625, 1.4264999999999999, 1.4732812499999999, 1.44759375, 1.387375, 1.455734375, 1.3746874999999998, 1.43875, 1.483828125, 1.46265625, 1.456921875, 1.3682343750000001, 1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4133237801958775, "mean_inference_ms": 1.7237812996989337, "mean_action_processing_ms": 0.10376931573992673, "mean_env_wait_ms": 0.15096335736062774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10692381858825684, "StateBufferConnector_ms": 0.00792837142944336, "ViewRequirementAgentConnector_ms": 0.12022876739501953}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.31835640681732, "num_env_steps_trained_throughput_per_sec": 242.31835640681732, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 16339.322, "sample_time_ms": 9526.622, "learn_time_ms": 6770.1, "learn_throughput": 590.833, "synch_weights_time_ms": 41.936}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 181, "training_iteration": 24, "trial_id": "2558d_00000", "date": "2023-09-10_14-02-22", "timestamp": 1694368942, "time_this_iter_s": 16.516399145126343, "time_total_s": 398.9319112300873, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf295e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 398.9319112300873, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 27.865384615384617, "ram_util_percent": 31.192307692307686}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.81080187552919, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.022410047549177154, "policy_loss": -0.02211867243555995, "vf_loss": 0.0408939158602152, "vf_explained_var": 0.6495717966929078, "kl": 0.01211601319116653, "entropy": 1.3160188511013984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 0.3799999999999999, "episode_reward_mean": 1.4426326562500003, "episode_len_mean": 71.15, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {"red_0": 0.3799999999999999}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4426326562500003}, "custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999, 1.456515625, 1.4625468750000001, 1.46065625, 1.470984375, 1.47790625, 1.474796875, 1.450703125, 1.485640625, 1.454109375, 1.344875, 1.4735, 1.448703125, 1.476609375, 1.475390625, 1.445078125, 1.4669531249999999, 1.4705781249999998, 1.4512968750000002, 1.463546875, 1.48353125, 1.461953125, 1.475609375, 1.4716875, 1.446375, 1.452296875, 1.46103125, 1.429015625, 1.468984375, 1.4828281250000002, 1.4736875, 1.44678125, 1.4859375, 1.4729062499999999, 1.4726875000000001, 1.48734375, 1.4692812499999999, 1.48353125, 1.429421875, 1.457921875, 1.467359375, 1.4765000000000001, 1.4746875, 1.4425625, 1.468171875, 1.467578125, 1.453109375, 0.3799999999999999, 1.479609375, 1.483828125, 1.488046875, 1.47028125, 1.44678125, 1.461546875, 1.4782031249999998, 1.4572500000000002, 1.4589218750000001, 1.4614375, 1.475796875, 1.463953125, 1.468578125, 1.483828125, 1.4745, 1.4755, 1.4604374999999998, 1.450703125, 1.402328125, 1.46365625, 1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001], "episode_lengths": [50, 74, 46, 33, 33, 31, 59, 92, 112, 82, 63, 47, 22, 1280, 59, 49, 46, 37, 30, 33, 63, 19, 61, 168, 32, 63, 29, 35, 71, 47, 39, 65, 49, 22, 47, 29, 36, 72, 65, 54, 91, 37, 23, 36, 70, 20, 30, 36, 18, 38, 22, 89, 57, 45, 32, 36, 76, 41, 39, 61, 1280, 29, 23, 17, 38, 70, 49, 31, 48, 57, 52, 33, 47, 39, 23, 32, 32, 52, 63, 119, 46, 27, 29, 34, 30, 17, 31, 51, 70, 43, 34, 41, 35, 29, 33, 30, 38, 35, 46, 41], "policy_red_0_reward": [1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999, 1.456515625, 1.4625468750000001, 1.46065625, 1.470984375, 1.47790625, 1.474796875, 1.450703125, 1.485640625, 1.454109375, 1.344875, 1.4735, 1.448703125, 1.476609375, 1.475390625, 1.445078125, 1.4669531249999999, 1.4705781249999998, 1.4512968750000002, 1.463546875, 1.48353125, 1.461953125, 1.475609375, 1.4716875, 1.446375, 1.452296875, 1.46103125, 1.429015625, 1.468984375, 1.4828281250000002, 1.4736875, 1.44678125, 1.4859375, 1.4729062499999999, 1.4726875000000001, 1.48734375, 1.4692812499999999, 1.48353125, 1.429421875, 1.457921875, 1.467359375, 1.4765000000000001, 1.4746875, 1.4425625, 1.468171875, 1.467578125, 1.453109375, 0.3799999999999999, 1.479609375, 1.483828125, 1.488046875, 1.47028125, 1.44678125, 1.461546875, 1.4782031249999998, 1.4572500000000002, 1.4589218750000001, 1.4614375, 1.475796875, 1.463953125, 1.468578125, 1.483828125, 1.4745, 1.4755, 1.4604374999999998, 1.450703125, 1.402328125, 1.46365625, 1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4136744979517529, "mean_inference_ms": 1.7125653751717629, "mean_action_processing_ms": 0.103284466996028, "mean_env_wait_ms": 0.15060721100535893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10726809501647949, "StateBufferConnector_ms": 0.008575677871704102, "ViewRequirementAgentConnector_ms": 0.11979126930236816}}, "episode_reward_max": 1.488046875, "episode_reward_min": 0.3799999999999999, "episode_reward_mean": 1.4426326562500003, "episode_len_mean": 71.15, "episodes_this_iter": 86, "policy_reward_min": {"red_0": 0.3799999999999999}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4426326562500003}, "hist_stats": {"episode_reward": [1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999, 1.456515625, 1.4625468750000001, 1.46065625, 1.470984375, 1.47790625, 1.474796875, 1.450703125, 1.485640625, 1.454109375, 1.344875, 1.4735, 1.448703125, 1.476609375, 1.475390625, 1.445078125, 1.4669531249999999, 1.4705781249999998, 1.4512968750000002, 1.463546875, 1.48353125, 1.461953125, 1.475609375, 1.4716875, 1.446375, 1.452296875, 1.46103125, 1.429015625, 1.468984375, 1.4828281250000002, 1.4736875, 1.44678125, 1.4859375, 1.4729062499999999, 1.4726875000000001, 1.48734375, 1.4692812499999999, 1.48353125, 1.429421875, 1.457921875, 1.467359375, 1.4765000000000001, 1.4746875, 1.4425625, 1.468171875, 1.467578125, 1.453109375, 0.3799999999999999, 1.479609375, 1.483828125, 1.488046875, 1.47028125, 1.44678125, 1.461546875, 1.4782031249999998, 1.4572500000000002, 1.4589218750000001, 1.4614375, 1.475796875, 1.463953125, 1.468578125, 1.483828125, 1.4745, 1.4755, 1.4604374999999998, 1.450703125, 1.402328125, 1.46365625, 1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001], "episode_lengths": [50, 74, 46, 33, 33, 31, 59, 92, 112, 82, 63, 47, 22, 1280, 59, 49, 46, 37, 30, 33, 63, 19, 61, 168, 32, 63, 29, 35, 71, 47, 39, 65, 49, 22, 47, 29, 36, 72, 65, 54, 91, 37, 23, 36, 70, 20, 30, 36, 18, 38, 22, 89, 57, 45, 32, 36, 76, 41, 39, 61, 1280, 29, 23, 17, 38, 70, 49, 31, 48, 57, 52, 33, 47, 39, 23, 32, 32, 52, 63, 119, 46, 27, 29, 34, 30, 17, 31, 51, 70, 43, 34, 41, 35, 29, 33, 30, 38, 35, 46, 41], "policy_red_0_reward": [1.45884375, 1.4449687500000001, 1.46465625, 1.476796875, 1.4737968750000001, 1.476203125, 1.4555156249999999, 1.4303124999999999, 1.4172500000000001, 1.4373437500000001, 1.449703125, 1.461953125, 1.48353125, 0.4069999999999999, 1.456515625, 1.4625468750000001, 1.46065625, 1.470984375, 1.47790625, 1.474796875, 1.450703125, 1.485640625, 1.454109375, 1.344875, 1.4735, 1.448703125, 1.476609375, 1.475390625, 1.445078125, 1.4669531249999999, 1.4705781249999998, 1.4512968750000002, 1.463546875, 1.48353125, 1.461953125, 1.475609375, 1.4716875, 1.446375, 1.452296875, 1.46103125, 1.429015625, 1.468984375, 1.4828281250000002, 1.4736875, 1.44678125, 1.4859375, 1.4729062499999999, 1.4726875000000001, 1.48734375, 1.4692812499999999, 1.48353125, 1.429421875, 1.457921875, 1.467359375, 1.4765000000000001, 1.4746875, 1.4425625, 1.468171875, 1.467578125, 1.453109375, 0.3799999999999999, 1.479609375, 1.483828125, 1.488046875, 1.47028125, 1.44678125, 1.461546875, 1.4782031249999998, 1.4572500000000002, 1.4589218750000001, 1.4614375, 1.475796875, 1.463953125, 1.468578125, 1.483828125, 1.4745, 1.4755, 1.4604374999999998, 1.450703125, 1.402328125, 1.46365625, 1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4136744979517529, "mean_inference_ms": 1.7125653751717629, "mean_action_processing_ms": 0.103284466996028, "mean_env_wait_ms": 0.15060721100535893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10726809501647949, "StateBufferConnector_ms": 0.008575677871704102, "ViewRequirementAgentConnector_ms": 0.11979126930236816}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.72701206876178, "num_env_steps_trained_throughput_per_sec": 246.72701206876178, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 16321.578, "sample_time_ms": 9502.425, "learn_time_ms": 6776.453, "learn_throughput": 590.279, "synch_weights_time_ms": 42.035}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 267, "training_iteration": 25, "trial_id": "2558d_00000", "date": "2023-09-10_14-02-40", "timestamp": 1694368960, "time_this_iter_s": 16.22132897377014, "time_total_s": 415.1532402038574, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf290d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 415.1532402038574, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.461538461538456, "ram_util_percent": 31.207692307692312}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.89908522075663, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.024319575980795587, "policy_loss": -0.02397783642251549, "vf_loss": 0.044873981953909, "vf_explained_var": 0.7134587376068036, "kl": 0.011411433870313204, "entropy": 1.2545154109597205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 1.4076093749999998, "episode_reward_mean": 1.4699912499999999, "episode_len_mean": 38.0, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {"red_0": 1.4076093749999998}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4699912499999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001, 1.4590625, 1.4793125, 1.482421875, 1.46465625, 1.460734375, 1.4590625, 1.4076093749999998, 1.47609375, 1.483828125, 1.445484375, 1.480015625, 1.4793125, 1.467765625, 1.465359375, 1.433234375, 1.457359375, 1.484234375, 1.4665, 1.48171875, 1.4485937500000001, 1.465796875, 1.481421875, 1.47609375, 1.4697968750000001, 1.4801250000000001, 1.456921875, 1.46646875, 1.469765625, 1.4765000000000001, 1.48634375, 1.47390625, 1.4667656249999999, 1.477203125, 1.4276093749999998, 1.479015625, 1.464359375, 1.4828281250000002, 1.46746875, 1.476015625, 1.4680625, 1.474609375, 1.481015625, 1.464765625, 1.4384843749999998, 1.4743906249999998, 1.46246875, 1.480421875, 1.483828125, 1.48353125, 1.482125, 1.476796875, 1.478609375, 1.448515625, 1.4807187499999999, 1.465171875, 1.4845312499999999, 1.472578125, 1.4697968750000001, 1.4765000000000001, 1.4726875000000001, 1.458140625, 1.479015625, 1.4793125, 1.4627656249999998, 1.4562187500000001, 1.4670625, 1.463359375, 1.481015625, 1.443375, 1.485640625, 1.47790625, 1.485234375, 1.47971875, 1.47490625, 1.450296875, 1.485234375, 1.4629531249999999, 1.452, 1.4870468749999999, 1.481828125, 1.4726875000000001], "episode_lengths": [27, 29, 34, 30, 17, 31, 51, 70, 43, 34, 41, 35, 29, 33, 30, 38, 35, 46, 41, 44, 28, 25, 46, 53, 44, 93, 34, 23, 69, 27, 28, 43, 45, 85, 45, 21, 32, 26, 66, 33, 25, 34, 33, 24, 57, 42, 43, 32, 18, 30, 43, 31, 93, 27, 45, 23, 42, 27, 44, 29, 27, 43, 69, 35, 42, 25, 23, 22, 24, 33, 29, 59, 26, 41, 22, 39, 33, 32, 36, 51, 27, 28, 43, 58, 44, 45, 27, 72, 19, 30, 21, 26, 30, 65, 21, 47, 64, 17, 23, 36], "policy_red_0_reward": [1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001, 1.4590625, 1.4793125, 1.482421875, 1.46465625, 1.460734375, 1.4590625, 1.4076093749999998, 1.47609375, 1.483828125, 1.445484375, 1.480015625, 1.4793125, 1.467765625, 1.465359375, 1.433234375, 1.457359375, 1.484234375, 1.4665, 1.48171875, 1.4485937500000001, 1.465796875, 1.481421875, 1.47609375, 1.4697968750000001, 1.4801250000000001, 1.456921875, 1.46646875, 1.469765625, 1.4765000000000001, 1.48634375, 1.47390625, 1.4667656249999999, 1.477203125, 1.4276093749999998, 1.479015625, 1.464359375, 1.4828281250000002, 1.46746875, 1.476015625, 1.4680625, 1.474609375, 1.481015625, 1.464765625, 1.4384843749999998, 1.4743906249999998, 1.46246875, 1.480421875, 1.483828125, 1.48353125, 1.482125, 1.476796875, 1.478609375, 1.448515625, 1.4807187499999999, 1.465171875, 1.4845312499999999, 1.472578125, 1.4697968750000001, 1.4765000000000001, 1.4726875000000001, 1.458140625, 1.479015625, 1.4793125, 1.4627656249999998, 1.4562187500000001, 1.4670625, 1.463359375, 1.481015625, 1.443375, 1.485640625, 1.47790625, 1.485234375, 1.47971875, 1.47490625, 1.450296875, 1.485234375, 1.4629531249999999, 1.452, 1.4870468749999999, 1.481828125, 1.4726875000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41520219286034205, "mean_inference_ms": 1.7120400941085359, "mean_action_processing_ms": 0.10319428398813284, "mean_env_wait_ms": 0.1507769109487568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10637331008911133, "StateBufferConnector_ms": 0.008501529693603516, "ViewRequirementAgentConnector_ms": 0.11942672729492188}}, "episode_reward_max": 1.488046875, "episode_reward_min": 1.4076093749999998, "episode_reward_mean": 1.4699912499999999, "episode_len_mean": 38.0, "episodes_this_iter": 81, "policy_reward_min": {"red_0": 1.4076093749999998}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4699912499999999}, "hist_stats": {"episode_reward": [1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001, 1.4590625, 1.4793125, 1.482421875, 1.46465625, 1.460734375, 1.4590625, 1.4076093749999998, 1.47609375, 1.483828125, 1.445484375, 1.480015625, 1.4793125, 1.467765625, 1.465359375, 1.433234375, 1.457359375, 1.484234375, 1.4665, 1.48171875, 1.4485937500000001, 1.465796875, 1.481421875, 1.47609375, 1.4697968750000001, 1.4801250000000001, 1.456921875, 1.46646875, 1.469765625, 1.4765000000000001, 1.48634375, 1.47390625, 1.4667656249999999, 1.477203125, 1.4276093749999998, 1.479015625, 1.464359375, 1.4828281250000002, 1.46746875, 1.476015625, 1.4680625, 1.474609375, 1.481015625, 1.464765625, 1.4384843749999998, 1.4743906249999998, 1.46246875, 1.480421875, 1.483828125, 1.48353125, 1.482125, 1.476796875, 1.478609375, 1.448515625, 1.4807187499999999, 1.465171875, 1.4845312499999999, 1.472578125, 1.4697968750000001, 1.4765000000000001, 1.4726875000000001, 1.458140625, 1.479015625, 1.4793125, 1.4627656249999998, 1.4562187500000001, 1.4670625, 1.463359375, 1.481015625, 1.443375, 1.485640625, 1.47790625, 1.485234375, 1.47971875, 1.47490625, 1.450296875, 1.485234375, 1.4629531249999999, 1.452, 1.4870468749999999, 1.481828125, 1.4726875000000001], "episode_lengths": [27, 29, 34, 30, 17, 31, 51, 70, 43, 34, 41, 35, 29, 33, 30, 38, 35, 46, 41, 44, 28, 25, 46, 53, 44, 93, 34, 23, 69, 27, 28, 43, 45, 85, 45, 21, 32, 26, 66, 33, 25, 34, 33, 24, 57, 42, 43, 32, 18, 30, 43, 31, 93, 27, 45, 23, 42, 27, 44, 29, 27, 43, 69, 35, 42, 25, 23, 22, 24, 33, 29, 59, 26, 41, 22, 39, 33, 32, 36, 51, 27, 28, 43, 58, 44, 45, 27, 72, 19, 30, 21, 26, 30, 65, 21, 47, 64, 17, 23, 36], "policy_red_0_reward": [1.480015625, 1.474609375, 1.47409375, 1.47590625, 1.488046875, 1.475203125, 1.4631406249999999, 1.44678125, 1.465765625, 1.4730937499999999, 1.467171875, 1.473390625, 1.479609375, 1.475796875, 1.47790625, 1.46728125, 1.472390625, 1.46665625, 1.4701718750000001, 1.4590625, 1.4793125, 1.482421875, 1.46465625, 1.460734375, 1.4590625, 1.4076093749999998, 1.47609375, 1.483828125, 1.445484375, 1.480015625, 1.4793125, 1.467765625, 1.465359375, 1.433234375, 1.457359375, 1.484234375, 1.4665, 1.48171875, 1.4485937500000001, 1.465796875, 1.481421875, 1.47609375, 1.4697968750000001, 1.4801250000000001, 1.456921875, 1.46646875, 1.469765625, 1.4765000000000001, 1.48634375, 1.47390625, 1.4667656249999999, 1.477203125, 1.4276093749999998, 1.479015625, 1.464359375, 1.4828281250000002, 1.46746875, 1.476015625, 1.4680625, 1.474609375, 1.481015625, 1.464765625, 1.4384843749999998, 1.4743906249999998, 1.46246875, 1.480421875, 1.483828125, 1.48353125, 1.482125, 1.476796875, 1.478609375, 1.448515625, 1.4807187499999999, 1.465171875, 1.4845312499999999, 1.472578125, 1.4697968750000001, 1.4765000000000001, 1.4726875000000001, 1.458140625, 1.479015625, 1.4793125, 1.4627656249999998, 1.4562187500000001, 1.4670625, 1.463359375, 1.481015625, 1.443375, 1.485640625, 1.47790625, 1.485234375, 1.47971875, 1.47490625, 1.450296875, 1.485234375, 1.4629531249999999, 1.452, 1.4870468749999999, 1.481828125, 1.4726875000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41520219286034205, "mean_inference_ms": 1.7120400941085359, "mean_action_processing_ms": 0.10319428398813284, "mean_env_wait_ms": 0.1507769109487568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10637331008911133, "StateBufferConnector_ms": 0.008501529693603516, "ViewRequirementAgentConnector_ms": 0.11942672729492188}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.7254306429237, "num_env_steps_trained_throughput_per_sec": 238.7254306429237, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 16384.16, "sample_time_ms": 9545.843, "learn_time_ms": 6795.846, "learn_throughput": 588.595, "synch_weights_time_ms": 41.809}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 348, "training_iteration": 26, "trial_id": "2558d_00000", "date": "2023-09-10_14-02-59", "timestamp": 1694368979, "time_this_iter_s": 16.767348051071167, "time_total_s": 431.9205882549286, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c2b9e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 431.9205882549286, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.91111111111111, "ram_util_percent": 31.159259259259265}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7771410095815858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010864782235148595, "policy_loss": -0.02503236500294103, "vf_loss": 0.031163923942464557, "vf_explained_var": 0.818488638351361, "kl": 0.015777410719128162, "entropy": 1.1621655151247978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 1.49015625, "episode_reward_min": 0.7687499999999999, "episode_reward_mean": 1.4693972772277228, "episode_len_mean": 39.524752475247524, "episode_media": {}, "episodes_this_iter": 101, "policy_reward_min": {"red_0": 0.7687499999999999}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4693972772277228}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4654687499999999, 1.4441875, 1.488046875, 1.4832343749999999, 1.47228125, 1.4776093750000001, 1.477203125, 1.475390625, 1.4866406250000002, 1.485640625, 1.477203125, 1.4732812499999999, 1.474796875, 1.4832343749999999, 1.4828281250000002, 1.475390625, 1.4805312499999999, 1.482125, 1.484234375, 1.4775, 1.48253125, 1.4694687499999999, 1.4794218749999999, 1.4699843750000001, 1.48353125, 1.4765000000000001, 1.457546875, 1.4765000000000001, 1.4574375, 1.472390625, 1.483828125, 1.481015625, 1.4737968750000001, 1.47509375, 1.465171875, 1.4686875000000001, 1.4859375, 1.476203125, 1.481828125, 1.48734375, 1.47490625, 1.4515156249999999, 1.481125, 1.478609375, 1.481015625, 1.480421875, 1.485640625, 1.474796875, 1.4828281250000002, 1.49015625, 1.4743906249999998, 1.470796875, 1.473609375, 1.482125, 1.4807187499999999, 1.4793125, 1.477421875, 1.4845312499999999, 1.480421875, 1.4803125000000001, 1.475796875, 1.47509375, 1.4845312499999999, 1.48734375, 1.48353125, 1.4703906249999998, 1.47209375, 1.47871875, 1.4341249999999999, 1.469765625, 1.4746875, 1.4566249999999998, 1.457921875, 1.480015625, 1.488046875, 1.472984375, 1.466875, 1.480421875, 1.4730937499999999, 1.470984375, 1.478609375, 1.479015625, 1.471984375, 1.481125, 1.4859375, 1.4773125, 1.473203125, 0.7687499999999999, 1.483125, 1.483125, 1.484234375, 1.48171875, 1.48734375, 1.4716875, 1.485234375, 1.481015625, 1.476609375, 1.475796875, 1.4845312499999999, 1.4726875000000001, 1.457328125], "episode_lengths": [42, 68, 17, 21, 38, 29, 31, 35, 19, 19, 31, 38, 33, 21, 23, 35, 22, 24, 21, 32, 22, 42, 25, 37, 22, 32, 49, 32, 52, 35, 23, 27, 33, 34, 41, 36, 20, 31, 23, 18, 30, 59, 24, 29, 27, 25, 19, 33, 23, 14, 35, 33, 29, 24, 26, 28, 25, 22, 25, 28, 33, 34, 22, 18, 22, 35, 34, 26, 88, 43, 36, 56, 57, 27, 17, 37, 40, 25, 34, 37, 29, 27, 37, 24, 20, 28, 31, 912, 24, 24, 21, 26, 18, 36, 21, 27, 29, 33, 22, 36, 55], "policy_red_0_reward": [1.4654687499999999, 1.4441875, 1.488046875, 1.4832343749999999, 1.47228125, 1.4776093750000001, 1.477203125, 1.475390625, 1.4866406250000002, 1.485640625, 1.477203125, 1.4732812499999999, 1.474796875, 1.4832343749999999, 1.4828281250000002, 1.475390625, 1.4805312499999999, 1.482125, 1.484234375, 1.4775, 1.48253125, 1.4694687499999999, 1.4794218749999999, 1.4699843750000001, 1.48353125, 1.4765000000000001, 1.457546875, 1.4765000000000001, 1.4574375, 1.472390625, 1.483828125, 1.481015625, 1.4737968750000001, 1.47509375, 1.465171875, 1.4686875000000001, 1.4859375, 1.476203125, 1.481828125, 1.48734375, 1.47490625, 1.4515156249999999, 1.481125, 1.478609375, 1.481015625, 1.480421875, 1.485640625, 1.474796875, 1.4828281250000002, 1.49015625, 1.4743906249999998, 1.470796875, 1.473609375, 1.482125, 1.4807187499999999, 1.4793125, 1.477421875, 1.4845312499999999, 1.480421875, 1.4803125000000001, 1.475796875, 1.47509375, 1.4845312499999999, 1.48734375, 1.48353125, 1.4703906249999998, 1.47209375, 1.47871875, 1.4341249999999999, 1.469765625, 1.4746875, 1.4566249999999998, 1.457921875, 1.480015625, 1.488046875, 1.472984375, 1.466875, 1.480421875, 1.4730937499999999, 1.470984375, 1.478609375, 1.479015625, 1.471984375, 1.481125, 1.4859375, 1.4773125, 1.473203125, 0.7687499999999999, 1.483125, 1.483125, 1.484234375, 1.48171875, 1.48734375, 1.4716875, 1.485234375, 1.481015625, 1.476609375, 1.475796875, 1.4845312499999999, 1.4726875000000001, 1.457328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183230181153185, "mean_inference_ms": 1.7300591106027852, "mean_action_processing_ms": 0.10399522234388901, "mean_env_wait_ms": 0.1525661632794009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10854395309297166, "StateBufferConnector_ms": 0.008357869516504874, "ViewRequirementAgentConnector_ms": 0.1259843901832505}}, "episode_reward_max": 1.49015625, "episode_reward_min": 0.7687499999999999, "episode_reward_mean": 1.4693972772277228, "episode_len_mean": 39.524752475247524, "episodes_this_iter": 101, "policy_reward_min": {"red_0": 0.7687499999999999}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4693972772277228}, "hist_stats": {"episode_reward": [1.4654687499999999, 1.4441875, 1.488046875, 1.4832343749999999, 1.47228125, 1.4776093750000001, 1.477203125, 1.475390625, 1.4866406250000002, 1.485640625, 1.477203125, 1.4732812499999999, 1.474796875, 1.4832343749999999, 1.4828281250000002, 1.475390625, 1.4805312499999999, 1.482125, 1.484234375, 1.4775, 1.48253125, 1.4694687499999999, 1.4794218749999999, 1.4699843750000001, 1.48353125, 1.4765000000000001, 1.457546875, 1.4765000000000001, 1.4574375, 1.472390625, 1.483828125, 1.481015625, 1.4737968750000001, 1.47509375, 1.465171875, 1.4686875000000001, 1.4859375, 1.476203125, 1.481828125, 1.48734375, 1.47490625, 1.4515156249999999, 1.481125, 1.478609375, 1.481015625, 1.480421875, 1.485640625, 1.474796875, 1.4828281250000002, 1.49015625, 1.4743906249999998, 1.470796875, 1.473609375, 1.482125, 1.4807187499999999, 1.4793125, 1.477421875, 1.4845312499999999, 1.480421875, 1.4803125000000001, 1.475796875, 1.47509375, 1.4845312499999999, 1.48734375, 1.48353125, 1.4703906249999998, 1.47209375, 1.47871875, 1.4341249999999999, 1.469765625, 1.4746875, 1.4566249999999998, 1.457921875, 1.480015625, 1.488046875, 1.472984375, 1.466875, 1.480421875, 1.4730937499999999, 1.470984375, 1.478609375, 1.479015625, 1.471984375, 1.481125, 1.4859375, 1.4773125, 1.473203125, 0.7687499999999999, 1.483125, 1.483125, 1.484234375, 1.48171875, 1.48734375, 1.4716875, 1.485234375, 1.481015625, 1.476609375, 1.475796875, 1.4845312499999999, 1.4726875000000001, 1.457328125], "episode_lengths": [42, 68, 17, 21, 38, 29, 31, 35, 19, 19, 31, 38, 33, 21, 23, 35, 22, 24, 21, 32, 22, 42, 25, 37, 22, 32, 49, 32, 52, 35, 23, 27, 33, 34, 41, 36, 20, 31, 23, 18, 30, 59, 24, 29, 27, 25, 19, 33, 23, 14, 35, 33, 29, 24, 26, 28, 25, 22, 25, 28, 33, 34, 22, 18, 22, 35, 34, 26, 88, 43, 36, 56, 57, 27, 17, 37, 40, 25, 34, 37, 29, 27, 37, 24, 20, 28, 31, 912, 24, 24, 21, 26, 18, 36, 21, 27, 29, 33, 22, 36, 55], "policy_red_0_reward": [1.4654687499999999, 1.4441875, 1.488046875, 1.4832343749999999, 1.47228125, 1.4776093750000001, 1.477203125, 1.475390625, 1.4866406250000002, 1.485640625, 1.477203125, 1.4732812499999999, 1.474796875, 1.4832343749999999, 1.4828281250000002, 1.475390625, 1.4805312499999999, 1.482125, 1.484234375, 1.4775, 1.48253125, 1.4694687499999999, 1.4794218749999999, 1.4699843750000001, 1.48353125, 1.4765000000000001, 1.457546875, 1.4765000000000001, 1.4574375, 1.472390625, 1.483828125, 1.481015625, 1.4737968750000001, 1.47509375, 1.465171875, 1.4686875000000001, 1.4859375, 1.476203125, 1.481828125, 1.48734375, 1.47490625, 1.4515156249999999, 1.481125, 1.478609375, 1.481015625, 1.480421875, 1.485640625, 1.474796875, 1.4828281250000002, 1.49015625, 1.4743906249999998, 1.470796875, 1.473609375, 1.482125, 1.4807187499999999, 1.4793125, 1.477421875, 1.4845312499999999, 1.480421875, 1.4803125000000001, 1.475796875, 1.47509375, 1.4845312499999999, 1.48734375, 1.48353125, 1.4703906249999998, 1.47209375, 1.47871875, 1.4341249999999999, 1.469765625, 1.4746875, 1.4566249999999998, 1.457921875, 1.480015625, 1.488046875, 1.472984375, 1.466875, 1.480421875, 1.4730937499999999, 1.470984375, 1.478609375, 1.479015625, 1.471984375, 1.481125, 1.4859375, 1.4773125, 1.473203125, 0.7687499999999999, 1.483125, 1.483125, 1.484234375, 1.48171875, 1.48734375, 1.4716875, 1.485234375, 1.481015625, 1.476609375, 1.475796875, 1.4845312499999999, 1.4726875000000001, 1.457328125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183230181153185, "mean_inference_ms": 1.7300591106027852, "mean_action_processing_ms": 0.10399522234388901, "mean_env_wait_ms": 0.1525661632794009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10854395309297166, "StateBufferConnector_ms": 0.008357869516504874, "ViewRequirementAgentConnector_ms": 0.1259843901832505}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.31675193148567, "num_env_steps_trained_throughput_per_sec": 216.31675193148567, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 16556.545, "sample_time_ms": 9654.193, "learn_time_ms": 6859.96, "learn_throughput": 583.094, "synch_weights_time_ms": 41.73}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 449, "training_iteration": 27, "trial_id": "2558d_00000", "date": "2023-09-10_14-03-20", "timestamp": 1694369000, "time_this_iter_s": 18.50083088874817, "time_total_s": 450.42141914367676, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c4171f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 450.42141914367676, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.509999999999998, "ram_util_percent": 31.506666666666675}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7278333858276407, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.005978694699660991, "policy_loss": -0.01916713165337569, "vf_loss": 0.022351239204484348, "vf_explained_var": 0.811894558245937, "kl": 0.009315289382296426, "entropy": 1.0322180727496744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 0.623828125, "episode_reward_mean": 1.4705667410714287, "episode_len_mean": 38.52857142857143, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {"red_0": 0.623828125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4705667410714287}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4663593750000001, 1.4866406250000002, 1.48634375, 1.481015625, 1.48734375, 1.488046875, 1.4845312499999999, 1.4755, 1.4660625, 1.47871875, 1.485234375, 1.483828125, 1.4765000000000001, 1.4845312499999999, 1.480421875, 1.48353125, 1.481421875, 1.485234375, 1.4828281250000002, 1.483125, 1.48634375, 1.480828125, 1.4769062499999999, 1.485234375, 1.4845312499999999, 1.480015625, 1.483828125, 1.452515625, 1.4828281250000002, 1.478609375, 1.48875, 1.489453125, 1.464765625, 1.4845312499999999, 1.4832343749999999, 1.47971875, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.4828281250000002, 1.4745, 1.471390625, 1.465546875, 1.485234375, 1.483828125, 1.483828125, 1.485640625, 1.481125, 1.485640625, 1.48171875, 1.4866406250000002, 1.485234375, 1.4807187499999999, 1.4794218749999999, 1.4859375, 1.483828125, 1.4866406250000002, 1.480015625, 1.473390625, 1.4793125, 1.4794218749999999, 1.48875, 1.4775, 1.4540312499999999, 1.481125, 1.4839375000000001, 1.479015625, 1.48353125, 1.4794218749999999, 1.4828281250000002, 1.483828125, 1.48875, 1.4801250000000001, 1.479125, 1.474796875, 1.48634375, 1.4765000000000001, 1.48734375, 1.483828125, 1.4656562499999999, 1.4706875, 1.46746875, 1.48353125, 1.472390625, 1.482234375, 1.485234375, 1.469875, 1.478609375, 1.47890625, 1.4775, 1.482421875, 1.4828281250000002, 1.47971875, 1.4692812499999999, 1.474796875, 1.480015625, 1.4755, 1.475015625, 1.48171875, 1.47890625, 1.480015625, 1.48875, 1.4776093750000001, 1.48734375, 1.4849375, 1.4849375, 1.480015625, 1.48734375, 1.488046875, 1.4859375, 0.9605468749999999, 1.481828125, 1.4793125, 1.484234375, 1.485640625, 1.4807187499999999, 1.47771875, 1.482125, 1.484234375, 1.48171875, 1.481015625, 1.48734375, 1.482125, 1.483125, 1.47971875, 1.48353125, 1.48734375, 1.480421875, 1.47790625, 1.48171875, 1.48353125, 1.476609375, 1.4676875, 1.4859375, 1.484234375, 0.623828125, 1.485640625, 1.481015625, 1.483125, 1.4529999999999998], "episode_lengths": [45, 19, 18, 27, 18, 17, 22, 32, 44, 26, 21, 23, 32, 22, 25, 22, 25, 21, 23, 24, 18, 23, 30, 21, 22, 27, 23, 59, 23, 29, 16, 15, 43, 22, 21, 26, 17, 36, 32, 23, 32, 35, 49, 21, 23, 23, 19, 24, 19, 26, 19, 21, 26, 25, 20, 23, 19, 27, 35, 28, 25, 16, 32, 54, 24, 20, 27, 22, 25, 23, 23, 16, 24, 24, 33, 18, 32, 18, 23, 46, 36, 42, 22, 35, 21, 21, 40, 29, 30, 32, 25, 23, 26, 38, 33, 27, 32, 27, 26, 30, 27, 16, 29, 18, 20, 20, 27, 18, 17, 20, 689, 23, 28, 21, 19, 26, 26, 24, 21, 26, 27, 18, 24, 24, 26, 22, 18, 25, 30, 26, 22, 29, 36, 20, 21, 1111, 19, 27, 24, 64], "policy_red_0_reward": [1.4663593750000001, 1.4866406250000002, 1.48634375, 1.481015625, 1.48734375, 1.488046875, 1.4845312499999999, 1.4755, 1.4660625, 1.47871875, 1.485234375, 1.483828125, 1.4765000000000001, 1.4845312499999999, 1.480421875, 1.48353125, 1.481421875, 1.485234375, 1.4828281250000002, 1.483125, 1.48634375, 1.480828125, 1.4769062499999999, 1.485234375, 1.4845312499999999, 1.480015625, 1.483828125, 1.452515625, 1.4828281250000002, 1.478609375, 1.48875, 1.489453125, 1.464765625, 1.4845312499999999, 1.4832343749999999, 1.47971875, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.4828281250000002, 1.4745, 1.471390625, 1.465546875, 1.485234375, 1.483828125, 1.483828125, 1.485640625, 1.481125, 1.485640625, 1.48171875, 1.4866406250000002, 1.485234375, 1.4807187499999999, 1.4794218749999999, 1.4859375, 1.483828125, 1.4866406250000002, 1.480015625, 1.473390625, 1.4793125, 1.4794218749999999, 1.48875, 1.4775, 1.4540312499999999, 1.481125, 1.4839375000000001, 1.479015625, 1.48353125, 1.4794218749999999, 1.4828281250000002, 1.483828125, 1.48875, 1.4801250000000001, 1.479125, 1.474796875, 1.48634375, 1.4765000000000001, 1.48734375, 1.483828125, 1.4656562499999999, 1.4706875, 1.46746875, 1.48353125, 1.472390625, 1.482234375, 1.485234375, 1.469875, 1.478609375, 1.47890625, 1.4775, 1.482421875, 1.4828281250000002, 1.47971875, 1.4692812499999999, 1.474796875, 1.480015625, 1.4755, 1.475015625, 1.48171875, 1.47890625, 1.480015625, 1.48875, 1.4776093750000001, 1.48734375, 1.4849375, 1.4849375, 1.480015625, 1.48734375, 1.488046875, 1.4859375, 0.9605468749999999, 1.481828125, 1.4793125, 1.484234375, 1.485640625, 1.4807187499999999, 1.47771875, 1.482125, 1.484234375, 1.48171875, 1.481015625, 1.48734375, 1.482125, 1.483125, 1.47971875, 1.48353125, 1.48734375, 1.480421875, 1.47790625, 1.48171875, 1.48353125, 1.476609375, 1.4676875, 1.4859375, 1.484234375, 0.623828125, 1.485640625, 1.481015625, 1.483125, 1.4529999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42018291225212223, "mean_inference_ms": 1.731015974920034, "mean_action_processing_ms": 0.10412800399768793, "mean_env_wait_ms": 0.15292964044329338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10751826422555107, "StateBufferConnector_ms": 0.008530105863298689, "ViewRequirementAgentConnector_ms": 0.1220076424734933}}, "episode_reward_max": 1.489453125, "episode_reward_min": 0.623828125, "episode_reward_mean": 1.4705667410714287, "episode_len_mean": 38.52857142857143, "episodes_this_iter": 140, "policy_reward_min": {"red_0": 0.623828125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4705667410714287}, "hist_stats": {"episode_reward": [1.4663593750000001, 1.4866406250000002, 1.48634375, 1.481015625, 1.48734375, 1.488046875, 1.4845312499999999, 1.4755, 1.4660625, 1.47871875, 1.485234375, 1.483828125, 1.4765000000000001, 1.4845312499999999, 1.480421875, 1.48353125, 1.481421875, 1.485234375, 1.4828281250000002, 1.483125, 1.48634375, 1.480828125, 1.4769062499999999, 1.485234375, 1.4845312499999999, 1.480015625, 1.483828125, 1.452515625, 1.4828281250000002, 1.478609375, 1.48875, 1.489453125, 1.464765625, 1.4845312499999999, 1.4832343749999999, 1.47971875, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.4828281250000002, 1.4745, 1.471390625, 1.465546875, 1.485234375, 1.483828125, 1.483828125, 1.485640625, 1.481125, 1.485640625, 1.48171875, 1.4866406250000002, 1.485234375, 1.4807187499999999, 1.4794218749999999, 1.4859375, 1.483828125, 1.4866406250000002, 1.480015625, 1.473390625, 1.4793125, 1.4794218749999999, 1.48875, 1.4775, 1.4540312499999999, 1.481125, 1.4839375000000001, 1.479015625, 1.48353125, 1.4794218749999999, 1.4828281250000002, 1.483828125, 1.48875, 1.4801250000000001, 1.479125, 1.474796875, 1.48634375, 1.4765000000000001, 1.48734375, 1.483828125, 1.4656562499999999, 1.4706875, 1.46746875, 1.48353125, 1.472390625, 1.482234375, 1.485234375, 1.469875, 1.478609375, 1.47890625, 1.4775, 1.482421875, 1.4828281250000002, 1.47971875, 1.4692812499999999, 1.474796875, 1.480015625, 1.4755, 1.475015625, 1.48171875, 1.47890625, 1.480015625, 1.48875, 1.4776093750000001, 1.48734375, 1.4849375, 1.4849375, 1.480015625, 1.48734375, 1.488046875, 1.4859375, 0.9605468749999999, 1.481828125, 1.4793125, 1.484234375, 1.485640625, 1.4807187499999999, 1.47771875, 1.482125, 1.484234375, 1.48171875, 1.481015625, 1.48734375, 1.482125, 1.483125, 1.47971875, 1.48353125, 1.48734375, 1.480421875, 1.47790625, 1.48171875, 1.48353125, 1.476609375, 1.4676875, 1.4859375, 1.484234375, 0.623828125, 1.485640625, 1.481015625, 1.483125, 1.4529999999999998], "episode_lengths": [45, 19, 18, 27, 18, 17, 22, 32, 44, 26, 21, 23, 32, 22, 25, 22, 25, 21, 23, 24, 18, 23, 30, 21, 22, 27, 23, 59, 23, 29, 16, 15, 43, 22, 21, 26, 17, 36, 32, 23, 32, 35, 49, 21, 23, 23, 19, 24, 19, 26, 19, 21, 26, 25, 20, 23, 19, 27, 35, 28, 25, 16, 32, 54, 24, 20, 27, 22, 25, 23, 23, 16, 24, 24, 33, 18, 32, 18, 23, 46, 36, 42, 22, 35, 21, 21, 40, 29, 30, 32, 25, 23, 26, 38, 33, 27, 32, 27, 26, 30, 27, 16, 29, 18, 20, 20, 27, 18, 17, 20, 689, 23, 28, 21, 19, 26, 26, 24, 21, 26, 27, 18, 24, 24, 26, 22, 18, 25, 30, 26, 22, 29, 36, 20, 21, 1111, 19, 27, 24, 64], "policy_red_0_reward": [1.4663593750000001, 1.4866406250000002, 1.48634375, 1.481015625, 1.48734375, 1.488046875, 1.4845312499999999, 1.4755, 1.4660625, 1.47871875, 1.485234375, 1.483828125, 1.4765000000000001, 1.4845312499999999, 1.480421875, 1.48353125, 1.481421875, 1.485234375, 1.4828281250000002, 1.483125, 1.48634375, 1.480828125, 1.4769062499999999, 1.485234375, 1.4845312499999999, 1.480015625, 1.483828125, 1.452515625, 1.4828281250000002, 1.478609375, 1.48875, 1.489453125, 1.464765625, 1.4845312499999999, 1.4832343749999999, 1.47971875, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.4828281250000002, 1.4745, 1.471390625, 1.465546875, 1.485234375, 1.483828125, 1.483828125, 1.485640625, 1.481125, 1.485640625, 1.48171875, 1.4866406250000002, 1.485234375, 1.4807187499999999, 1.4794218749999999, 1.4859375, 1.483828125, 1.4866406250000002, 1.480015625, 1.473390625, 1.4793125, 1.4794218749999999, 1.48875, 1.4775, 1.4540312499999999, 1.481125, 1.4839375000000001, 1.479015625, 1.48353125, 1.4794218749999999, 1.4828281250000002, 1.483828125, 1.48875, 1.4801250000000001, 1.479125, 1.474796875, 1.48634375, 1.4765000000000001, 1.48734375, 1.483828125, 1.4656562499999999, 1.4706875, 1.46746875, 1.48353125, 1.472390625, 1.482234375, 1.485234375, 1.469875, 1.478609375, 1.47890625, 1.4775, 1.482421875, 1.4828281250000002, 1.47971875, 1.4692812499999999, 1.474796875, 1.480015625, 1.4755, 1.475015625, 1.48171875, 1.47890625, 1.480015625, 1.48875, 1.4776093750000001, 1.48734375, 1.4849375, 1.4849375, 1.480015625, 1.48734375, 1.488046875, 1.4859375, 0.9605468749999999, 1.481828125, 1.4793125, 1.484234375, 1.485640625, 1.4807187499999999, 1.47771875, 1.482125, 1.484234375, 1.48171875, 1.481015625, 1.48734375, 1.482125, 1.483125, 1.47971875, 1.48353125, 1.48734375, 1.480421875, 1.47790625, 1.48171875, 1.48353125, 1.476609375, 1.4676875, 1.4859375, 1.484234375, 0.623828125, 1.485640625, 1.481015625, 1.483125, 1.4529999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42018291225212223, "mean_inference_ms": 1.731015974920034, "mean_action_processing_ms": 0.10412800399768793, "mean_env_wait_ms": 0.15292964044329338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10751826422555107, "StateBufferConnector_ms": 0.008530105863298689, "ViewRequirementAgentConnector_ms": 0.1220076424734933}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.8999176175539, "num_env_steps_trained_throughput_per_sec": 215.8999176175539, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 16752.694, "sample_time_ms": 9714.212, "learn_time_ms": 6996.3, "learn_throughput": 571.731, "synch_weights_time_ms": 41.518}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 589, "training_iteration": 28, "trial_id": "2558d_00000", "date": "2023-09-10_14-03-40", "timestamp": 1694369020, "time_this_iter_s": 18.53743815422058, "time_total_s": 468.95885729789734, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c1e9040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 468.95885729789734, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 32.92413793103449, "ram_util_percent": 31.50689655172413}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.637015979612867, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013351432391815857, "policy_loss": -0.02246517788056129, "vf_loss": 0.005554611873352163, "vf_explained_var": 0.8571306569501758, "kl": 0.01186377906826408, "entropy": 0.8762173438444734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.4566249999999998, "episode_reward_mean": 1.482355603448276, "episode_len_mean": 23.402298850574713, "episode_media": {}, "episodes_this_iter": 174, "policy_reward_min": {"red_0": 1.4566249999999998}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.482355603448276}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.472796875, 1.4773125, 1.48875, 1.4870468749999999, 1.4776093750000001, 1.484234375, 1.483828125, 1.488046875, 1.4845312499999999, 1.488046875, 1.4776093750000001, 1.4839375000000001, 1.4866406250000002, 1.48875, 1.481125, 1.4839375000000001, 1.47971875, 1.478125, 1.48634375, 1.48353125, 1.4866406250000002, 1.482125, 1.4849375, 1.4866406250000002, 1.4877500000000001, 1.4828281250000002, 1.4849375, 1.482125, 1.48171875, 1.48253125, 1.4769062499999999, 1.4839375000000001, 1.4839375000000001, 1.4686875000000001, 1.4736875, 1.484234375, 1.489453125, 1.48875, 1.4828281250000002, 1.4849375, 1.48734375, 1.4737968750000001, 1.48875, 1.485640625, 1.48353125, 1.4859375, 1.4845312499999999, 1.48634375, 1.4859375, 1.482234375, 1.4829375, 1.484234375, 1.4870468749999999, 1.485234375, 1.48353125, 1.4849375, 1.4692812499999999, 1.4670625, 1.481234375, 1.4859375, 1.4832343749999999, 1.473390625, 1.470984375, 1.4859375, 1.4859375, 1.481828125, 1.4794218749999999, 1.4849375, 1.480015625, 1.483125, 1.4803125000000001, 1.4783125, 1.4859375, 1.488046875, 1.485234375, 1.48353125, 1.48734375, 1.48171875, 1.4807187499999999, 1.483640625, 1.481125, 1.4566249999999998, 1.485640625, 1.48353125, 1.483828125, 1.4793125, 1.475609375, 1.4845312499999999, 1.481828125, 1.4739843750000001, 1.48875, 1.48353125, 1.479015625, 1.481234375, 1.47409375, 1.482234375, 1.4845312499999999, 1.485234375, 1.484640625, 1.4866406250000002, 1.47971875, 1.4845312499999999, 1.475390625, 1.4829375, 1.4877500000000001, 1.4859375, 1.488046875, 1.48634375, 1.48353125, 1.484234375, 1.48734375, 1.488046875, 1.484234375, 1.468171875, 1.48734375, 1.481234375, 1.488046875, 1.485640625, 1.485234375, 1.4828281250000002, 1.4776093750000001, 1.481125, 1.4845312499999999, 1.48353125, 1.4832343749999999, 1.4745, 1.4866406250000002, 1.48875, 1.462140625, 1.4866406250000002, 1.4594375, 1.48153125, 1.481421875, 1.482421875, 1.48875, 1.47790625, 1.484234375, 1.485640625, 1.4783125, 1.474609375, 1.481421875, 1.4706875, 1.4726875000000001, 1.481421875, 1.481015625, 1.48253125, 1.48171875, 1.484640625, 1.48734375, 1.480421875, 1.485640625, 1.484640625, 1.488046875, 1.48634375, 1.482421875, 1.48353125, 1.48171875, 1.4828281250000002, 1.48353125, 1.4849375, 1.4828281250000002, 1.481421875, 1.485234375, 1.488046875, 1.484234375, 1.476796875, 1.4793125, 1.48875, 1.4866406250000002, 1.48875, 1.476203125, 1.48171875, 1.485234375, 1.481125], "episode_lengths": [33, 28, 16, 17, 29, 21, 23, 17, 22, 17, 29, 20, 19, 16, 24, 20, 26, 24, 18, 22, 19, 24, 20, 19, 16, 23, 20, 24, 26, 22, 30, 20, 20, 36, 36, 21, 15, 16, 23, 20, 18, 33, 16, 19, 22, 20, 22, 18, 20, 21, 20, 21, 17, 21, 22, 20, 38, 44, 21, 20, 21, 35, 37, 20, 20, 23, 25, 20, 27, 24, 28, 28, 20, 17, 21, 22, 18, 26, 26, 19, 24, 56, 19, 22, 23, 28, 29, 22, 23, 37, 16, 22, 27, 21, 34, 21, 22, 21, 19, 19, 26, 22, 35, 20, 16, 20, 17, 18, 22, 21, 18, 17, 21, 41, 18, 21, 17, 19, 21, 23, 29, 24, 22, 22, 21, 32, 19, 16, 51, 19, 52, 22, 25, 25, 16, 30, 21, 19, 28, 29, 25, 36, 36, 25, 27, 22, 26, 19, 18, 25, 19, 19, 17, 18, 25, 22, 26, 23, 22, 20, 23, 25, 21, 17, 21, 33, 28, 16, 19, 16, 31, 26, 21, 24], "policy_red_0_reward": [1.472796875, 1.4773125, 1.48875, 1.4870468749999999, 1.4776093750000001, 1.484234375, 1.483828125, 1.488046875, 1.4845312499999999, 1.488046875, 1.4776093750000001, 1.4839375000000001, 1.4866406250000002, 1.48875, 1.481125, 1.4839375000000001, 1.47971875, 1.478125, 1.48634375, 1.48353125, 1.4866406250000002, 1.482125, 1.4849375, 1.4866406250000002, 1.4877500000000001, 1.4828281250000002, 1.4849375, 1.482125, 1.48171875, 1.48253125, 1.4769062499999999, 1.4839375000000001, 1.4839375000000001, 1.4686875000000001, 1.4736875, 1.484234375, 1.489453125, 1.48875, 1.4828281250000002, 1.4849375, 1.48734375, 1.4737968750000001, 1.48875, 1.485640625, 1.48353125, 1.4859375, 1.4845312499999999, 1.48634375, 1.4859375, 1.482234375, 1.4829375, 1.484234375, 1.4870468749999999, 1.485234375, 1.48353125, 1.4849375, 1.4692812499999999, 1.4670625, 1.481234375, 1.4859375, 1.4832343749999999, 1.473390625, 1.470984375, 1.4859375, 1.4859375, 1.481828125, 1.4794218749999999, 1.4849375, 1.480015625, 1.483125, 1.4803125000000001, 1.4783125, 1.4859375, 1.488046875, 1.485234375, 1.48353125, 1.48734375, 1.48171875, 1.4807187499999999, 1.483640625, 1.481125, 1.4566249999999998, 1.485640625, 1.48353125, 1.483828125, 1.4793125, 1.475609375, 1.4845312499999999, 1.481828125, 1.4739843750000001, 1.48875, 1.48353125, 1.479015625, 1.481234375, 1.47409375, 1.482234375, 1.4845312499999999, 1.485234375, 1.484640625, 1.4866406250000002, 1.47971875, 1.4845312499999999, 1.475390625, 1.4829375, 1.4877500000000001, 1.4859375, 1.488046875, 1.48634375, 1.48353125, 1.484234375, 1.48734375, 1.488046875, 1.484234375, 1.468171875, 1.48734375, 1.481234375, 1.488046875, 1.485640625, 1.485234375, 1.4828281250000002, 1.4776093750000001, 1.481125, 1.4845312499999999, 1.48353125, 1.4832343749999999, 1.4745, 1.4866406250000002, 1.48875, 1.462140625, 1.4866406250000002, 1.4594375, 1.48153125, 1.481421875, 1.482421875, 1.48875, 1.47790625, 1.484234375, 1.485640625, 1.4783125, 1.474609375, 1.481421875, 1.4706875, 1.4726875000000001, 1.481421875, 1.481015625, 1.48253125, 1.48171875, 1.484640625, 1.48734375, 1.480421875, 1.485640625, 1.484640625, 1.488046875, 1.48634375, 1.482421875, 1.48353125, 1.48171875, 1.4828281250000002, 1.48353125, 1.4849375, 1.4828281250000002, 1.481421875, 1.485234375, 1.488046875, 1.484234375, 1.476796875, 1.4793125, 1.48875, 1.4866406250000002, 1.48875, 1.476203125, 1.48171875, 1.485234375, 1.481125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4213149004730044, "mean_inference_ms": 1.7274329720734292, "mean_action_processing_ms": 0.10395101581259468, "mean_env_wait_ms": 0.15299036009489814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10663298354751763, "StateBufferConnector_ms": 0.008395759538672436, "ViewRequirementAgentConnector_ms": 0.11702474506422021}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.4566249999999998, "episode_reward_mean": 1.482355603448276, "episode_len_mean": 23.402298850574713, "episodes_this_iter": 174, "policy_reward_min": {"red_0": 1.4566249999999998}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.482355603448276}, "hist_stats": {"episode_reward": [1.472796875, 1.4773125, 1.48875, 1.4870468749999999, 1.4776093750000001, 1.484234375, 1.483828125, 1.488046875, 1.4845312499999999, 1.488046875, 1.4776093750000001, 1.4839375000000001, 1.4866406250000002, 1.48875, 1.481125, 1.4839375000000001, 1.47971875, 1.478125, 1.48634375, 1.48353125, 1.4866406250000002, 1.482125, 1.4849375, 1.4866406250000002, 1.4877500000000001, 1.4828281250000002, 1.4849375, 1.482125, 1.48171875, 1.48253125, 1.4769062499999999, 1.4839375000000001, 1.4839375000000001, 1.4686875000000001, 1.4736875, 1.484234375, 1.489453125, 1.48875, 1.4828281250000002, 1.4849375, 1.48734375, 1.4737968750000001, 1.48875, 1.485640625, 1.48353125, 1.4859375, 1.4845312499999999, 1.48634375, 1.4859375, 1.482234375, 1.4829375, 1.484234375, 1.4870468749999999, 1.485234375, 1.48353125, 1.4849375, 1.4692812499999999, 1.4670625, 1.481234375, 1.4859375, 1.4832343749999999, 1.473390625, 1.470984375, 1.4859375, 1.4859375, 1.481828125, 1.4794218749999999, 1.4849375, 1.480015625, 1.483125, 1.4803125000000001, 1.4783125, 1.4859375, 1.488046875, 1.485234375, 1.48353125, 1.48734375, 1.48171875, 1.4807187499999999, 1.483640625, 1.481125, 1.4566249999999998, 1.485640625, 1.48353125, 1.483828125, 1.4793125, 1.475609375, 1.4845312499999999, 1.481828125, 1.4739843750000001, 1.48875, 1.48353125, 1.479015625, 1.481234375, 1.47409375, 1.482234375, 1.4845312499999999, 1.485234375, 1.484640625, 1.4866406250000002, 1.47971875, 1.4845312499999999, 1.475390625, 1.4829375, 1.4877500000000001, 1.4859375, 1.488046875, 1.48634375, 1.48353125, 1.484234375, 1.48734375, 1.488046875, 1.484234375, 1.468171875, 1.48734375, 1.481234375, 1.488046875, 1.485640625, 1.485234375, 1.4828281250000002, 1.4776093750000001, 1.481125, 1.4845312499999999, 1.48353125, 1.4832343749999999, 1.4745, 1.4866406250000002, 1.48875, 1.462140625, 1.4866406250000002, 1.4594375, 1.48153125, 1.481421875, 1.482421875, 1.48875, 1.47790625, 1.484234375, 1.485640625, 1.4783125, 1.474609375, 1.481421875, 1.4706875, 1.4726875000000001, 1.481421875, 1.481015625, 1.48253125, 1.48171875, 1.484640625, 1.48734375, 1.480421875, 1.485640625, 1.484640625, 1.488046875, 1.48634375, 1.482421875, 1.48353125, 1.48171875, 1.4828281250000002, 1.48353125, 1.4849375, 1.4828281250000002, 1.481421875, 1.485234375, 1.488046875, 1.484234375, 1.476796875, 1.4793125, 1.48875, 1.4866406250000002, 1.48875, 1.476203125, 1.48171875, 1.485234375, 1.481125], "episode_lengths": [33, 28, 16, 17, 29, 21, 23, 17, 22, 17, 29, 20, 19, 16, 24, 20, 26, 24, 18, 22, 19, 24, 20, 19, 16, 23, 20, 24, 26, 22, 30, 20, 20, 36, 36, 21, 15, 16, 23, 20, 18, 33, 16, 19, 22, 20, 22, 18, 20, 21, 20, 21, 17, 21, 22, 20, 38, 44, 21, 20, 21, 35, 37, 20, 20, 23, 25, 20, 27, 24, 28, 28, 20, 17, 21, 22, 18, 26, 26, 19, 24, 56, 19, 22, 23, 28, 29, 22, 23, 37, 16, 22, 27, 21, 34, 21, 22, 21, 19, 19, 26, 22, 35, 20, 16, 20, 17, 18, 22, 21, 18, 17, 21, 41, 18, 21, 17, 19, 21, 23, 29, 24, 22, 22, 21, 32, 19, 16, 51, 19, 52, 22, 25, 25, 16, 30, 21, 19, 28, 29, 25, 36, 36, 25, 27, 22, 26, 19, 18, 25, 19, 19, 17, 18, 25, 22, 26, 23, 22, 20, 23, 25, 21, 17, 21, 33, 28, 16, 19, 16, 31, 26, 21, 24], "policy_red_0_reward": [1.472796875, 1.4773125, 1.48875, 1.4870468749999999, 1.4776093750000001, 1.484234375, 1.483828125, 1.488046875, 1.4845312499999999, 1.488046875, 1.4776093750000001, 1.4839375000000001, 1.4866406250000002, 1.48875, 1.481125, 1.4839375000000001, 1.47971875, 1.478125, 1.48634375, 1.48353125, 1.4866406250000002, 1.482125, 1.4849375, 1.4866406250000002, 1.4877500000000001, 1.4828281250000002, 1.4849375, 1.482125, 1.48171875, 1.48253125, 1.4769062499999999, 1.4839375000000001, 1.4839375000000001, 1.4686875000000001, 1.4736875, 1.484234375, 1.489453125, 1.48875, 1.4828281250000002, 1.4849375, 1.48734375, 1.4737968750000001, 1.48875, 1.485640625, 1.48353125, 1.4859375, 1.4845312499999999, 1.48634375, 1.4859375, 1.482234375, 1.4829375, 1.484234375, 1.4870468749999999, 1.485234375, 1.48353125, 1.4849375, 1.4692812499999999, 1.4670625, 1.481234375, 1.4859375, 1.4832343749999999, 1.473390625, 1.470984375, 1.4859375, 1.4859375, 1.481828125, 1.4794218749999999, 1.4849375, 1.480015625, 1.483125, 1.4803125000000001, 1.4783125, 1.4859375, 1.488046875, 1.485234375, 1.48353125, 1.48734375, 1.48171875, 1.4807187499999999, 1.483640625, 1.481125, 1.4566249999999998, 1.485640625, 1.48353125, 1.483828125, 1.4793125, 1.475609375, 1.4845312499999999, 1.481828125, 1.4739843750000001, 1.48875, 1.48353125, 1.479015625, 1.481234375, 1.47409375, 1.482234375, 1.4845312499999999, 1.485234375, 1.484640625, 1.4866406250000002, 1.47971875, 1.4845312499999999, 1.475390625, 1.4829375, 1.4877500000000001, 1.4859375, 1.488046875, 1.48634375, 1.48353125, 1.484234375, 1.48734375, 1.488046875, 1.484234375, 1.468171875, 1.48734375, 1.481234375, 1.488046875, 1.485640625, 1.485234375, 1.4828281250000002, 1.4776093750000001, 1.481125, 1.4845312499999999, 1.48353125, 1.4832343749999999, 1.4745, 1.4866406250000002, 1.48875, 1.462140625, 1.4866406250000002, 1.4594375, 1.48153125, 1.481421875, 1.482421875, 1.48875, 1.47790625, 1.484234375, 1.485640625, 1.4783125, 1.474609375, 1.481421875, 1.4706875, 1.4726875000000001, 1.481421875, 1.481015625, 1.48253125, 1.48171875, 1.484640625, 1.48734375, 1.480421875, 1.485640625, 1.484640625, 1.488046875, 1.48634375, 1.482421875, 1.48353125, 1.48171875, 1.4828281250000002, 1.48353125, 1.4849375, 1.4828281250000002, 1.481421875, 1.485234375, 1.488046875, 1.484234375, 1.476796875, 1.4793125, 1.48875, 1.4866406250000002, 1.48875, 1.476203125, 1.48171875, 1.485234375, 1.481125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4213149004730044, "mean_inference_ms": 1.7274329720734292, "mean_action_processing_ms": 0.10395101581259468, "mean_env_wait_ms": 0.15299036009489814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10663298354751763, "StateBufferConnector_ms": 0.008395759538672436, "ViewRequirementAgentConnector_ms": 0.11702474506422021}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.85252317179604, "num_env_steps_trained_throughput_per_sec": 243.85252317179604, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 16769.894, "sample_time_ms": 9738.138, "learn_time_ms": 6989.473, "learn_throughput": 572.289, "synch_weights_time_ms": 41.642}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 763, "training_iteration": 29, "trial_id": "2558d_00000", "date": "2023-09-10_14-03-59", "timestamp": 1694369039, "time_this_iter_s": 16.41553521156311, "time_total_s": 485.37439250946045, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15f4c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 485.37439250946045, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.792307692307688, "ram_util_percent": 31.257692307692302}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5048894639437398, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018181070006054748, "policy_loss": -0.025497194429044613, "vf_loss": 0.003885997321594914, "vf_explained_var": 0.9032384444649021, "kl": 0.011433757293167446, "entropy": 0.7723448094601433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 1.489453125, "episode_reward_min": 1.438453125, "episode_reward_mean": 1.4838735641891894, "episode_len_mean": 21.605405405405406, "episode_media": {}, "episodes_this_iter": 185, "policy_reward_min": {"red_0": 1.438453125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4838735641891894}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48875, 1.489453125, 1.48875, 1.48634375, 1.47771875, 1.484234375, 1.4769062499999999, 1.476609375, 1.488046875, 1.484234375, 1.4866406250000002, 1.489453125, 1.482421875, 1.4870468749999999, 1.477015625, 1.4877500000000001, 1.4859375, 1.4755, 1.4877500000000001, 1.4859375, 1.4859375, 1.476203125, 1.48634375, 1.4832343749999999, 1.4866406250000002, 1.4859375, 1.485234375, 1.467578125, 1.48875, 1.48353125, 1.481828125, 1.4839375000000001, 1.481125, 1.4828281250000002, 1.48875, 1.481421875, 1.488046875, 1.48734375, 1.4829375, 1.477015625, 1.483828125, 1.4775, 1.4845312499999999, 1.4866406250000002, 1.482125, 1.4870468749999999, 1.482421875, 1.4859375, 1.4839375000000001, 1.48634375, 1.438453125, 1.48353125, 1.485640625, 1.4782031249999998, 1.483828125, 1.484234375, 1.4807187499999999, 1.480421875, 1.4828281250000002, 1.483125, 1.48734375, 1.488046875, 1.485640625, 1.481015625, 1.48353125, 1.45484375, 1.483125, 1.48875, 1.483125, 1.48734375, 1.4845312499999999, 1.47028125, 1.488046875, 1.483828125, 1.476609375, 1.4828281250000002, 1.4845312499999999, 1.48875, 1.489453125, 1.4859375, 1.48634375, 1.47871875, 1.484234375, 1.48875, 1.48353125, 1.485640625, 1.485234375, 1.4877500000000001, 1.48634375, 1.484234375, 1.48353125, 1.4767187499999999, 1.489453125, 1.4859375, 1.48875, 1.483828125, 1.48875, 1.48734375, 1.4859375, 1.4688750000000002, 1.484234375, 1.475609375, 1.4828281250000002, 1.4866406250000002, 1.48734375, 1.47871875, 1.479015625, 1.4832343749999999, 1.485234375, 1.48734375, 1.4866406250000002, 1.4839375000000001, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.4742031249999998, 1.483828125, 1.482125, 1.4859375, 1.48634375, 1.483125, 1.484234375, 1.489453125, 1.4866406250000002, 1.481234375, 1.485234375, 1.4870468749999999, 1.486046875, 1.4803125000000001, 1.485234375, 1.4845312499999999, 1.48734375, 1.4803125000000001, 1.476609375, 1.48734375, 1.485640625, 1.4780156249999998, 1.488046875, 1.4845312499999999, 1.47871875, 1.485234375, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.485234375, 1.48734375, 1.48875, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.482125, 1.48353125, 1.4716875, 1.48875, 1.4839375000000001, 1.478125, 1.48734375, 1.485640625, 1.4832343749999999, 1.488046875, 1.4828281250000002, 1.48734375, 1.4832343749999999, 1.48734375, 1.4832343749999999, 1.48253125, 1.48734375, 1.4859375, 1.48875, 1.482125, 1.489453125, 1.483125, 1.4866406250000002, 1.488046875, 1.4849375, 1.481125, 1.4870468749999999, 1.4839375000000001, 1.48734375, 1.48353125, 1.4866406250000002, 1.48734375, 1.48634375, 1.488046875], "episode_lengths": [16, 15, 16, 18, 26, 21, 30, 29, 17, 21, 19, 15, 25, 17, 27, 16, 20, 32, 16, 20, 20, 31, 18, 21, 19, 20, 21, 39, 16, 22, 23, 20, 24, 23, 16, 25, 17, 18, 20, 27, 23, 32, 22, 19, 24, 17, 25, 20, 20, 18, 79, 22, 19, 31, 23, 21, 26, 25, 23, 24, 18, 17, 19, 27, 22, 50, 24, 16, 24, 18, 22, 38, 17, 23, 29, 23, 22, 16, 15, 20, 18, 26, 21, 16, 22, 19, 21, 16, 18, 21, 22, 26, 15, 20, 16, 23, 16, 18, 20, 40, 21, 29, 23, 19, 18, 26, 27, 21, 21, 18, 19, 20, 19, 19, 18, 19, 31, 23, 24, 20, 18, 24, 21, 15, 19, 21, 21, 17, 17, 28, 21, 22, 18, 28, 29, 18, 19, 27, 17, 22, 26, 21, 19, 15, 22, 21, 18, 16, 15, 19, 19, 24, 22, 36, 16, 20, 24, 18, 19, 21, 17, 23, 18, 21, 18, 21, 22, 18, 20, 16, 24, 15, 24, 19, 17, 20, 24, 17, 20, 18, 22, 19, 18, 18, 17], "policy_red_0_reward": [1.48875, 1.489453125, 1.48875, 1.48634375, 1.47771875, 1.484234375, 1.4769062499999999, 1.476609375, 1.488046875, 1.484234375, 1.4866406250000002, 1.489453125, 1.482421875, 1.4870468749999999, 1.477015625, 1.4877500000000001, 1.4859375, 1.4755, 1.4877500000000001, 1.4859375, 1.4859375, 1.476203125, 1.48634375, 1.4832343749999999, 1.4866406250000002, 1.4859375, 1.485234375, 1.467578125, 1.48875, 1.48353125, 1.481828125, 1.4839375000000001, 1.481125, 1.4828281250000002, 1.48875, 1.481421875, 1.488046875, 1.48734375, 1.4829375, 1.477015625, 1.483828125, 1.4775, 1.4845312499999999, 1.4866406250000002, 1.482125, 1.4870468749999999, 1.482421875, 1.4859375, 1.4839375000000001, 1.48634375, 1.438453125, 1.48353125, 1.485640625, 1.4782031249999998, 1.483828125, 1.484234375, 1.4807187499999999, 1.480421875, 1.4828281250000002, 1.483125, 1.48734375, 1.488046875, 1.485640625, 1.481015625, 1.48353125, 1.45484375, 1.483125, 1.48875, 1.483125, 1.48734375, 1.4845312499999999, 1.47028125, 1.488046875, 1.483828125, 1.476609375, 1.4828281250000002, 1.4845312499999999, 1.48875, 1.489453125, 1.4859375, 1.48634375, 1.47871875, 1.484234375, 1.48875, 1.48353125, 1.485640625, 1.485234375, 1.4877500000000001, 1.48634375, 1.484234375, 1.48353125, 1.4767187499999999, 1.489453125, 1.4859375, 1.48875, 1.483828125, 1.48875, 1.48734375, 1.4859375, 1.4688750000000002, 1.484234375, 1.475609375, 1.4828281250000002, 1.4866406250000002, 1.48734375, 1.47871875, 1.479015625, 1.4832343749999999, 1.485234375, 1.48734375, 1.4866406250000002, 1.4839375000000001, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.4742031249999998, 1.483828125, 1.482125, 1.4859375, 1.48634375, 1.483125, 1.484234375, 1.489453125, 1.4866406250000002, 1.481234375, 1.485234375, 1.4870468749999999, 1.486046875, 1.4803125000000001, 1.485234375, 1.4845312499999999, 1.48734375, 1.4803125000000001, 1.476609375, 1.48734375, 1.485640625, 1.4780156249999998, 1.488046875, 1.4845312499999999, 1.47871875, 1.485234375, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.485234375, 1.48734375, 1.48875, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.482125, 1.48353125, 1.4716875, 1.48875, 1.4839375000000001, 1.478125, 1.48734375, 1.485640625, 1.4832343749999999, 1.488046875, 1.4828281250000002, 1.48734375, 1.4832343749999999, 1.48734375, 1.4832343749999999, 1.48253125, 1.48734375, 1.4859375, 1.48875, 1.482125, 1.489453125, 1.483125, 1.4866406250000002, 1.488046875, 1.4849375, 1.481125, 1.4870468749999999, 1.4839375000000001, 1.48734375, 1.48353125, 1.4866406250000002, 1.48734375, 1.48634375, 1.488046875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42324308437485664, "mean_inference_ms": 1.727226541929327, "mean_action_processing_ms": 0.1039876284030895, "mean_env_wait_ms": 0.15348209466437365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10454667581094278, "StateBufferConnector_ms": 0.008531132259884396, "ViewRequirementAgentConnector_ms": 0.12014621012919657}}, "episode_reward_max": 1.489453125, "episode_reward_min": 1.438453125, "episode_reward_mean": 1.4838735641891894, "episode_len_mean": 21.605405405405406, "episodes_this_iter": 185, "policy_reward_min": {"red_0": 1.438453125}, "policy_reward_max": {"red_0": 1.489453125}, "policy_reward_mean": {"red_0": 1.4838735641891894}, "hist_stats": {"episode_reward": [1.48875, 1.489453125, 1.48875, 1.48634375, 1.47771875, 1.484234375, 1.4769062499999999, 1.476609375, 1.488046875, 1.484234375, 1.4866406250000002, 1.489453125, 1.482421875, 1.4870468749999999, 1.477015625, 1.4877500000000001, 1.4859375, 1.4755, 1.4877500000000001, 1.4859375, 1.4859375, 1.476203125, 1.48634375, 1.4832343749999999, 1.4866406250000002, 1.4859375, 1.485234375, 1.467578125, 1.48875, 1.48353125, 1.481828125, 1.4839375000000001, 1.481125, 1.4828281250000002, 1.48875, 1.481421875, 1.488046875, 1.48734375, 1.4829375, 1.477015625, 1.483828125, 1.4775, 1.4845312499999999, 1.4866406250000002, 1.482125, 1.4870468749999999, 1.482421875, 1.4859375, 1.4839375000000001, 1.48634375, 1.438453125, 1.48353125, 1.485640625, 1.4782031249999998, 1.483828125, 1.484234375, 1.4807187499999999, 1.480421875, 1.4828281250000002, 1.483125, 1.48734375, 1.488046875, 1.485640625, 1.481015625, 1.48353125, 1.45484375, 1.483125, 1.48875, 1.483125, 1.48734375, 1.4845312499999999, 1.47028125, 1.488046875, 1.483828125, 1.476609375, 1.4828281250000002, 1.4845312499999999, 1.48875, 1.489453125, 1.4859375, 1.48634375, 1.47871875, 1.484234375, 1.48875, 1.48353125, 1.485640625, 1.485234375, 1.4877500000000001, 1.48634375, 1.484234375, 1.48353125, 1.4767187499999999, 1.489453125, 1.4859375, 1.48875, 1.483828125, 1.48875, 1.48734375, 1.4859375, 1.4688750000000002, 1.484234375, 1.475609375, 1.4828281250000002, 1.4866406250000002, 1.48734375, 1.47871875, 1.479015625, 1.4832343749999999, 1.485234375, 1.48734375, 1.4866406250000002, 1.4839375000000001, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.4742031249999998, 1.483828125, 1.482125, 1.4859375, 1.48634375, 1.483125, 1.484234375, 1.489453125, 1.4866406250000002, 1.481234375, 1.485234375, 1.4870468749999999, 1.486046875, 1.4803125000000001, 1.485234375, 1.4845312499999999, 1.48734375, 1.4803125000000001, 1.476609375, 1.48734375, 1.485640625, 1.4780156249999998, 1.488046875, 1.4845312499999999, 1.47871875, 1.485234375, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.485234375, 1.48734375, 1.48875, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.482125, 1.48353125, 1.4716875, 1.48875, 1.4839375000000001, 1.478125, 1.48734375, 1.485640625, 1.4832343749999999, 1.488046875, 1.4828281250000002, 1.48734375, 1.4832343749999999, 1.48734375, 1.4832343749999999, 1.48253125, 1.48734375, 1.4859375, 1.48875, 1.482125, 1.489453125, 1.483125, 1.4866406250000002, 1.488046875, 1.4849375, 1.481125, 1.4870468749999999, 1.4839375000000001, 1.48734375, 1.48353125, 1.4866406250000002, 1.48734375, 1.48634375, 1.488046875], "episode_lengths": [16, 15, 16, 18, 26, 21, 30, 29, 17, 21, 19, 15, 25, 17, 27, 16, 20, 32, 16, 20, 20, 31, 18, 21, 19, 20, 21, 39, 16, 22, 23, 20, 24, 23, 16, 25, 17, 18, 20, 27, 23, 32, 22, 19, 24, 17, 25, 20, 20, 18, 79, 22, 19, 31, 23, 21, 26, 25, 23, 24, 18, 17, 19, 27, 22, 50, 24, 16, 24, 18, 22, 38, 17, 23, 29, 23, 22, 16, 15, 20, 18, 26, 21, 16, 22, 19, 21, 16, 18, 21, 22, 26, 15, 20, 16, 23, 16, 18, 20, 40, 21, 29, 23, 19, 18, 26, 27, 21, 21, 18, 19, 20, 19, 19, 18, 19, 31, 23, 24, 20, 18, 24, 21, 15, 19, 21, 21, 17, 17, 28, 21, 22, 18, 28, 29, 18, 19, 27, 17, 22, 26, 21, 19, 15, 22, 21, 18, 16, 15, 19, 19, 24, 22, 36, 16, 20, 24, 18, 19, 21, 17, 23, 18, 21, 18, 21, 22, 18, 20, 16, 24, 15, 24, 19, 17, 20, 24, 17, 20, 18, 22, 19, 18, 18, 17], "policy_red_0_reward": [1.48875, 1.489453125, 1.48875, 1.48634375, 1.47771875, 1.484234375, 1.4769062499999999, 1.476609375, 1.488046875, 1.484234375, 1.4866406250000002, 1.489453125, 1.482421875, 1.4870468749999999, 1.477015625, 1.4877500000000001, 1.4859375, 1.4755, 1.4877500000000001, 1.4859375, 1.4859375, 1.476203125, 1.48634375, 1.4832343749999999, 1.4866406250000002, 1.4859375, 1.485234375, 1.467578125, 1.48875, 1.48353125, 1.481828125, 1.4839375000000001, 1.481125, 1.4828281250000002, 1.48875, 1.481421875, 1.488046875, 1.48734375, 1.4829375, 1.477015625, 1.483828125, 1.4775, 1.4845312499999999, 1.4866406250000002, 1.482125, 1.4870468749999999, 1.482421875, 1.4859375, 1.4839375000000001, 1.48634375, 1.438453125, 1.48353125, 1.485640625, 1.4782031249999998, 1.483828125, 1.484234375, 1.4807187499999999, 1.480421875, 1.4828281250000002, 1.483125, 1.48734375, 1.488046875, 1.485640625, 1.481015625, 1.48353125, 1.45484375, 1.483125, 1.48875, 1.483125, 1.48734375, 1.4845312499999999, 1.47028125, 1.488046875, 1.483828125, 1.476609375, 1.4828281250000002, 1.4845312499999999, 1.48875, 1.489453125, 1.4859375, 1.48634375, 1.47871875, 1.484234375, 1.48875, 1.48353125, 1.485640625, 1.485234375, 1.4877500000000001, 1.48634375, 1.484234375, 1.48353125, 1.4767187499999999, 1.489453125, 1.4859375, 1.48875, 1.483828125, 1.48875, 1.48734375, 1.4859375, 1.4688750000000002, 1.484234375, 1.475609375, 1.4828281250000002, 1.4866406250000002, 1.48734375, 1.47871875, 1.479015625, 1.4832343749999999, 1.485234375, 1.48734375, 1.4866406250000002, 1.4839375000000001, 1.4866406250000002, 1.4866406250000002, 1.48734375, 1.4866406250000002, 1.4742031249999998, 1.483828125, 1.482125, 1.4859375, 1.48634375, 1.483125, 1.484234375, 1.489453125, 1.4866406250000002, 1.481234375, 1.485234375, 1.4870468749999999, 1.486046875, 1.4803125000000001, 1.485234375, 1.4845312499999999, 1.48734375, 1.4803125000000001, 1.476609375, 1.48734375, 1.485640625, 1.4780156249999998, 1.488046875, 1.4845312499999999, 1.47871875, 1.485234375, 1.4866406250000002, 1.489453125, 1.4845312499999999, 1.485234375, 1.48734375, 1.48875, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.482125, 1.48353125, 1.4716875, 1.48875, 1.4839375000000001, 1.478125, 1.48734375, 1.485640625, 1.4832343749999999, 1.488046875, 1.4828281250000002, 1.48734375, 1.4832343749999999, 1.48734375, 1.4832343749999999, 1.48253125, 1.48734375, 1.4859375, 1.48875, 1.482125, 1.489453125, 1.483125, 1.4866406250000002, 1.488046875, 1.4849375, 1.481125, 1.4870468749999999, 1.4839375000000001, 1.48734375, 1.48353125, 1.4866406250000002, 1.48734375, 1.48634375, 1.488046875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42324308437485664, "mean_inference_ms": 1.727226541929327, "mean_action_processing_ms": 0.1039876284030895, "mean_env_wait_ms": 0.15348209466437365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10454667581094278, "StateBufferConnector_ms": 0.008531132259884396, "ViewRequirementAgentConnector_ms": 0.12014621012919657}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.8310105238628, "num_env_steps_trained_throughput_per_sec": 233.8310105238628, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 16860.806, "sample_time_ms": 9833.338, "learn_time_ms": 6983.989, "learn_throughput": 572.739, "synch_weights_time_ms": 42.853}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 948, "training_iteration": 30, "trial_id": "2558d_00000", "date": "2023-09-10_14-04-18", "timestamp": 1694369058, "time_this_iter_s": 17.123186826705933, "time_total_s": 502.4975793361664, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13cf293a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 502.4975793361664, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 27.542857142857144, "ram_util_percent": 31.16071428571428}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2573154846516748, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020496989864477656, "policy_loss": -0.02849168791944976, "vf_loss": 0.003782808795585879, "vf_explained_var": 0.9204157293463747, "kl": 0.01403963041023751, "entropy": 0.6179210447395841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 1.49015625, "episode_reward_min": 1.4780156249999998, "episode_reward_mean": 1.4865201731220659, "episode_len_mean": 18.483568075117372, "episode_media": {}, "episodes_this_iter": 213, "policy_reward_min": {"red_0": 1.4780156249999998}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4865201731220659}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.4849375, 1.48734375, 1.4870468749999999, 1.4866406250000002, 1.4877500000000001, 1.483828125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.4803125000000001, 1.48875, 1.485640625, 1.48875, 1.48734375, 1.4849375, 1.488046875, 1.48875, 1.482234375, 1.4866406250000002, 1.48534375, 1.48734375, 1.48875, 1.483125, 1.485234375, 1.4809375, 1.483640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.4859375, 1.48734375, 1.47971875, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4807187499999999, 1.485640625, 1.48634375, 1.489453125, 1.4828281250000002, 1.48634375, 1.49015625, 1.48734375, 1.489453125, 1.481421875, 1.48875, 1.489453125, 1.48153125, 1.48353125, 1.485640625, 1.4859375, 1.48875, 1.484640625, 1.4845312499999999, 1.488046875, 1.4859375, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.4866406250000002, 1.48353125, 1.48734375, 1.4866406250000002, 1.48634375, 1.488046875, 1.4859375, 1.48734375, 1.48634375, 1.4870468749999999, 1.48875, 1.485640625, 1.48634375, 1.48875, 1.48734375, 1.48253125, 1.48875, 1.4845312499999999, 1.489453125, 1.48734375, 1.4877500000000001, 1.48875, 1.482125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.485234375, 1.48875, 1.484234375, 1.48875, 1.4866406250000002, 1.4859375, 1.48875, 1.4845312499999999, 1.47971875, 1.483828125, 1.48875, 1.488046875, 1.4866406250000002, 1.4859375, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.4828281250000002, 1.479828125, 1.48634375, 1.4859375, 1.48634375, 1.483125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.4828281250000002, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48734375, 1.4845312499999999, 1.48734375, 1.483828125, 1.4859375, 1.4780156249999998, 1.4845312499999999, 1.483640625, 1.4794218749999999, 1.48875, 1.485640625, 1.4845312499999999, 1.483125, 1.481125, 1.489453125, 1.485234375, 1.48875, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.489453125, 1.4849375, 1.48634375, 1.488046875, 1.4849375, 1.48875, 1.4845312499999999, 1.48534375, 1.48875, 1.4839375000000001, 1.483640625, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.488046875, 1.486046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.4866406250000002, 1.489453125, 1.4849375, 1.4859375, 1.48634375, 1.489453125, 1.48634375, 1.48875, 1.48353125, 1.488046875, 1.4832343749999999, 1.488046875, 1.4866406250000002, 1.4849375, 1.48875, 1.4783125, 1.489453125, 1.4870468749999999, 1.481125, 1.485234375, 1.481421875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48534375, 1.4877500000000001, 1.488046875, 1.4866406250000002, 1.48734375, 1.480015625, 1.48634375, 1.485640625, 1.484640625, 1.4877500000000001, 1.48734375], "episode_lengths": [18, 15, 20, 18, 17, 19, 16, 23, 18, 17, 17, 16, 17, 16, 28, 16, 19, 16, 18, 20, 17, 16, 21, 19, 18, 18, 16, 24, 21, 20, 19, 18, 15, 18, 17, 20, 18, 26, 18, 15, 18, 20, 26, 19, 18, 15, 23, 18, 14, 18, 15, 25, 16, 15, 22, 22, 19, 20, 16, 19, 22, 17, 20, 15, 17, 19, 18, 19, 22, 18, 19, 18, 17, 20, 18, 18, 17, 16, 19, 18, 16, 18, 22, 16, 22, 15, 18, 16, 16, 24, 17, 16, 15, 18, 17, 21, 16, 21, 16, 19, 20, 16, 22, 26, 23, 16, 17, 19, 20, 15, 17, 18, 15, 23, 23, 18, 20, 18, 24, 16, 17, 17, 16, 16, 16, 15, 21, 15, 20, 23, 15, 18, 15, 17, 18, 22, 18, 23, 20, 27, 22, 19, 25, 16, 19, 22, 24, 24, 15, 21, 16, 16, 15, 20, 15, 15, 20, 18, 17, 20, 16, 22, 18, 16, 20, 19, 16, 16, 16, 16, 17, 17, 15, 18, 15, 15, 16, 19, 15, 20, 20, 18, 15, 18, 16, 22, 17, 21, 17, 19, 20, 16, 28, 15, 17, 24, 21, 25, 16, 18, 15, 16, 18, 16, 17, 19, 18, 27, 18, 19, 19, 16, 18], "policy_red_0_reward": [1.48734375, 1.489453125, 1.4849375, 1.48734375, 1.4870468749999999, 1.4866406250000002, 1.4877500000000001, 1.483828125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.4803125000000001, 1.48875, 1.485640625, 1.48875, 1.48734375, 1.4849375, 1.488046875, 1.48875, 1.482234375, 1.4866406250000002, 1.48534375, 1.48734375, 1.48875, 1.483125, 1.485234375, 1.4809375, 1.483640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.4859375, 1.48734375, 1.47971875, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4807187499999999, 1.485640625, 1.48634375, 1.489453125, 1.4828281250000002, 1.48634375, 1.49015625, 1.48734375, 1.489453125, 1.481421875, 1.48875, 1.489453125, 1.48153125, 1.48353125, 1.485640625, 1.4859375, 1.48875, 1.484640625, 1.4845312499999999, 1.488046875, 1.4859375, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.4866406250000002, 1.48353125, 1.48734375, 1.4866406250000002, 1.48634375, 1.488046875, 1.4859375, 1.48734375, 1.48634375, 1.4870468749999999, 1.48875, 1.485640625, 1.48634375, 1.48875, 1.48734375, 1.48253125, 1.48875, 1.4845312499999999, 1.489453125, 1.48734375, 1.4877500000000001, 1.48875, 1.482125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.485234375, 1.48875, 1.484234375, 1.48875, 1.4866406250000002, 1.4859375, 1.48875, 1.4845312499999999, 1.47971875, 1.483828125, 1.48875, 1.488046875, 1.4866406250000002, 1.4859375, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.4828281250000002, 1.479828125, 1.48634375, 1.4859375, 1.48634375, 1.483125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.4828281250000002, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48734375, 1.4845312499999999, 1.48734375, 1.483828125, 1.4859375, 1.4780156249999998, 1.4845312499999999, 1.483640625, 1.4794218749999999, 1.48875, 1.485640625, 1.4845312499999999, 1.483125, 1.481125, 1.489453125, 1.485234375, 1.48875, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.489453125, 1.4849375, 1.48634375, 1.488046875, 1.4849375, 1.48875, 1.4845312499999999, 1.48534375, 1.48875, 1.4839375000000001, 1.483640625, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.488046875, 1.486046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.4866406250000002, 1.489453125, 1.4849375, 1.4859375, 1.48634375, 1.489453125, 1.48634375, 1.48875, 1.48353125, 1.488046875, 1.4832343749999999, 1.488046875, 1.4866406250000002, 1.4849375, 1.48875, 1.4783125, 1.489453125, 1.4870468749999999, 1.481125, 1.485234375, 1.481421875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48534375, 1.4877500000000001, 1.488046875, 1.4866406250000002, 1.48734375, 1.480015625, 1.48634375, 1.485640625, 1.484640625, 1.4877500000000001, 1.48734375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254724474211898, "mean_inference_ms": 1.7289013134924993, "mean_action_processing_ms": 0.1040380635092874, "mean_env_wait_ms": 0.15398502934930228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10497178270223555, "StateBufferConnector_ms": 0.008235403069867774, "ViewRequirementAgentConnector_ms": 0.11919451431489327}}, "episode_reward_max": 1.49015625, "episode_reward_min": 1.4780156249999998, "episode_reward_mean": 1.4865201731220659, "episode_len_mean": 18.483568075117372, "episodes_this_iter": 213, "policy_reward_min": {"red_0": 1.4780156249999998}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4865201731220659}, "hist_stats": {"episode_reward": [1.48734375, 1.489453125, 1.4849375, 1.48734375, 1.4870468749999999, 1.4866406250000002, 1.4877500000000001, 1.483828125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.4803125000000001, 1.48875, 1.485640625, 1.48875, 1.48734375, 1.4849375, 1.488046875, 1.48875, 1.482234375, 1.4866406250000002, 1.48534375, 1.48734375, 1.48875, 1.483125, 1.485234375, 1.4809375, 1.483640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.4859375, 1.48734375, 1.47971875, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4807187499999999, 1.485640625, 1.48634375, 1.489453125, 1.4828281250000002, 1.48634375, 1.49015625, 1.48734375, 1.489453125, 1.481421875, 1.48875, 1.489453125, 1.48153125, 1.48353125, 1.485640625, 1.4859375, 1.48875, 1.484640625, 1.4845312499999999, 1.488046875, 1.4859375, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.4866406250000002, 1.48353125, 1.48734375, 1.4866406250000002, 1.48634375, 1.488046875, 1.4859375, 1.48734375, 1.48634375, 1.4870468749999999, 1.48875, 1.485640625, 1.48634375, 1.48875, 1.48734375, 1.48253125, 1.48875, 1.4845312499999999, 1.489453125, 1.48734375, 1.4877500000000001, 1.48875, 1.482125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.485234375, 1.48875, 1.484234375, 1.48875, 1.4866406250000002, 1.4859375, 1.48875, 1.4845312499999999, 1.47971875, 1.483828125, 1.48875, 1.488046875, 1.4866406250000002, 1.4859375, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.4828281250000002, 1.479828125, 1.48634375, 1.4859375, 1.48634375, 1.483125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.4828281250000002, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48734375, 1.4845312499999999, 1.48734375, 1.483828125, 1.4859375, 1.4780156249999998, 1.4845312499999999, 1.483640625, 1.4794218749999999, 1.48875, 1.485640625, 1.4845312499999999, 1.483125, 1.481125, 1.489453125, 1.485234375, 1.48875, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.489453125, 1.4849375, 1.48634375, 1.488046875, 1.4849375, 1.48875, 1.4845312499999999, 1.48534375, 1.48875, 1.4839375000000001, 1.483640625, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.488046875, 1.486046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.4866406250000002, 1.489453125, 1.4849375, 1.4859375, 1.48634375, 1.489453125, 1.48634375, 1.48875, 1.48353125, 1.488046875, 1.4832343749999999, 1.488046875, 1.4866406250000002, 1.4849375, 1.48875, 1.4783125, 1.489453125, 1.4870468749999999, 1.481125, 1.485234375, 1.481421875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48534375, 1.4877500000000001, 1.488046875, 1.4866406250000002, 1.48734375, 1.480015625, 1.48634375, 1.485640625, 1.484640625, 1.4877500000000001, 1.48734375], "episode_lengths": [18, 15, 20, 18, 17, 19, 16, 23, 18, 17, 17, 16, 17, 16, 28, 16, 19, 16, 18, 20, 17, 16, 21, 19, 18, 18, 16, 24, 21, 20, 19, 18, 15, 18, 17, 20, 18, 26, 18, 15, 18, 20, 26, 19, 18, 15, 23, 18, 14, 18, 15, 25, 16, 15, 22, 22, 19, 20, 16, 19, 22, 17, 20, 15, 17, 19, 18, 19, 22, 18, 19, 18, 17, 20, 18, 18, 17, 16, 19, 18, 16, 18, 22, 16, 22, 15, 18, 16, 16, 24, 17, 16, 15, 18, 17, 21, 16, 21, 16, 19, 20, 16, 22, 26, 23, 16, 17, 19, 20, 15, 17, 18, 15, 23, 23, 18, 20, 18, 24, 16, 17, 17, 16, 16, 16, 15, 21, 15, 20, 23, 15, 18, 15, 17, 18, 22, 18, 23, 20, 27, 22, 19, 25, 16, 19, 22, 24, 24, 15, 21, 16, 16, 15, 20, 15, 15, 20, 18, 17, 20, 16, 22, 18, 16, 20, 19, 16, 16, 16, 16, 17, 17, 15, 18, 15, 15, 16, 19, 15, 20, 20, 18, 15, 18, 16, 22, 17, 21, 17, 19, 20, 16, 28, 15, 17, 24, 21, 25, 16, 18, 15, 16, 18, 16, 17, 19, 18, 27, 18, 19, 19, 16, 18], "policy_red_0_reward": [1.48734375, 1.489453125, 1.4849375, 1.48734375, 1.4870468749999999, 1.4866406250000002, 1.4877500000000001, 1.483828125, 1.48734375, 1.488046875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.4803125000000001, 1.48875, 1.485640625, 1.48875, 1.48734375, 1.4849375, 1.488046875, 1.48875, 1.482234375, 1.4866406250000002, 1.48534375, 1.48734375, 1.48875, 1.483125, 1.485234375, 1.4809375, 1.483640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.4859375, 1.48734375, 1.47971875, 1.48734375, 1.489453125, 1.48734375, 1.4859375, 1.4807187499999999, 1.485640625, 1.48634375, 1.489453125, 1.4828281250000002, 1.48634375, 1.49015625, 1.48734375, 1.489453125, 1.481421875, 1.48875, 1.489453125, 1.48153125, 1.48353125, 1.485640625, 1.4859375, 1.48875, 1.484640625, 1.4845312499999999, 1.488046875, 1.4859375, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.4866406250000002, 1.48353125, 1.48734375, 1.4866406250000002, 1.48634375, 1.488046875, 1.4859375, 1.48734375, 1.48634375, 1.4870468749999999, 1.48875, 1.485640625, 1.48634375, 1.48875, 1.48734375, 1.48253125, 1.48875, 1.4845312499999999, 1.489453125, 1.48734375, 1.4877500000000001, 1.48875, 1.482125, 1.488046875, 1.48875, 1.489453125, 1.48734375, 1.488046875, 1.485234375, 1.48875, 1.484234375, 1.48875, 1.4866406250000002, 1.4859375, 1.48875, 1.4845312499999999, 1.47971875, 1.483828125, 1.48875, 1.488046875, 1.4866406250000002, 1.4859375, 1.489453125, 1.488046875, 1.48734375, 1.489453125, 1.4828281250000002, 1.479828125, 1.48634375, 1.4859375, 1.48634375, 1.483125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.485234375, 1.489453125, 1.4859375, 1.4828281250000002, 1.489453125, 1.48734375, 1.489453125, 1.488046875, 1.48734375, 1.4845312499999999, 1.48734375, 1.483828125, 1.4859375, 1.4780156249999998, 1.4845312499999999, 1.483640625, 1.4794218749999999, 1.48875, 1.485640625, 1.4845312499999999, 1.483125, 1.481125, 1.489453125, 1.485234375, 1.48875, 1.48875, 1.489453125, 1.4859375, 1.489453125, 1.489453125, 1.4849375, 1.48634375, 1.488046875, 1.4849375, 1.48875, 1.4845312499999999, 1.48534375, 1.48875, 1.4839375000000001, 1.483640625, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.488046875, 1.486046875, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.4866406250000002, 1.489453125, 1.4849375, 1.4859375, 1.48634375, 1.489453125, 1.48634375, 1.48875, 1.48353125, 1.488046875, 1.4832343749999999, 1.488046875, 1.4866406250000002, 1.4849375, 1.48875, 1.4783125, 1.489453125, 1.4870468749999999, 1.481125, 1.485234375, 1.481421875, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.48534375, 1.4877500000000001, 1.488046875, 1.4866406250000002, 1.48734375, 1.480015625, 1.48634375, 1.485640625, 1.484640625, 1.4877500000000001, 1.48734375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4254724474211898, "mean_inference_ms": 1.7289013134924993, "mean_action_processing_ms": 0.1040380635092874, "mean_env_wait_ms": 0.15398502934930228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10497178270223555, "StateBufferConnector_ms": 0.008235403069867774, "ViewRequirementAgentConnector_ms": 0.11919451431489327}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.31550446723037, "num_env_steps_trained_throughput_per_sec": 234.31550446723037, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 16967.871, "sample_time_ms": 9928.878, "learn_time_ms": 6995.317, "learn_throughput": 571.811, "synch_weights_time_ms": 43.049}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 1161, "training_iteration": 31, "trial_id": "2558d_00000", "date": "2023-09-10_14-04-38", "timestamp": 1694369078, "time_this_iter_s": 17.084655046463013, "time_total_s": 519.5822343826294, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c1b4d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 519.5822343826294, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.429629629629627, "ram_util_percent": 31.344444444444438}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1470157594420016, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.02054481356414423, "policy_loss": -0.024907053451170214, "vf_loss": 0.0012688281966196275, "vf_explained_var": 0.9705043220271666, "kl": 0.010311370225863925, "entropy": 0.49875451444337765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 1.49015625, "episode_reward_min": 1.3666874999999998, "episode_reward_mean": 1.4866941266741074, "episode_len_mean": 18.308035714285715, "episode_media": {}, "episodes_this_iter": 224, "policy_reward_min": {"red_0": 1.3666874999999998}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4866941266741074}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.488046875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.485234375, 1.48875, 1.48634375, 1.49015625, 1.4859375, 1.483828125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4839375000000001, 1.489453125, 1.48353125, 1.48875, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.4866406250000002, 1.485640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4793125, 1.489453125, 1.488046875, 1.48875, 1.485640625, 1.4877500000000001, 1.483828125, 1.48875, 1.48534375, 1.488046875, 1.485640625, 1.4877500000000001, 1.488046875, 1.4845312499999999, 1.48634375, 1.48734375, 1.485640625, 1.489453125, 1.4859375, 1.48734375, 1.489453125, 1.4870468749999999, 1.48253125, 1.484234375, 1.4877500000000001, 1.48634375, 1.48875, 1.4866406250000002, 1.4849375, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.3666874999999998, 1.4866406250000002, 1.488046875, 1.488046875, 1.489453125, 1.4870468749999999, 1.485640625, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4870468749999999, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.4832343749999999, 1.489453125, 1.4877500000000001, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.48875, 1.4849375, 1.485640625, 1.489453125, 1.484640625, 1.488046875, 1.485234375, 1.489453125, 1.48875, 1.48634375, 1.485640625, 1.488046875, 1.48734375, 1.48734375, 1.4877500000000001, 1.48734375, 1.484234375, 1.4877500000000001, 1.489453125, 1.4859375, 1.4870468749999999, 1.48875, 1.489453125, 1.48634375, 1.485640625, 1.48734375, 1.4776093750000001, 1.48875, 1.4859375, 1.48875, 1.4866406250000002, 1.488046875, 1.489453125, 1.4743906249999998, 1.482421875, 1.483828125, 1.4859375, 1.48875, 1.4839375000000001, 1.4839375000000001, 1.4866406250000002, 1.485234375, 1.489453125, 1.48875, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4845312499999999, 1.48875, 1.485640625, 1.489453125, 1.4859375, 1.4859375, 1.489453125, 1.4859375, 1.482421875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.485640625, 1.483640625, 1.4866406250000002, 1.48634375, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4877500000000001, 1.488046875, 1.485234375, 1.485234375, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.4828281250000002, 1.48534375, 1.489453125, 1.48875, 1.483828125, 1.4849375, 1.4877500000000001, 1.480828125, 1.486046875, 1.48875, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.486046875, 1.48875, 1.48634375, 1.4859375, 1.48875, 1.48634375, 1.48734375, 1.489453125, 1.4877500000000001, 1.48534375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.488046875, 1.48875, 1.4866406250000002, 1.4849375, 1.485234375, 1.4877500000000001, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.4859375], "episode_lengths": [17, 19, 15, 17, 15, 16, 21, 16, 18, 14, 20, 23, 15, 18, 15, 16, 20, 15, 22, 16, 17, 16, 17, 15, 19, 19, 18, 15, 18, 17, 15, 15, 17, 28, 15, 17, 16, 19, 16, 23, 16, 18, 17, 19, 16, 17, 22, 18, 18, 19, 15, 20, 18, 15, 17, 22, 21, 16, 18, 16, 19, 20, 15, 17, 17, 18, 15, 15, 164, 19, 17, 17, 15, 17, 19, 16, 16, 15, 16, 16, 17, 15, 17, 15, 15, 19, 19, 21, 15, 16, 16, 21, 15, 15, 16, 20, 19, 15, 19, 17, 21, 15, 16, 18, 19, 17, 18, 18, 16, 18, 21, 16, 15, 20, 17, 16, 15, 18, 19, 18, 29, 16, 20, 16, 19, 17, 15, 35, 25, 23, 20, 16, 20, 20, 19, 21, 15, 16, 20, 15, 16, 17, 22, 16, 19, 15, 20, 20, 15, 20, 25, 17, 15, 17, 17, 19, 19, 19, 18, 17, 16, 15, 16, 16, 16, 17, 21, 21, 17, 17, 16, 15, 17, 16, 16, 16, 16, 18, 23, 18, 15, 16, 23, 20, 16, 23, 17, 16, 18, 16, 16, 18, 16, 15, 17, 16, 18, 20, 16, 18, 18, 15, 16, 18, 16, 16, 18, 16, 17, 18, 16, 17, 16, 19, 20, 21, 16, 16, 20, 17, 15, 15, 18, 20], "policy_red_0_reward": [1.488046875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.485234375, 1.48875, 1.48634375, 1.49015625, 1.4859375, 1.483828125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4839375000000001, 1.489453125, 1.48353125, 1.48875, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.4866406250000002, 1.485640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4793125, 1.489453125, 1.488046875, 1.48875, 1.485640625, 1.4877500000000001, 1.483828125, 1.48875, 1.48534375, 1.488046875, 1.485640625, 1.4877500000000001, 1.488046875, 1.4845312499999999, 1.48634375, 1.48734375, 1.485640625, 1.489453125, 1.4859375, 1.48734375, 1.489453125, 1.4870468749999999, 1.48253125, 1.484234375, 1.4877500000000001, 1.48634375, 1.48875, 1.4866406250000002, 1.4849375, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.3666874999999998, 1.4866406250000002, 1.488046875, 1.488046875, 1.489453125, 1.4870468749999999, 1.485640625, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4870468749999999, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.4832343749999999, 1.489453125, 1.4877500000000001, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.48875, 1.4849375, 1.485640625, 1.489453125, 1.484640625, 1.488046875, 1.485234375, 1.489453125, 1.48875, 1.48634375, 1.485640625, 1.488046875, 1.48734375, 1.48734375, 1.4877500000000001, 1.48734375, 1.484234375, 1.4877500000000001, 1.489453125, 1.4859375, 1.4870468749999999, 1.48875, 1.489453125, 1.48634375, 1.485640625, 1.48734375, 1.4776093750000001, 1.48875, 1.4859375, 1.48875, 1.4866406250000002, 1.488046875, 1.489453125, 1.4743906249999998, 1.482421875, 1.483828125, 1.4859375, 1.48875, 1.4839375000000001, 1.4839375000000001, 1.4866406250000002, 1.485234375, 1.489453125, 1.48875, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4845312499999999, 1.48875, 1.485640625, 1.489453125, 1.4859375, 1.4859375, 1.489453125, 1.4859375, 1.482421875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.485640625, 1.483640625, 1.4866406250000002, 1.48634375, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4877500000000001, 1.488046875, 1.485234375, 1.485234375, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.4828281250000002, 1.48534375, 1.489453125, 1.48875, 1.483828125, 1.4849375, 1.4877500000000001, 1.480828125, 1.486046875, 1.48875, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.486046875, 1.48875, 1.48634375, 1.4859375, 1.48875, 1.48634375, 1.48734375, 1.489453125, 1.4877500000000001, 1.48534375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.488046875, 1.48875, 1.4866406250000002, 1.4849375, 1.485234375, 1.4877500000000001, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.4859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4278696737627659, "mean_inference_ms": 1.729714166378128, "mean_action_processing_ms": 0.10407374325361804, "mean_env_wait_ms": 0.15448883816250464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10718171085630145, "StateBufferConnector_ms": 0.008495790617806571, "ViewRequirementAgentConnector_ms": 0.1210263797215053}}, "episode_reward_max": 1.49015625, "episode_reward_min": 1.3666874999999998, "episode_reward_mean": 1.4866941266741074, "episode_len_mean": 18.308035714285715, "episodes_this_iter": 224, "policy_reward_min": {"red_0": 1.3666874999999998}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4866941266741074}, "hist_stats": {"episode_reward": [1.488046875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.485234375, 1.48875, 1.48634375, 1.49015625, 1.4859375, 1.483828125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4839375000000001, 1.489453125, 1.48353125, 1.48875, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.4866406250000002, 1.485640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4793125, 1.489453125, 1.488046875, 1.48875, 1.485640625, 1.4877500000000001, 1.483828125, 1.48875, 1.48534375, 1.488046875, 1.485640625, 1.4877500000000001, 1.488046875, 1.4845312499999999, 1.48634375, 1.48734375, 1.485640625, 1.489453125, 1.4859375, 1.48734375, 1.489453125, 1.4870468749999999, 1.48253125, 1.484234375, 1.4877500000000001, 1.48634375, 1.48875, 1.4866406250000002, 1.4849375, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.3666874999999998, 1.4866406250000002, 1.488046875, 1.488046875, 1.489453125, 1.4870468749999999, 1.485640625, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4870468749999999, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.4832343749999999, 1.489453125, 1.4877500000000001, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.48875, 1.4849375, 1.485640625, 1.489453125, 1.484640625, 1.488046875, 1.485234375, 1.489453125, 1.48875, 1.48634375, 1.485640625, 1.488046875, 1.48734375, 1.48734375, 1.4877500000000001, 1.48734375, 1.484234375, 1.4877500000000001, 1.489453125, 1.4859375, 1.4870468749999999, 1.48875, 1.489453125, 1.48634375, 1.485640625, 1.48734375, 1.4776093750000001, 1.48875, 1.4859375, 1.48875, 1.4866406250000002, 1.488046875, 1.489453125, 1.4743906249999998, 1.482421875, 1.483828125, 1.4859375, 1.48875, 1.4839375000000001, 1.4839375000000001, 1.4866406250000002, 1.485234375, 1.489453125, 1.48875, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4845312499999999, 1.48875, 1.485640625, 1.489453125, 1.4859375, 1.4859375, 1.489453125, 1.4859375, 1.482421875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.485640625, 1.483640625, 1.4866406250000002, 1.48634375, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4877500000000001, 1.488046875, 1.485234375, 1.485234375, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.4828281250000002, 1.48534375, 1.489453125, 1.48875, 1.483828125, 1.4849375, 1.4877500000000001, 1.480828125, 1.486046875, 1.48875, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.486046875, 1.48875, 1.48634375, 1.4859375, 1.48875, 1.48634375, 1.48734375, 1.489453125, 1.4877500000000001, 1.48534375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.488046875, 1.48875, 1.4866406250000002, 1.4849375, 1.485234375, 1.4877500000000001, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.4859375], "episode_lengths": [17, 19, 15, 17, 15, 16, 21, 16, 18, 14, 20, 23, 15, 18, 15, 16, 20, 15, 22, 16, 17, 16, 17, 15, 19, 19, 18, 15, 18, 17, 15, 15, 17, 28, 15, 17, 16, 19, 16, 23, 16, 18, 17, 19, 16, 17, 22, 18, 18, 19, 15, 20, 18, 15, 17, 22, 21, 16, 18, 16, 19, 20, 15, 17, 17, 18, 15, 15, 164, 19, 17, 17, 15, 17, 19, 16, 16, 15, 16, 16, 17, 15, 17, 15, 15, 19, 19, 21, 15, 16, 16, 21, 15, 15, 16, 20, 19, 15, 19, 17, 21, 15, 16, 18, 19, 17, 18, 18, 16, 18, 21, 16, 15, 20, 17, 16, 15, 18, 19, 18, 29, 16, 20, 16, 19, 17, 15, 35, 25, 23, 20, 16, 20, 20, 19, 21, 15, 16, 20, 15, 16, 17, 22, 16, 19, 15, 20, 20, 15, 20, 25, 17, 15, 17, 17, 19, 19, 19, 18, 17, 16, 15, 16, 16, 16, 17, 21, 21, 17, 17, 16, 15, 17, 16, 16, 16, 16, 18, 23, 18, 15, 16, 23, 20, 16, 23, 17, 16, 18, 16, 16, 18, 16, 15, 17, 16, 18, 20, 16, 18, 18, 15, 16, 18, 16, 16, 18, 16, 17, 18, 16, 17, 16, 19, 20, 21, 16, 16, 20, 17, 15, 15, 18, 20], "policy_red_0_reward": [1.488046875, 1.4866406250000002, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.485234375, 1.48875, 1.48634375, 1.49015625, 1.4859375, 1.483828125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4839375000000001, 1.489453125, 1.48353125, 1.48875, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.4866406250000002, 1.485640625, 1.48734375, 1.489453125, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4793125, 1.489453125, 1.488046875, 1.48875, 1.485640625, 1.4877500000000001, 1.483828125, 1.48875, 1.48534375, 1.488046875, 1.485640625, 1.4877500000000001, 1.488046875, 1.4845312499999999, 1.48634375, 1.48734375, 1.485640625, 1.489453125, 1.4859375, 1.48734375, 1.489453125, 1.4870468749999999, 1.48253125, 1.484234375, 1.4877500000000001, 1.48634375, 1.48875, 1.4866406250000002, 1.4849375, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.489453125, 1.489453125, 1.3666874999999998, 1.4866406250000002, 1.488046875, 1.488046875, 1.489453125, 1.4870468749999999, 1.485640625, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4870468749999999, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.4866406250000002, 1.4866406250000002, 1.4832343749999999, 1.489453125, 1.4877500000000001, 1.48875, 1.485234375, 1.489453125, 1.489453125, 1.48875, 1.4849375, 1.485640625, 1.489453125, 1.484640625, 1.488046875, 1.485234375, 1.489453125, 1.48875, 1.48634375, 1.485640625, 1.488046875, 1.48734375, 1.48734375, 1.4877500000000001, 1.48734375, 1.484234375, 1.4877500000000001, 1.489453125, 1.4859375, 1.4870468749999999, 1.48875, 1.489453125, 1.48634375, 1.485640625, 1.48734375, 1.4776093750000001, 1.48875, 1.4859375, 1.48875, 1.4866406250000002, 1.488046875, 1.489453125, 1.4743906249999998, 1.482421875, 1.483828125, 1.4859375, 1.48875, 1.4839375000000001, 1.4839375000000001, 1.4866406250000002, 1.485234375, 1.489453125, 1.48875, 1.4859375, 1.489453125, 1.48875, 1.488046875, 1.4845312499999999, 1.48875, 1.485640625, 1.489453125, 1.4859375, 1.4859375, 1.489453125, 1.4859375, 1.482421875, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.485640625, 1.483640625, 1.4866406250000002, 1.48634375, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.4877500000000001, 1.488046875, 1.485234375, 1.485234375, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.48875, 1.48875, 1.48734375, 1.4828281250000002, 1.48534375, 1.489453125, 1.48875, 1.483828125, 1.4849375, 1.4877500000000001, 1.480828125, 1.486046875, 1.48875, 1.48734375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.489453125, 1.486046875, 1.48875, 1.48634375, 1.4859375, 1.48875, 1.48634375, 1.48734375, 1.489453125, 1.4877500000000001, 1.48534375, 1.48875, 1.48875, 1.48734375, 1.48875, 1.488046875, 1.48734375, 1.48875, 1.488046875, 1.48875, 1.4866406250000002, 1.4849375, 1.485234375, 1.4877500000000001, 1.48875, 1.4859375, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.4859375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4278696737627659, "mean_inference_ms": 1.729714166378128, "mean_action_processing_ms": 0.10407374325361804, "mean_env_wait_ms": 0.15448883816250464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10718171085630145, "StateBufferConnector_ms": 0.008495790617806571, "ViewRequirementAgentConnector_ms": 0.1210263797215053}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.2988288980011, "num_env_steps_trained_throughput_per_sec": 234.2988288980011, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 17058.041, "sample_time_ms": 10002.678, "learn_time_ms": 7011.662, "learn_throughput": 570.478, "synch_weights_time_ms": 43.072}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 1385, "training_iteration": 32, "trial_id": "2558d_00000", "date": "2023-09-10_14-04-57", "timestamp": 1694369097, "time_this_iter_s": 17.08638072013855, "time_total_s": 536.668615102768, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15f8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 536.668615102768, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.053571428571423, "ram_util_percent": 31.31428571428572}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2559702063289782, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017576445785986532, "policy_loss": -0.02108121727311906, "vf_loss": 0.0011082287836112906, "vf_explained_var": 0.9742162957787514, "kl": 0.007988474167034132, "entropy": 0.4058824911092718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.45521875, "episode_reward_mean": 1.4878783623417724, "episode_len_mean": 16.91561181434599, "episode_media": {}, "episodes_this_iter": 237, "policy_reward_min": {"red_0": 1.45521875}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4878783623417724}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4859375, 1.489453125, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48634375, 1.4870468749999999, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.485234375, 1.485640625, 1.489453125, 1.4877500000000001, 1.485640625, 1.48875, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.484234375, 1.4866406250000002, 1.4849375, 1.48734375, 1.485234375, 1.4870468749999999, 1.482421875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.471984375, 1.488046875, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.4859375, 1.4877500000000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48734375, 1.485640625, 1.48875, 1.48875, 1.48734375, 1.48734375, 1.488046875, 1.4859375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48171875, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4877500000000001, 1.489453125, 1.45521875, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.488046875, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.4870468749999999, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48634375, 1.48875, 1.488046875, 1.485234375, 1.48875, 1.4870468749999999, 1.4877500000000001, 1.489453125, 1.4870468749999999, 1.489453125, 1.4859375, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4870468749999999, 1.483828125, 1.48875, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.49015625, 1.48875, 1.48634375, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.485234375, 1.48534375, 1.48875, 1.4866406250000002, 1.48875, 1.48875, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.484234375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.483640625, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.485640625, 1.48634375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4877500000000001, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.48634375, 1.489453125, 1.488046875, 1.48634375, 1.485234375, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.4839375000000001, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48634375, 1.48734375, 1.482125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4870468749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999], "episode_lengths": [17, 15, 15, 18, 20, 15, 16, 16, 16, 16, 16, 16, 15, 17, 15, 18, 16, 16, 15, 16, 18, 17, 19, 16, 15, 15, 17, 17, 18, 21, 19, 15, 16, 19, 16, 15, 18, 15, 15, 15, 21, 19, 20, 18, 21, 17, 25, 16, 15, 17, 16, 16, 17, 15, 17, 17, 16, 15, 37, 17, 16, 20, 15, 15, 19, 16, 17, 16, 20, 16, 18, 19, 17, 16, 16, 17, 15, 18, 19, 16, 16, 18, 18, 17, 20, 19, 17, 15, 26, 17, 15, 16, 16, 16, 15, 58, 15, 15, 15, 19, 17, 16, 15, 15, 15, 16, 17, 17, 16, 15, 16, 15, 15, 16, 15, 17, 15, 16, 17, 17, 15, 16, 17, 18, 16, 15, 15, 18, 16, 17, 21, 16, 17, 16, 15, 17, 15, 20, 16, 17, 16, 17, 15, 16, 15, 15, 17, 23, 16, 15, 19, 16, 17, 16, 17, 16, 15, 16, 15, 16, 14, 16, 18, 15, 15, 17, 15, 15, 15, 16, 21, 18, 16, 19, 16, 16, 17, 16, 18, 15, 16, 21, 16, 16, 15, 15, 19, 15, 17, 19, 18, 19, 18, 16, 15, 16, 16, 15, 15, 15, 16, 15, 16, 18, 17, 15, 15, 18, 18, 15, 17, 18, 21, 15, 19, 15, 17, 20, 18, 15, 16, 16, 16, 16, 18, 18, 24, 15, 15, 16, 15, 17, 16, 15, 15, 15, 13], "policy_red_0_reward": [1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4859375, 1.489453125, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48634375, 1.4870468749999999, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.485234375, 1.485640625, 1.489453125, 1.4877500000000001, 1.485640625, 1.48875, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.484234375, 1.4866406250000002, 1.4849375, 1.48734375, 1.485234375, 1.4870468749999999, 1.482421875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.471984375, 1.488046875, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.4859375, 1.4877500000000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48734375, 1.485640625, 1.48875, 1.48875, 1.48734375, 1.48734375, 1.488046875, 1.4859375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48171875, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4877500000000001, 1.489453125, 1.45521875, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.488046875, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.4870468749999999, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48634375, 1.48875, 1.488046875, 1.485234375, 1.48875, 1.4870468749999999, 1.4877500000000001, 1.489453125, 1.4870468749999999, 1.489453125, 1.4859375, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4870468749999999, 1.483828125, 1.48875, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.49015625, 1.48875, 1.48634375, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.485234375, 1.48534375, 1.48875, 1.4866406250000002, 1.48875, 1.48875, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.484234375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.483640625, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.485640625, 1.48634375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4877500000000001, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.48634375, 1.489453125, 1.488046875, 1.48634375, 1.485234375, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.4839375000000001, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48634375, 1.48734375, 1.482125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4870468749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4303800851404405, "mean_inference_ms": 1.733259084852642, "mean_action_processing_ms": 0.10428729555494719, "mean_env_wait_ms": 0.155129856652253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10367123889520702, "StateBufferConnector_ms": 0.008136713052097755, "ViewRequirementAgentConnector_ms": 0.12247341091622783}}, "episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.45521875, "episode_reward_mean": 1.4878783623417724, "episode_len_mean": 16.91561181434599, "episodes_this_iter": 237, "policy_reward_min": {"red_0": 1.45521875}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4878783623417724}, "hist_stats": {"episode_reward": [1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4859375, 1.489453125, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48634375, 1.4870468749999999, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.485234375, 1.485640625, 1.489453125, 1.4877500000000001, 1.485640625, 1.48875, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.484234375, 1.4866406250000002, 1.4849375, 1.48734375, 1.485234375, 1.4870468749999999, 1.482421875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.471984375, 1.488046875, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.4859375, 1.4877500000000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48734375, 1.485640625, 1.48875, 1.48875, 1.48734375, 1.48734375, 1.488046875, 1.4859375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48171875, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4877500000000001, 1.489453125, 1.45521875, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.488046875, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.4870468749999999, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48634375, 1.48875, 1.488046875, 1.485234375, 1.48875, 1.4870468749999999, 1.4877500000000001, 1.489453125, 1.4870468749999999, 1.489453125, 1.4859375, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4870468749999999, 1.483828125, 1.48875, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.49015625, 1.48875, 1.48634375, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.485234375, 1.48534375, 1.48875, 1.4866406250000002, 1.48875, 1.48875, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.484234375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.483640625, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.485640625, 1.48634375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4877500000000001, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.48634375, 1.489453125, 1.488046875, 1.48634375, 1.485234375, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.4839375000000001, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48634375, 1.48734375, 1.482125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4870468749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999], "episode_lengths": [17, 15, 15, 18, 20, 15, 16, 16, 16, 16, 16, 16, 15, 17, 15, 18, 16, 16, 15, 16, 18, 17, 19, 16, 15, 15, 17, 17, 18, 21, 19, 15, 16, 19, 16, 15, 18, 15, 15, 15, 21, 19, 20, 18, 21, 17, 25, 16, 15, 17, 16, 16, 17, 15, 17, 17, 16, 15, 37, 17, 16, 20, 15, 15, 19, 16, 17, 16, 20, 16, 18, 19, 17, 16, 16, 17, 15, 18, 19, 16, 16, 18, 18, 17, 20, 19, 17, 15, 26, 17, 15, 16, 16, 16, 15, 58, 15, 15, 15, 19, 17, 16, 15, 15, 15, 16, 17, 17, 16, 15, 16, 15, 15, 16, 15, 17, 15, 16, 17, 17, 15, 16, 17, 18, 16, 15, 15, 18, 16, 17, 21, 16, 17, 16, 15, 17, 15, 20, 16, 17, 16, 17, 15, 16, 15, 15, 17, 23, 16, 15, 19, 16, 17, 16, 17, 16, 15, 16, 15, 16, 14, 16, 18, 15, 15, 17, 15, 15, 15, 16, 21, 18, 16, 19, 16, 16, 17, 16, 18, 15, 16, 21, 16, 16, 15, 15, 19, 15, 17, 19, 18, 19, 18, 16, 15, 16, 16, 15, 15, 15, 16, 15, 16, 18, 17, 15, 15, 18, 18, 15, 17, 18, 21, 15, 19, 15, 17, 20, 18, 15, 16, 16, 16, 16, 18, 18, 24, 15, 15, 16, 15, 17, 16, 15, 15, 15, 13], "policy_red_0_reward": [1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4859375, 1.489453125, 1.48875, 1.4877500000000001, 1.48875, 1.48875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48634375, 1.4870468749999999, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48734375, 1.485234375, 1.485640625, 1.489453125, 1.4877500000000001, 1.485640625, 1.48875, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.484234375, 1.4866406250000002, 1.4849375, 1.48734375, 1.485234375, 1.4870468749999999, 1.482421875, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.4877500000000001, 1.489453125, 1.471984375, 1.488046875, 1.48875, 1.4859375, 1.489453125, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.4859375, 1.4877500000000001, 1.48734375, 1.4866406250000002, 1.488046875, 1.48875, 1.48875, 1.488046875, 1.489453125, 1.48734375, 1.485640625, 1.48875, 1.48875, 1.48734375, 1.48734375, 1.488046875, 1.4859375, 1.4866406250000002, 1.488046875, 1.489453125, 1.48171875, 1.488046875, 1.489453125, 1.48875, 1.48875, 1.4877500000000001, 1.489453125, 1.45521875, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.488046875, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.4870468749999999, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48634375, 1.48875, 1.488046875, 1.485234375, 1.48875, 1.4870468749999999, 1.4877500000000001, 1.489453125, 1.4870468749999999, 1.489453125, 1.4859375, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.4870468749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4870468749999999, 1.483828125, 1.48875, 1.489453125, 1.4866406250000002, 1.48875, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.49015625, 1.48875, 1.48634375, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.485234375, 1.48534375, 1.48875, 1.4866406250000002, 1.48875, 1.48875, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.48875, 1.484234375, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.483640625, 1.489453125, 1.488046875, 1.485640625, 1.48734375, 1.485640625, 1.48634375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4877500000000001, 1.48734375, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.48634375, 1.489453125, 1.488046875, 1.48634375, 1.485234375, 1.489453125, 1.4866406250000002, 1.489453125, 1.488046875, 1.4839375000000001, 1.48734375, 1.489453125, 1.48875, 1.48875, 1.48875, 1.48875, 1.48634375, 1.48734375, 1.482125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.4870468749999999, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4303800851404405, "mean_inference_ms": 1.733259084852642, "mean_action_processing_ms": 0.10428729555494719, "mean_env_wait_ms": 0.155129856652253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10367123889520702, "StateBufferConnector_ms": 0.008136713052097755, "ViewRequirementAgentConnector_ms": 0.12247341091622783}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.98973821255433, "num_env_steps_trained_throughput_per_sec": 231.98973821255433, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 17138.847, "sample_time_ms": 10103.702, "learn_time_ms": 6991.675, "learn_throughput": 572.109, "synch_weights_time_ms": 42.854}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 1622, "training_iteration": 33, "trial_id": "2558d_00000", "date": "2023-09-10_14-05-17", "timestamp": 1694369117, "time_this_iter_s": 17.256811141967773, "time_total_s": 553.9254262447357, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c15f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 553.9254262447357, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 26.075, "ram_util_percent": 31.20714285714286}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.009211178869009, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020412662194939913, "policy_loss": -0.02281241612896944, "vf_loss": 0.00029404397910184346, "vf_explained_var": 0.9933502251282335, "kl": 0.007019034457857269, "entropy": 0.3141037438064814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.48171875, "episode_reward_mean": 1.488351466049383, "episode_len_mean": 16.320987654320987, "episode_media": {}, "episodes_this_iter": 243, "policy_reward_min": {"red_0": 1.48171875}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.488351466049383}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.488046875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.485640625, 1.488046875, 1.4877500000000001, 1.488046875, 1.4870468749999999, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4849375, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48171875, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.4877500000000001, 1.48634375, 1.48534375, 1.489453125, 1.4845312499999999, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4877500000000001, 1.48734375, 1.489453125, 1.489453125, 1.4908593749999999, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.4870468749999999, 1.486046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48734375, 1.48875, 1.4866406250000002, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48634375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4877500000000001, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.4877500000000001, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.4870468749999999, 1.4866406250000002, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4870468749999999, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.4832343749999999, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.484640625, 1.4859375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.488046875, 1.4870468749999999, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.485234375, 1.48875, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001], "episode_lengths": [17, 16, 15, 17, 17, 16, 15, 15, 16, 16, 15, 17, 16, 17, 24, 17, 15, 18, 17, 16, 15, 17, 15, 15, 16, 17, 18, 15, 15, 19, 15, 16, 19, 17, 16, 17, 17, 19, 15, 15, 17, 16, 16, 15, 15, 16, 15, 15, 15, 15, 17, 15, 20, 15, 19, 16, 15, 15, 15, 15, 17, 17, 15, 15, 16, 16, 26, 15, 16, 15, 16, 15, 15, 15, 15, 15, 20, 16, 15, 16, 16, 15, 17, 15, 18, 15, 16, 15, 15, 24, 17, 16, 16, 15, 15, 18, 16, 18, 18, 15, 22, 16, 15, 17, 15, 15, 18, 16, 18, 15, 15, 13, 16, 17, 16, 15, 17, 17, 16, 15, 15, 17, 17, 16, 18, 16, 19, 18, 15, 16, 15, 15, 16, 18, 16, 16, 15, 16, 16, 17, 16, 17, 24, 16, 16, 18, 16, 16, 17, 17, 15, 15, 17, 19, 18, 15, 15, 17, 17, 15, 15, 18, 15, 16, 17, 21, 15, 15, 17, 15, 15, 15, 16, 17, 16, 15, 16, 15, 24, 17, 16, 16, 16, 15, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 21, 15, 15, 17, 15, 17, 19, 20, 15, 15, 16, 15, 17, 17, 17, 17, 15, 17, 16, 21, 16, 18, 15, 17, 17, 15, 15, 17, 17, 16, 15, 16, 16, 15, 16, 15, 16, 16, 18, 15, 15, 16, 15, 17, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.488046875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.485640625, 1.488046875, 1.4877500000000001, 1.488046875, 1.4870468749999999, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4849375, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48171875, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.4877500000000001, 1.48634375, 1.48534375, 1.489453125, 1.4845312499999999, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4877500000000001, 1.48734375, 1.489453125, 1.489453125, 1.4908593749999999, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.4870468749999999, 1.486046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48734375, 1.48875, 1.4866406250000002, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48634375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4877500000000001, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.4877500000000001, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.4870468749999999, 1.4866406250000002, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4870468749999999, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.4832343749999999, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.484640625, 1.4859375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.488046875, 1.4870468749999999, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.485234375, 1.48875, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4323257940331522, "mean_inference_ms": 1.73112215644753, "mean_action_processing_ms": 0.10423226264044422, "mean_env_wait_ms": 0.1554385946926705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10559107541056817, "StateBufferConnector_ms": 0.008510169668943303, "ViewRequirementAgentConnector_ms": 0.11776621940204636}}, "episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.48171875, "episode_reward_mean": 1.488351466049383, "episode_len_mean": 16.320987654320987, "episodes_this_iter": 243, "policy_reward_min": {"red_0": 1.48171875}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.488351466049383}, "hist_stats": {"episode_reward": [1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.488046875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.485640625, 1.488046875, 1.4877500000000001, 1.488046875, 1.4870468749999999, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4849375, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48171875, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.4877500000000001, 1.48634375, 1.48534375, 1.489453125, 1.4845312499999999, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4877500000000001, 1.48734375, 1.489453125, 1.489453125, 1.4908593749999999, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.4870468749999999, 1.486046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48734375, 1.48875, 1.4866406250000002, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48634375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4877500000000001, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.4877500000000001, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.4870468749999999, 1.4866406250000002, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4870468749999999, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.4832343749999999, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.484640625, 1.4859375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.488046875, 1.4870468749999999, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.485234375, 1.48875, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001], "episode_lengths": [17, 16, 15, 17, 17, 16, 15, 15, 16, 16, 15, 17, 16, 17, 24, 17, 15, 18, 17, 16, 15, 17, 15, 15, 16, 17, 18, 15, 15, 19, 15, 16, 19, 17, 16, 17, 17, 19, 15, 15, 17, 16, 16, 15, 15, 16, 15, 15, 15, 15, 17, 15, 20, 15, 19, 16, 15, 15, 15, 15, 17, 17, 15, 15, 16, 16, 26, 15, 16, 15, 16, 15, 15, 15, 15, 15, 20, 16, 15, 16, 16, 15, 17, 15, 18, 15, 16, 15, 15, 24, 17, 16, 16, 15, 15, 18, 16, 18, 18, 15, 22, 16, 15, 17, 15, 15, 18, 16, 18, 15, 15, 13, 16, 17, 16, 15, 17, 17, 16, 15, 15, 17, 17, 16, 18, 16, 19, 18, 15, 16, 15, 15, 16, 18, 16, 16, 15, 16, 16, 17, 16, 17, 24, 16, 16, 18, 16, 16, 17, 17, 15, 15, 17, 19, 18, 15, 15, 17, 17, 15, 15, 18, 15, 16, 17, 21, 15, 15, 17, 15, 15, 15, 16, 17, 16, 15, 16, 15, 24, 17, 16, 16, 16, 15, 16, 16, 15, 15, 15, 15, 16, 16, 15, 15, 21, 15, 15, 17, 15, 17, 19, 20, 15, 15, 16, 15, 17, 17, 17, 17, 15, 17, 16, 21, 16, 18, 15, 17, 17, 15, 15, 17, 17, 16, 15, 16, 16, 15, 16, 15, 16, 16, 18, 15, 15, 16, 15, 17, 15, 17, 15, 15, 16], "policy_red_0_reward": [1.488046875, 1.4877500000000001, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.488046875, 1.489453125, 1.48734375, 1.488046875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.48875, 1.485640625, 1.488046875, 1.4877500000000001, 1.488046875, 1.4870468749999999, 1.4866406250000002, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4849375, 1.489453125, 1.4866406250000002, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48171875, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4859375, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.4877500000000001, 1.48634375, 1.48534375, 1.489453125, 1.4845312499999999, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.4877500000000001, 1.48734375, 1.489453125, 1.489453125, 1.4908593749999999, 1.48875, 1.488046875, 1.48875, 1.489453125, 1.4870468749999999, 1.486046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48734375, 1.48875, 1.4866406250000002, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.48634375, 1.48875, 1.48875, 1.489453125, 1.48875, 1.4877500000000001, 1.488046875, 1.48875, 1.488046875, 1.483125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.4877500000000001, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.4870468749999999, 1.4866406250000002, 1.48734375, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.48875, 1.4870468749999999, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.483125, 1.4870468749999999, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.4832343749999999, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.484640625, 1.4859375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.488046875, 1.4870468749999999, 1.488046875, 1.488046875, 1.489453125, 1.488046875, 1.48875, 1.485234375, 1.48875, 1.48734375, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4323257940331522, "mean_inference_ms": 1.73112215644753, "mean_action_processing_ms": 0.10423226264044422, "mean_env_wait_ms": 0.1554385946926705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10559107541056817, "StateBufferConnector_ms": 0.008510169668943303, "ViewRequirementAgentConnector_ms": 0.11776621940204636}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.13530857571905, "num_env_steps_trained_throughput_per_sec": 239.13530857571905, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 17160.82, "sample_time_ms": 10132.258, "learn_time_ms": 6984.985, "learn_throughput": 572.657, "synch_weights_time_ms": 42.95}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 1865, "training_iteration": 34, "trial_id": "2558d_00000", "date": "2023-09-10_14-05-36", "timestamp": 1694369136, "time_this_iter_s": 16.741596937179565, "time_total_s": 570.6670231819153, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c2cd820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 570.6670231819153, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 25.82592592592593, "ram_util_percent": 31.399999999999995}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8192359038007756, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016115686974505175, "policy_loss": -0.018420880045353746, "vf_loss": 0.00017265866271145569, "vf_explained_var": 0.9962342385823528, "kl": 0.007108447934312016, "entropy": 0.23533166248040896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.483828125, "episode_reward_mean": 1.4888720209143969, "episode_len_mean": 15.67704280155642, "episode_media": {}, "episodes_this_iter": 257, "policy_reward_min": {"red_0": 1.483828125}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4888720209143969}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.484640625, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.483828125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48634375, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.4877500000000001, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.49015625, 1.48875, 1.4908593749999999, 1.48875, 1.4908593749999999, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4908593749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4849375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 16, 16, 17, 15, 15, 17, 17, 19, 16, 15, 17, 16, 15, 23, 16, 16, 15, 16, 15, 15, 15, 16, 16, 17, 16, 18, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 17, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 17, 16, 16, 16, 15, 15, 15, 16, 16, 18, 16, 16, 16, 15, 16, 15, 13, 16, 15, 15, 15, 17, 15, 16, 15, 16, 17, 15, 17, 17, 15, 15, 15, 17, 17, 16, 18, 15, 17, 16, 17, 16, 16, 15, 17, 15, 15, 18, 15, 15, 17, 16, 15, 16, 16, 17, 16, 16, 15, 17, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 16, 15, 16, 15, 15, 14, 16, 13, 16, 13, 15, 17, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 16, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 16, 17, 15, 15, 16, 13, 15, 15, 15, 16, 15, 17, 15, 18, 18, 15, 15, 16, 15, 15, 15, 16, 17, 20, 15, 15, 17, 15, 15, 17, 16, 15, 16, 15, 15, 15, 15, 15, 19, 15, 16, 15, 15, 15, 17, 15, 17, 15, 19, 16, 16, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 16, 17, 15, 15, 15, 17, 15, 19, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.484640625, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.483828125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48634375, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.4877500000000001, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.49015625, 1.48875, 1.4908593749999999, 1.48875, 1.4908593749999999, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4908593749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4849375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43434057331165843, "mean_inference_ms": 1.7311515123093928, "mean_action_processing_ms": 0.10423015233164794, "mean_env_wait_ms": 0.15580637695375243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062467404376672, "StateBufferConnector_ms": 0.008160130986907602, "ViewRequirementAgentConnector_ms": 0.11812100614555152}}, "episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.483828125, "episode_reward_mean": 1.4888720209143969, "episode_len_mean": 15.67704280155642, "episodes_this_iter": 257, "policy_reward_min": {"red_0": 1.483828125}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4888720209143969}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.484640625, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.483828125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48634375, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.4877500000000001, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.49015625, 1.48875, 1.4908593749999999, 1.48875, 1.4908593749999999, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4908593749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4849375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 16, 16, 17, 15, 15, 17, 17, 19, 16, 15, 17, 16, 15, 23, 16, 16, 15, 16, 15, 15, 15, 16, 16, 17, 16, 18, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 17, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 17, 16, 16, 16, 15, 15, 15, 16, 16, 18, 16, 16, 16, 15, 16, 15, 13, 16, 15, 15, 15, 17, 15, 16, 15, 16, 17, 15, 17, 17, 15, 15, 15, 17, 17, 16, 18, 15, 17, 16, 17, 16, 16, 15, 17, 15, 15, 18, 15, 15, 17, 16, 15, 16, 16, 17, 16, 16, 15, 17, 17, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 17, 15, 16, 15, 16, 15, 15, 14, 16, 13, 16, 13, 15, 17, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 19, 15, 15, 15, 15, 15, 15, 15, 15, 16, 16, 15, 16, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 15, 16, 17, 15, 15, 16, 13, 15, 15, 15, 16, 15, 17, 15, 18, 18, 15, 15, 16, 15, 15, 15, 16, 17, 20, 15, 15, 17, 15, 15, 17, 16, 15, 16, 15, 15, 15, 15, 15, 19, 15, 16, 15, 15, 15, 17, 15, 17, 15, 19, 16, 16, 15, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 16, 15, 16, 16, 17, 15, 15, 15, 17, 15, 19, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.484640625, 1.48875, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.483828125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.48875, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.4877500000000001, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.48534375, 1.48875, 1.48875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.4870468749999999, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.48634375, 1.489453125, 1.488046875, 1.48875, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48634375, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.4877500000000001, 1.4877500000000001, 1.488046875, 1.48875, 1.48875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.49015625, 1.48875, 1.4908593749999999, 1.48875, 1.4908593749999999, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.485640625, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.48875, 1.4908593749999999, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.48734375, 1.48734375, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.4849375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.488046875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4866406250000002, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.4877500000000001, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.4877500000000001, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.4866406250000002, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43434057331165843, "mean_inference_ms": 1.7311515123093928, "mean_action_processing_ms": 0.10423015233164794, "mean_env_wait_ms": 0.15580637695375243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1062467404376672, "StateBufferConnector_ms": 0.008160130986907602, "ViewRequirementAgentConnector_ms": 0.11812100614555152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.96626067687168, "num_env_steps_trained_throughput_per_sec": 235.96626067687168, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 17234.747, "sample_time_ms": 10196.873, "learn_time_ms": 6993.948, "learn_throughput": 571.923, "synch_weights_time_ms": 43.302}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2122, "training_iteration": 35, "trial_id": "2558d_00000", "date": "2023-09-10_14-05-55", "timestamp": 1694369155, "time_this_iter_s": 16.970675945281982, "time_total_s": 587.6376991271973, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c296820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 587.6376991271973, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.151851851851855, "ram_util_percent": 31.477777777777778}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7651122304610908, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014851520708301298, "policy_loss": -0.016863010926560187, "vf_loss": 8.330683592513802e-05, "vf_explained_var": 0.9982511411731442, "kl": 0.006427279255270636, "entropy": 0.18965209108622125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.485234375, "episode_reward_mean": 1.4891142805232558, "episode_len_mean": 15.39922480620155, "episode_media": {}, "episodes_this_iter": 258, "policy_reward_min": {"red_0": 1.485234375}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4891142805232558}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.485640625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 13, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 16, 15, 15, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 17, 15, 15, 15, 15, 16, 16, 15, 16, 15, 15, 17, 17, 16, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 17, 15, 15, 16, 16, 15, 16, 16, 15, 15, 18, 16, 15, 15, 16, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 16, 15, 15, 15, 17, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 13, 16, 17, 16, 15, 15, 15, 15, 17, 15, 17, 17, 15, 18, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 13, 15, 16, 15, 15, 15, 15, 15, 18, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 17, 18, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 16, 16, 17, 15, 15, 16, 15, 15, 21, 15, 15, 17, 15, 16, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 16, 16, 15, 15, 19, 16, 15, 15, 15, 15, 16, 15, 16, 15, 17, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.485640625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4364982161357631, "mean_inference_ms": 1.7345660667107867, "mean_action_processing_ms": 0.10437450758612384, "mean_env_wait_ms": 0.1563837483426993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10562340418497722, "StateBufferConnector_ms": 0.008545088213543559, "ViewRequirementAgentConnector_ms": 0.12166675671126491}}, "episode_reward_max": 1.4908593749999999, "episode_reward_min": 1.485234375, "episode_reward_mean": 1.4891142805232558, "episode_len_mean": 15.39922480620155, "episodes_this_iter": 258, "policy_reward_min": {"red_0": 1.485234375}, "policy_reward_max": {"red_0": 1.4908593749999999}, "policy_reward_mean": {"red_0": 1.4891142805232558}, "hist_stats": {"episode_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.485640625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125], "episode_lengths": [15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 15, 15, 13, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 18, 15, 15, 15, 16, 15, 15, 15, 15, 16, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 17, 17, 15, 15, 15, 15, 16, 16, 15, 16, 15, 15, 17, 17, 16, 15, 16, 15, 15, 15, 15, 16, 15, 15, 16, 15, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 17, 15, 15, 16, 16, 15, 16, 16, 15, 15, 18, 16, 15, 15, 16, 15, 15, 15, 15, 16, 15, 16, 15, 15, 15, 16, 15, 15, 15, 17, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 15, 16, 15, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 16, 15, 15, 15, 15, 15, 13, 16, 17, 16, 15, 15, 15, 15, 17, 15, 17, 17, 15, 18, 15, 16, 15, 15, 17, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 13, 15, 16, 15, 15, 15, 15, 15, 18, 16, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 17, 16, 15, 15, 17, 18, 15, 15, 15, 15, 15, 16, 15, 16, 16, 15, 16, 16, 17, 15, 15, 16, 15, 15, 21, 15, 15, 17, 15, 16, 15, 15, 15, 16, 15, 15, 15, 16, 15, 15, 16, 16, 15, 15, 19, 16, 15, 15, 15, 15, 16, 15, 16, 15, 17, 15, 15], "policy_red_0_reward": [1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.488046875, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4870468749999999, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.4877500000000001, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.488046875, 1.488046875, 1.489453125, 1.48634375, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4908593749999999, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48734375, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.488046875, 1.48875, 1.489453125, 1.489453125, 1.488046875, 1.48634375, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.48875, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.4877500000000001, 1.48875, 1.488046875, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.485234375, 1.489453125, 1.489453125, 1.488046875, 1.489453125, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.489453125, 1.48875, 1.48875, 1.489453125, 1.489453125, 1.485640625, 1.48875, 1.489453125, 1.489453125, 1.489453125, 1.489453125, 1.4877500000000001, 1.489453125, 1.48875, 1.489453125, 1.488046875, 1.489453125, 1.489453125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4364982161357631, "mean_inference_ms": 1.7345660667107867, "mean_action_processing_ms": 0.10437450758612384, "mean_env_wait_ms": 0.1563837483426993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10562340418497722, "StateBufferConnector_ms": 0.008545088213543559, "ViewRequirementAgentConnector_ms": 0.12166675671126491}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.4997969991282, "num_env_steps_trained_throughput_per_sec": 228.4997969991282, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 17309.731, "sample_time_ms": 10281.402, "learn_time_ms": 6984.296, "learn_throughput": 572.713, "synch_weights_time_ms": 43.403}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 2380, "training_iteration": 36, "trial_id": "2558d_00000", "date": "2023-09-10_14-06-15", "timestamp": 1694369175, "time_this_iter_s": 17.52009391784668, "time_total_s": 605.157793045044, "pid": 81381, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13c4174c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 605.157793045044, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 27.80714285714286, "ram_util_percent": 31.592857142857145}}
