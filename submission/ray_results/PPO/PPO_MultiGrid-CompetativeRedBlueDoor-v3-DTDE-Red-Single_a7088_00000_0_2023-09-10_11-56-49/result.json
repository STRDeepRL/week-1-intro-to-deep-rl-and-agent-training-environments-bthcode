{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5971507679050168, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00436221304277448, "policy_loss": -0.017863526192862387, "vf_loss": 0.01050569980967945, "vf_explained_var": 0.3250219601516922, "kl": 0.014978066715598768, "entropy": 1.9312775849054258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.75802031171048, "num_env_steps_trained_throughput_per_sec": 216.75802031171048, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 18453.636, "sample_time_ms": 9842.072, "learn_time_ms": 8557.661, "learn_throughput": 467.417, "synch_weights_time_ms": 53.092}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "a7088_00000", "date": "2023-09-10_11-57-10", "timestamp": 1694361430, "time_this_iter_s": 18.459462881088257, "time_total_s": 18.459462881088257, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353f5c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 18.459462881088257, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.542857142857144, "ram_util_percent": 28.77857142857143}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.766040621480594, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008866705858478478, "policy_loss": -0.018052638150038547, "vf_loss": 0.007049310924170034, "vf_explained_var": 0.15689438451081514, "kl": 0.010683108943672338, "entropy": 1.9190373085439205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 0.908703125, "episode_reward_min": 0.908703125, "episode_reward_mean": 0.908703125, "episode_len_mean": 703.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.908703125}, "policy_reward_max": {"red_0": 0.908703125}, "policy_reward_mean": {"red_0": 0.908703125}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125], "episode_lengths": [703], "policy_red_0_reward": [0.908703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169461730118845, "mean_inference_ms": 1.893860272849246, "mean_action_processing_ms": 0.11359231451179799, "mean_env_wait_ms": 0.16071942266304692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16722679138183594, "StateBufferConnector_ms": 0.007557868957519531, "ViewRequirementAgentConnector_ms": 0.11725425720214844}}, "episode_reward_max": 0.908703125, "episode_reward_min": 0.908703125, "episode_reward_mean": 0.908703125, "episode_len_mean": 703.0, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.908703125}, "policy_reward_max": {"red_0": 0.908703125}, "policy_reward_mean": {"red_0": 0.908703125}, "hist_stats": {"episode_reward": [0.908703125], "episode_lengths": [703], "policy_red_0_reward": [0.908703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169461730118845, "mean_inference_ms": 1.893860272849246, "mean_action_processing_ms": 0.11359231451179799, "mean_env_wait_ms": 0.16071942266304692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16722679138183594, "StateBufferConnector_ms": 0.007557868957519531, "ViewRequirementAgentConnector_ms": 0.11725425720214844}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.01153933229838, "num_env_steps_trained_throughput_per_sec": 233.01153933229838, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17810.074, "sample_time_ms": 9937.896, "learn_time_ms": 7823.578, "learn_throughput": 511.275, "synch_weights_time_ms": 47.88}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 1, "training_iteration": 2, "trial_id": "a7088_00000", "date": "2023-09-10_11-57-28", "timestamp": 1694361448, "time_this_iter_s": 17.172736883163452, "time_total_s": 35.63219976425171, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1351b3e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35.63219976425171, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.899999999999995, "ram_util_percent": 29.128}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7981288512858252, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012433496157367092, "policy_loss": -0.014880075745653205, "vf_loss": 0.0008066525211991878, "vf_explained_var": 0.6455247012898326, "kl": 0.008199634895382247, "entropy": 1.9022167691340048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 0.908703125, "episode_reward_min": 0.908703125, "episode_reward_mean": 0.908703125, "episode_len_mean": 703.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.908703125}, "policy_reward_max": {"red_0": 0.908703125}, "policy_reward_mean": {"red_0": 0.908703125}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125], "episode_lengths": [703], "policy_red_0_reward": [0.908703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169461730118845, "mean_inference_ms": 1.893860272849246, "mean_action_processing_ms": 0.11359231451179799, "mean_env_wait_ms": 0.16071942266304692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16722679138183594, "StateBufferConnector_ms": 0.007557868957519531, "ViewRequirementAgentConnector_ms": 0.11725425720214844}}, "episode_reward_max": 0.908703125, "episode_reward_min": 0.908703125, "episode_reward_mean": 0.908703125, "episode_len_mean": 703.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.908703125}, "policy_reward_max": {"red_0": 0.908703125}, "policy_reward_mean": {"red_0": 0.908703125}, "hist_stats": {"episode_reward": [0.908703125], "episode_lengths": [703], "policy_red_0_reward": [0.908703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4169461730118845, "mean_inference_ms": 1.893860272849246, "mean_action_processing_ms": 0.11359231451179799, "mean_env_wait_ms": 0.16071942266304692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16722679138183594, "StateBufferConnector_ms": 0.007557868957519531, "ViewRequirementAgentConnector_ms": 0.11725425720214844}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.40295292407046, "num_env_steps_trained_throughput_per_sec": 231.40295292407046, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17635.331, "sample_time_ms": 10132.55, "learn_time_ms": 7455.818, "learn_throughput": 536.494, "synch_weights_time_ms": 46.27}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 1, "training_iteration": 3, "trial_id": "a7088_00000", "date": "2023-09-10_11-57-46", "timestamp": 1694361466, "time_this_iter_s": 17.290530920028687, "time_total_s": 52.922730684280396, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1351fd9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 52.922730684280396, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.79615384615385, "ram_util_percent": 29.37307692307692}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.18181818181818182, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0095087371145686, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00829509946803834, "policy_loss": -0.016593639867399663, "vf_loss": 0.021975100628333168, "vf_explained_var": 0.2780283289651076, "kl": 0.014568190856478714, "entropy": 1.8613585660854974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.4691448863636362, "episode_len_mean": 1123.090909090909, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.4691448863636362}, "custom_metrics": {"red_0/door_open_done_mean": 0.18181818181818182, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4144809889391147, "mean_inference_ms": 1.84850538921971, "mean_action_processing_ms": 0.11151360676593175, "mean_env_wait_ms": 0.15508934155892798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11857856403697621, "StateBufferConnector_ms": 0.007915496826171875, "ViewRequirementAgentConnector_ms": 0.12245394966819069}}, "episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.4691448863636362, "episode_len_mean": 1123.090909090909, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.4691448863636362}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4144809889391147, "mean_inference_ms": 1.84850538921971, "mean_action_processing_ms": 0.11151360676593175, "mean_env_wait_ms": 0.15508934155892798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11857856403697621, "StateBufferConnector_ms": 0.007915496826171875, "ViewRequirementAgentConnector_ms": 0.12245394966819069}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.09915860126713, "num_env_steps_trained_throughput_per_sec": 214.09915860126713, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17897.223, "sample_time_ms": 10174.077, "learn_time_ms": 7677.075, "learn_throughput": 521.032, "synch_weights_time_ms": 45.379}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 11, "training_iteration": 4, "trial_id": "a7088_00000", "date": "2023-09-10_11-58-06", "timestamp": 1694361486, "time_this_iter_s": 18.688370943069458, "time_total_s": 71.61110162734985, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1347c75e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 71.61110162734985, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.932142857142857, "ram_util_percent": 29.66071428571428}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0147869043362638, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00897842103113362, "policy_loss": -0.01881955978945674, "vf_loss": 0.006628651538327783, "vf_explained_var": 0.19878977189461391, "kl": 0.01606243478111901, "entropy": 1.8645434871315956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.5177920673076921, "episode_len_mean": 1073.3076923076924, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.5177920673076921}, "custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149612722932511, "mean_inference_ms": 1.8525207659577587, "mean_action_processing_ms": 0.11195752825100265, "mean_env_wait_ms": 0.1556282340302758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11582741370567909, "StateBufferConnector_ms": 0.007739433875450721, "ViewRequirementAgentConnector_ms": 0.1233210930457482}}, "episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.5177920673076921, "episode_len_mean": 1073.3076923076924, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.5177920673076921}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149612722932511, "mean_inference_ms": 1.8525207659577587, "mean_action_processing_ms": 0.11195752825100265, "mean_env_wait_ms": 0.1556282340302758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11582741370567909, "StateBufferConnector_ms": 0.007739433875450721, "ViewRequirementAgentConnector_ms": 0.1233210930457482}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.45414984880134, "num_env_steps_trained_throughput_per_sec": 215.45414984880134, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 18030.861, "sample_time_ms": 10256.361, "learn_time_ms": 7729.148, "learn_throughput": 517.521, "synch_weights_time_ms": 44.674}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 13, "training_iteration": 5, "trial_id": "a7088_00000", "date": "2023-09-10_11-58-27", "timestamp": 1694361507, "time_this_iter_s": 18.570860147476196, "time_total_s": 90.18196177482605, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135287c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 90.18196177482605, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.5, "ram_util_percent": 29.809999999999995}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.057346555311233, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012156919220918402, "policy_loss": -0.016943183140150118, "vf_loss": 0.0020365498545743322, "vf_explained_var": -0.1569890491043528, "kl": 0.013748570839770007, "entropy": 1.8323138752331336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.5177920673076921, "episode_len_mean": 1073.3076923076924, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.5177920673076921}, "custom_metrics": {"red_0/door_open_done_mean": 0.23076923076923078, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149612722932511, "mean_inference_ms": 1.8525207659577587, "mean_action_processing_ms": 0.11195752825100265, "mean_env_wait_ms": 0.1556282340302758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11582741370567909, "StateBufferConnector_ms": 0.007739433875450721, "ViewRequirementAgentConnector_ms": 0.1233210930457482}}, "episode_reward_max": 1.389890625, "episode_reward_min": 0.3059999999999998, "episode_reward_mean": 0.5177920673076921, "episode_len_mean": 1073.3076923076924, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.3059999999999998}, "policy_reward_max": {"red_0": 1.389890625}, "policy_reward_mean": {"red_0": 0.5177920673076921}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4149612722932511, "mean_inference_ms": 1.8525207659577587, "mean_action_processing_ms": 0.11195752825100265, "mean_env_wait_ms": 0.1556282340302758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11582741370567909, "StateBufferConnector_ms": 0.007739433875450721, "ViewRequirementAgentConnector_ms": 0.1233210930457482}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.68253275323625, "num_env_steps_trained_throughput_per_sec": 222.68253275323625, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 18019.513, "sample_time_ms": 10324.08, "learn_time_ms": 7649.816, "learn_throughput": 522.888, "synch_weights_time_ms": 44.951}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 13, "training_iteration": 6, "trial_id": "a7088_00000", "date": "2023-09-10_11-58-47", "timestamp": 1694361527, "time_this_iter_s": 17.96798014640808, "time_total_s": 108.14994192123413, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13509ba60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 108.14994192123413, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 25.110344827586207, "ram_util_percent": 29.848275862068963}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.25, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3264800420651832, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00644017435315618, "policy_loss": -0.018509986826393286, "vf_loss": 0.02238072993059177, "vf_explained_var": 0.3869697667658329, "kl": 0.012847157752091895, "entropy": 1.785513630012671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 1.401953125, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.5449876302083333, "episode_len_mean": 1039.9583333333333, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.401953125}, "policy_reward_mean": {"red_0": 0.5449876302083333}, "custom_metrics": {"red_0/door_open_done_mean": 0.25, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183526619642593, "mean_inference_ms": 1.857734234649995, "mean_action_processing_ms": 0.11221486877943714, "mean_env_wait_ms": 0.15644620472131554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10870794455210368, "StateBufferConnector_ms": 0.0076452891031901045, "ViewRequirementAgentConnector_ms": 0.12071430683135986}}, "episode_reward_max": 1.401953125, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.5449876302083333, "episode_len_mean": 1039.9583333333333, "episodes_this_iter": 11, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.401953125}, "policy_reward_mean": {"red_0": 0.5449876302083333}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183526619642593, "mean_inference_ms": 1.857734234649995, "mean_action_processing_ms": 0.11221486877943714, "mean_env_wait_ms": 0.15644620472131554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10870794455210368, "StateBufferConnector_ms": 0.0076452891031901045, "ViewRequirementAgentConnector_ms": 0.12071430683135986}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.97889103265675, "num_env_steps_trained_throughput_per_sec": 227.97889103265675, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 17951.792, "sample_time_ms": 10301.693, "learn_time_ms": 7605.041, "learn_throughput": 525.967, "synch_weights_time_ms": 44.395}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 24, "training_iteration": 7, "trial_id": "a7088_00000", "date": "2023-09-10_11-59-07", "timestamp": 1694361547, "time_this_iter_s": 17.550559997558594, "time_total_s": 125.70050191879272, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13486fa60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 125.70050191879272, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 26.285714285714285, "ram_util_percent": 29.76071428571428}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2962962962962963, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2890615384404858, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0051801594559947265, "policy_loss": -0.015768062234080085, "vf_loss": 0.008225670848454077, "vf_explained_var": 0.4123801964645584, "kl": 0.011811158429608606, "entropy": 1.7775209339956441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 1.401953125, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.5745920138888888, "episode_len_mean": 1008.7777777777778, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.401953125}, "policy_reward_mean": {"red_0": 0.5745920138888888}, "custom_metrics": {"red_0/door_open_done_mean": 0.2962962962962963, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4190844549413015, "mean_inference_ms": 1.85954432794756, "mean_action_processing_ms": 0.112425214588261, "mean_env_wait_ms": 0.1567936166367433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10774047286422164, "StateBufferConnector_ms": 0.007567582307038484, "ViewRequirementAgentConnector_ms": 0.12005081883183231}}, "episode_reward_max": 1.401953125, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.5745920138888888, "episode_len_mean": 1008.7777777777778, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.401953125}, "policy_reward_mean": {"red_0": 0.5745920138888888}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4190844549413015, "mean_inference_ms": 1.85954432794756, "mean_action_processing_ms": 0.112425214588261, "mean_env_wait_ms": 0.1567936166367433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10774047286422164, "StateBufferConnector_ms": 0.007567582307038484, "ViewRequirementAgentConnector_ms": 0.12005081883183231}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.9661713670922, "num_env_steps_trained_throughput_per_sec": 224.9661713670922, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 17930.371, "sample_time_ms": 10352.149, "learn_time_ms": 7533.358, "learn_throughput": 530.972, "synch_weights_time_ms": 44.2}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 27, "training_iteration": 8, "trial_id": "a7088_00000", "date": "2023-09-10_11-59-27", "timestamp": 1694361567, "time_this_iter_s": 17.786970853805542, "time_total_s": 143.48747277259827, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1351fdc10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 143.48747277259827, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.817857142857147, "ram_util_percent": 29.785714285714285}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.5128205128205128, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.521674924530089, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.027442471349665234, "policy_loss": -0.019993978186782137, "vf_loss": 0.044908111356198786, "vf_explained_var": 0.4093145489071806, "kl": 0.01264168598302391, "entropy": 1.749515421440204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 1.4528124999999998, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.7790452724358975, "episode_len_mean": 793.7179487179487, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4528124999999998}, "policy_reward_mean": {"red_0": 0.7790452724358975}, "custom_metrics": {"red_0/door_open_done_mean": 0.5128205128205128, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42050809973295966, "mean_inference_ms": 1.8608047605295748, "mean_action_processing_ms": 0.11267998793685455, "mean_env_wait_ms": 0.1573309149676758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11355754656669421, "StateBufferConnector_ms": 0.0078042348225911455, "ViewRequirementAgentConnector_ms": 0.11958586863982372}}, "episode_reward_max": 1.4528124999999998, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.7790452724358975, "episode_len_mean": 793.7179487179487, "episodes_this_iter": 12, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4528124999999998}, "policy_reward_mean": {"red_0": 0.7790452724358975}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42050809973295966, "mean_inference_ms": 1.8608047605295748, "mean_action_processing_ms": 0.11267998793685455, "mean_env_wait_ms": 0.1573309149676758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11355754656669421, "StateBufferConnector_ms": 0.0078042348225911455, "ViewRequirementAgentConnector_ms": 0.11958586863982372}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.93137067467913, "num_env_steps_trained_throughput_per_sec": 217.93137067467913, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 17977.483, "sample_time_ms": 10339.903, "learn_time_ms": 7592.07, "learn_throughput": 526.866, "synch_weights_time_ms": 44.795}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 39, "training_iteration": 9, "trial_id": "a7088_00000", "date": "2023-09-10_11-59-47", "timestamp": 1694361587, "time_this_iter_s": 18.362486600875854, "time_total_s": 161.84995937347412, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353f59d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 161.84995937347412, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.49310344827586, "ram_util_percent": 29.741379310344833}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.6440677966101694, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6255545254175863, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04068403452086689, "policy_loss": -0.0246455683397168, "vf_loss": 0.06222815572982654, "vf_explained_var": 0.2768680609141787, "kl": 0.015507233545021457, "entropy": 1.6977582029998302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 1.4528124999999998, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.9069690148305083, "episode_len_mean": 659.1355932203389, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4528124999999998}, "policy_reward_mean": {"red_0": 0.9069690148305083}, "custom_metrics": {"red_0/door_open_done_mean": 0.6440677966101694, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42156972829460043, "mean_inference_ms": 1.8630738869603618, "mean_action_processing_ms": 0.11273922094121953, "mean_env_wait_ms": 0.1574263618339383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11435969401214083, "StateBufferConnector_ms": 0.00790903123758607, "ViewRequirementAgentConnector_ms": 0.12100712727692167}}, "episode_reward_max": 1.4528124999999998, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 0.9069690148305083, "episode_len_mean": 659.1355932203389, "episodes_this_iter": 20, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4528124999999998}, "policy_reward_mean": {"red_0": 0.9069690148305083}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42156972829460043, "mean_inference_ms": 1.8630738869603618, "mean_action_processing_ms": 0.11273922094121953, "mean_env_wait_ms": 0.1574263618339383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11435969401214083, "StateBufferConnector_ms": 0.00790903123758607, "ViewRequirementAgentConnector_ms": 0.12100712727692167}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.24689456962787, "num_env_steps_trained_throughput_per_sec": 217.24689456962787, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 18020.956, "sample_time_ms": 10355.789, "learn_time_ms": 7619.538, "learn_throughput": 524.966, "synch_weights_time_ms": 44.909}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 59, "training_iteration": 10, "trial_id": "a7088_00000", "date": "2023-09-10_12-00-08", "timestamp": 1694361608, "time_this_iter_s": 18.422302961349487, "time_total_s": 180.2722623348236, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13509bb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 180.2722623348236, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.086666666666666, "ram_util_percent": 29.809999999999995}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.7439024390243902, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6086625982696812, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04065981052905651, "policy_loss": -0.02170733573754357, "vf_loss": 0.05973467640578747, "vf_explained_var": 0.3643790200352669, "kl": 0.013162346445014047, "entropy": 1.6377496580282846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 1.0361903582317074, "episode_len_mean": 517.8170731707318, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.0361903582317074}, "custom_metrics": {"red_0/door_open_done_mean": 0.7439024390243902, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4226133144241762, "mean_inference_ms": 1.872914973239028, "mean_action_processing_ms": 0.11282836417317292, "mean_env_wait_ms": 0.15779173225152715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11244459850032155, "StateBufferConnector_ms": 0.00808500662082579, "ViewRequirementAgentConnector_ms": 0.12137977088369974}}, "episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 1.0361903582317074, "episode_len_mean": 517.8170731707318, "episodes_this_iter": 23, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.0361903582317074}, "hist_stats": {"episode_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998], "episode_lengths": [703, 1280, 1280, 131, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317], "policy_red_0_reward": [0.908703125, 0.30799999999999983, 0.3059999999999998, 1.389890625, 0.30799999999999983, 0.3059999999999998, 0.31499999999999984, 0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4226133144241762, "mean_inference_ms": 1.872914973239028, "mean_action_processing_ms": 0.11282836417317292, "mean_env_wait_ms": 0.15779173225152715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11244459850032155, "StateBufferConnector_ms": 0.00808500662082579, "ViewRequirementAgentConnector_ms": 0.12137977088369974}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.4076250697691, "num_env_steps_trained_throughput_per_sec": 222.4076250697691, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 17974.089, "sample_time_ms": 10392.145, "learn_time_ms": 7536.977, "learn_throughput": 530.717, "synch_weights_time_ms": 44.265}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 82, "training_iteration": 11, "trial_id": "a7088_00000", "date": "2023-09-10_12-00-28", "timestamp": 1694361628, "time_this_iter_s": 17.9947190284729, "time_total_s": 198.2669813632965, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13523b1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 198.2669813632965, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.15357142857143, "ram_util_percent": 29.89285714285714}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.84, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7355606734131774, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03195445419664793, "policy_loss": -0.020936679967174618, "vf_loss": 0.050255259689098844, "vf_explained_var": 0.5488004230583707, "kl": 0.013179372950179772, "entropy": 1.6149374568214019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 1.15833421875, "episode_len_mean": 384.25, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.15833421875}, "custom_metrics": {"red_0/door_open_done_mean": 0.84, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625], "episode_lengths": [1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317, 145, 118, 108, 85, 193, 37, 74, 420, 87, 132, 109, 108, 78, 138, 208, 73, 100, 65, 198, 36, 36, 90, 120, 165, 275], "policy_red_0_reward": [0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42403465037240023, "mean_inference_ms": 1.8763367178991488, "mean_action_processing_ms": 0.11292430464448727, "mean_env_wait_ms": 0.1581296190177407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11081767082214355, "StateBufferConnector_ms": 0.008208513259887695, "ViewRequirementAgentConnector_ms": 0.12246012687683105}}, "episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.2829999999999998, "episode_reward_mean": 1.15833421875, "episode_len_mean": 384.25, "episodes_this_iter": 25, "policy_reward_min": {"red_0": 0.2829999999999998}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.15833421875}, "hist_stats": {"episode_reward": [0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625], "episode_lengths": [1280, 1280, 1280, 1280, 319, 1280, 1280, 1280, 1280, 192, 1280, 1280, 1280, 1280, 1280, 463, 111, 1280, 414, 584, 336, 176, 713, 58, 504, 153, 1028, 309, 60, 100, 158, 123, 1280, 115, 142, 303, 127, 134, 89, 204, 131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317, 145, 118, 108, 85, 193, 37, 74, 420, 87, 132, 109, 108, 78, 138, 208, 73, 100, 65, 198, 36, 36, 90, 120, 165, 275], "policy_red_0_reward": [0.32099999999999984, 0.32499999999999984, 0.33599999999999985, 0.33699999999999986, 1.2387031249999998, 0.33199999999999985, 0.2829999999999998, 0.30799999999999983, 0.30999999999999983, 1.333, 0.31799999999999984, 0.31599999999999984, 0.3059999999999998, 0.32299999999999984, 0.33599999999999985, 1.113453125, 1.401953125, 0.3049999999999998, 1.1359062500000001, 0.9933749999999999, 1.21975, 1.35825, 0.9076718749999999, 1.44921875, 1.062625, 1.3804218750000001, 0.6241874999999999, 1.229734375, 1.4528124999999998, 1.4126875, 1.37090625, 1.4005156250000002, 0.31199999999999983, 1.403140625, 1.38015625, 1.2489531249999999, 1.394703125, 1.3827812499999999, 1.4274218749999998, 1.3195625, 1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42403465037240023, "mean_inference_ms": 1.8763367178991488, "mean_action_processing_ms": 0.11292430464448727, "mean_env_wait_ms": 0.1581296190177407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11081767082214355, "StateBufferConnector_ms": 0.008208513259887695, "ViewRequirementAgentConnector_ms": 0.12246012687683105}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.31240687398352, "num_env_steps_trained_throughput_per_sec": 219.31240687398352, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 18081.318, "sample_time_ms": 10460.146, "learn_time_ms": 7576.034, "learn_throughput": 527.981, "synch_weights_time_ms": 44.406}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 107, "training_iteration": 12, "trial_id": "a7088_00000", "date": "2023-09-10_12-00-48", "timestamp": 1694361648, "time_this_iter_s": 18.247368335723877, "time_total_s": 216.51434969902039, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13486fca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 216.51434969902039, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.82413793103448, "ram_util_percent": 30.09655172413794}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.99, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7221269634862741, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.026459159215543575, "policy_loss": -0.01689249552388598, "vf_loss": 0.04093267574013832, "vf_explained_var": 0.6860087231422464, "kl": 0.01209489508778402, "entropy": 1.5652293575306733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.31999999999999984, "episode_reward_mean": 1.361530625, "episode_len_mean": 161.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.31999999999999984}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.361530625}, "custom_metrics": {"red_0/door_open_done_mean": 0.99, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002], "episode_lengths": [131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317, 145, 118, 108, 85, 193, 37, 74, 420, 87, 132, 109, 108, 78, 138, 208, 73, 100, 65, 198, 36, 36, 90, 120, 165, 275, 49, 32, 79, 41, 51, 56, 96, 306, 69, 46, 88, 60, 58, 129, 76, 75, 504, 91, 77, 162, 47, 59, 60, 69, 46, 63, 156, 66, 48, 46, 51, 149, 91, 63, 44, 89, 373, 44, 49, 40], "policy_red_0_reward": [1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4262589772714172, "mean_inference_ms": 1.885270015087147, "mean_action_processing_ms": 0.11301751351105571, "mean_env_wait_ms": 0.15873418569806028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1101841926574707, "StateBufferConnector_ms": 0.00830698013305664, "ViewRequirementAgentConnector_ms": 0.12507271766662598}}, "episode_reward_max": 1.4776093750000001, "episode_reward_min": 0.31999999999999984, "episode_reward_mean": 1.361530625, "episode_len_mean": 161.08, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.31999999999999984}, "policy_reward_max": {"red_0": 1.4776093750000001}, "policy_reward_mean": {"red_0": 1.361530625}, "hist_stats": {"episode_reward": [1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002], "episode_lengths": [131, 247, 1112, 233, 347, 1280, 61, 379, 175, 131, 341, 1103, 100, 104, 87, 53, 36, 655, 46, 118, 204, 128, 164, 90, 116, 142, 275, 103, 178, 62, 104, 88, 29, 373, 317, 145, 118, 108, 85, 193, 37, 74, 420, 87, 132, 109, 108, 78, 138, 208, 73, 100, 65, 198, 36, 36, 90, 120, 165, 275, 49, 32, 79, 41, 51, 56, 96, 306, 69, 46, 88, 60, 58, 129, 76, 75, 504, 91, 77, 162, 47, 59, 60, 69, 46, 63, 156, 66, 48, 46, 51, 149, 91, 63, 44, 89, 373, 44, 49, 40], "policy_red_0_reward": [1.386890625, 1.295328125, 0.5621249999999999, 1.298171875, 1.210015625, 0.31999999999999984, 1.4471093750000001, 1.184515625, 1.351953125, 1.393890625, 1.216234375, 0.5934531249999999, 1.4156875, 1.411875, 1.4308281250000001, 1.456734375, 1.4716875, 0.9234531249999999, 1.46265625, 1.39503125, 1.3345625, 1.3900000000000001, 1.3576875, 1.42771875, 1.4014375000000001, 1.37715625, 1.265640625, 1.413578125, 1.34784375, 1.44740625, 1.411875, 1.4261249999999999, 1.4776093750000001, 1.185734375, 1.2241093749999998, 1.374046875, 1.39603125, 1.4090625, 1.426234375, 1.336296875, 1.4659843750000001, 1.43996875, 1.1386874999999999, 1.417828125, 1.3771875, 1.395359375, 1.4100625, 1.43215625, 1.37996875, 1.31375, 1.434671875, 1.4066874999999999, 1.442296875, 1.32078125, 1.4656875, 1.4686875000000001, 1.43271875, 1.400625, 1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4262589772714172, "mean_inference_ms": 1.885270015087147, "mean_action_processing_ms": 0.11301751351105571, "mean_env_wait_ms": 0.15873418569806028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1101841926574707, "StateBufferConnector_ms": 0.00830698013305664, "ViewRequirementAgentConnector_ms": 0.12507271766662598}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.679222934233, "num_env_steps_trained_throughput_per_sec": 217.679222934233, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 18190.298, "sample_time_ms": 10469.093, "learn_time_ms": 7674.742, "learn_throughput": 521.19, "synch_weights_time_ms": 45.71}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 147, "training_iteration": 13, "trial_id": "a7088_00000", "date": "2023-09-10_12-01-09", "timestamp": 1694361669, "time_this_iter_s": 18.385154247283936, "time_total_s": 234.89950394630432, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353f5700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 234.89950394630432, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.91724137931035, "ram_util_percent": 30.034482758620694}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8639247676357626, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.031096036373613363, "policy_loss": -0.02027460404545612, "vf_loss": 0.04911560762751226, "vf_explained_var": 0.6554779535159468, "kl": 0.011275166630445109, "entropy": 1.5178101072708765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1.4849375, "episode_reward_min": 0.3009999999999998, "episode_reward_mean": 1.4150592187500004, "episode_len_mean": 97.21, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {"red_0": 0.3009999999999998}, "policy_reward_max": {"red_0": 1.4849375}, "policy_reward_mean": {"red_0": 1.4150592187500004}, "custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002, 1.4526249999999998, 1.4388593749999998, 1.3994375, 1.465765625, 1.4849375, 1.46325, 1.4716875, 1.47209375, 1.4411874999999998, 1.4618437499999999, 1.455625, 1.460765625, 1.47490625, 1.4703906249999998, 1.3724218750000001, 1.4696875, 1.45603125, 1.4086875, 1.463171875, 1.4725000000000001, 1.476609375, 1.46325, 1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125], "episode_lengths": [165, 275, 49, 32, 79, 41, 51, 56, 96, 306, 69, 46, 88, 60, 58, 129, 76, 75, 504, 91, 77, 162, 47, 59, 60, 69, 46, 63, 156, 66, 48, 46, 51, 149, 91, 63, 44, 89, 373, 44, 49, 40, 56, 77, 116, 43, 20, 48, 36, 34, 68, 50, 56, 43, 30, 35, 153, 36, 54, 100, 41, 32, 29, 48, 52, 1280, 35, 32, 54, 37, 49, 60, 55, 39, 48, 38, 45, 36, 49, 38, 1280, 44, 56, 33, 52, 51, 56, 127, 108, 57, 82, 43, 40, 31, 44, 47, 54, 34, 32, 60], "policy_red_0_reward": [1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002, 1.4526249999999998, 1.4388593749999998, 1.3994375, 1.465765625, 1.4849375, 1.46325, 1.4716875, 1.47209375, 1.4411874999999998, 1.4618437499999999, 1.455625, 1.460765625, 1.47490625, 1.4703906249999998, 1.3724218750000001, 1.4696875, 1.45603125, 1.4086875, 1.463171875, 1.4725000000000001, 1.476609375, 1.46325, 1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296691602002063, "mean_inference_ms": 1.8855337760129425, "mean_action_processing_ms": 0.113793328792175, "mean_env_wait_ms": 0.16043371865012804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1109778881072998, "StateBufferConnector_ms": 0.00808095932006836, "ViewRequirementAgentConnector_ms": 0.12862610816955566}}, "episode_reward_max": 1.4849375, "episode_reward_min": 0.3009999999999998, "episode_reward_mean": 1.4150592187500004, "episode_len_mean": 97.21, "episodes_this_iter": 58, "policy_reward_min": {"red_0": 0.3009999999999998}, "policy_reward_max": {"red_0": 1.4849375}, "policy_reward_mean": {"red_0": 1.4150592187500004}, "hist_stats": {"episode_reward": [1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002, 1.4526249999999998, 1.4388593749999998, 1.3994375, 1.465765625, 1.4849375, 1.46325, 1.4716875, 1.47209375, 1.4411874999999998, 1.4618437499999999, 1.455625, 1.460765625, 1.47490625, 1.4703906249999998, 1.3724218750000001, 1.4696875, 1.45603125, 1.4086875, 1.463171875, 1.4725000000000001, 1.476609375, 1.46325, 1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125], "episode_lengths": [165, 275, 49, 32, 79, 41, 51, 56, 96, 306, 69, 46, 88, 60, 58, 129, 76, 75, 504, 91, 77, 162, 47, 59, 60, 69, 46, 63, 156, 66, 48, 46, 51, 149, 91, 63, 44, 89, 373, 44, 49, 40, 56, 77, 116, 43, 20, 48, 36, 34, 68, 50, 56, 43, 30, 35, 153, 36, 54, 100, 41, 32, 29, 48, 52, 1280, 35, 32, 54, 37, 49, 60, 55, 39, 48, 38, 45, 36, 49, 38, 1280, 44, 56, 33, 52, 51, 56, 127, 108, 57, 82, 43, 40, 31, 44, 47, 54, 34, 32, 60], "policy_red_0_reward": [1.355984375, 1.266640625, 1.456546875, 1.4735, 1.4364531249999999, 1.465171875, 1.454140625, 1.4526249999999998, 1.4224999999999999, 1.24784375, 1.433484375, 1.46065625, 1.425125, 1.4538125, 1.45121875, 1.3812968749999999, 1.4345625, 1.435265625, 1.060625, 1.421015625, 1.433859375, 1.36609375, 1.457953125, 1.448515625, 1.4478125, 1.435484375, 1.4576562499999999, 1.444703125, 1.3563125, 1.44959375, 1.45925, 1.46465625, 1.458140625, 1.371234375, 1.411015625, 1.444703125, 1.4610625000000002, 1.422421875, 1.1847343750000001, 1.4630625, 1.456546875, 1.4688750000000002, 1.4526249999999998, 1.4388593749999998, 1.3994375, 1.465765625, 1.4849375, 1.46325, 1.4716875, 1.47209375, 1.4411874999999998, 1.4618437499999999, 1.455625, 1.460765625, 1.47490625, 1.4703906249999998, 1.3724218750000001, 1.4696875, 1.45603125, 1.4086875, 1.463171875, 1.4725000000000001, 1.476609375, 1.46325, 1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4296691602002063, "mean_inference_ms": 1.8855337760129425, "mean_action_processing_ms": 0.113793328792175, "mean_env_wait_ms": 0.16043371865012804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1109778881072998, "StateBufferConnector_ms": 0.00808095932006836, "ViewRequirementAgentConnector_ms": 0.12862610816955566}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.03855146661186, "num_env_steps_trained_throughput_per_sec": 212.03855146661186, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 18208.455, "sample_time_ms": 10569.828, "learn_time_ms": 7592.318, "learn_throughput": 526.848, "synch_weights_time_ms": 45.568}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 205, "training_iteration": 14, "trial_id": "a7088_00000", "date": "2023-09-10_12-01-30", "timestamp": 1694361690, "time_this_iter_s": 18.873322248458862, "time_total_s": 253.77282619476318, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135deb5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 253.77282619476318, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.596666666666668, "ram_util_percent": 30.343333333333327}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8690848988170425, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.022948948580839592, "policy_loss": -0.02202635696400345, "vf_loss": 0.042289738279456895, "vf_explained_var": 0.7190688519428173, "kl": 0.013427838267071479, "entropy": 1.4690084187934795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1.485640625, "episode_reward_min": 0.3009999999999998, "episode_reward_mean": 1.43426828125, "episode_len_mean": 75.11, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {"red_0": 0.3009999999999998}, "policy_reward_max": {"red_0": 1.485640625}, "policy_reward_mean": {"red_0": 1.43426828125}, "custom_metrics": {"red_0/door_open_done_mean": 0.98, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125, 1.405765625, 1.438453125, 1.480421875, 1.4411874999999998, 1.44940625, 1.4356718750000002, 1.4780156249999998, 1.3271875, 1.45603125, 1.44740625, 1.482125, 1.472796875, 1.467984375, 1.468578125, 1.47590625, 1.482234375, 1.41125, 1.4623593750000001, 1.45625, 1.4773125, 1.466875, 1.4743906249999998, 1.46025, 1.471984375, 1.475609375, 1.4650625000000002, 1.450140625, 1.472609375, 1.4742031249999998, 1.473203125, 1.4793125, 1.47890625, 1.47971875, 1.47390625, 1.4355625, 1.460140625, 1.471796875, 1.4440781249999999, 1.456140625, 1.4432968750000001, 1.463875, 1.435484375, 1.4432968750000001, 1.476609375, 1.4725000000000001, 1.4255624999999998, 1.33621875, 1.465578125, 1.485640625, 1.479125, 1.46728125, 1.4438906249999999, 1.4736875, 1.481828125, 1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625], "episode_lengths": [52, 1280, 35, 32, 54, 37, 49, 60, 55, 39, 48, 38, 45, 36, 49, 38, 1280, 44, 56, 33, 52, 51, 56, 127, 108, 57, 82, 43, 40, 31, 44, 47, 54, 34, 32, 60, 107, 79, 25, 68, 62, 73, 27, 196, 54, 62, 24, 33, 37, 39, 30, 21, 112, 45, 48, 28, 40, 35, 48, 37, 29, 44, 51, 29, 31, 31, 28, 30, 26, 30, 76, 51, 33, 71, 51, 65, 40, 69, 65, 29, 32, 76, 186, 39, 19, 24, 38, 67, 36, 23, 35, 72, 52, 115, 50, 44, 22, 37, 27, 30], "policy_red_0_reward": [1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125, 1.405765625, 1.438453125, 1.480421875, 1.4411874999999998, 1.44940625, 1.4356718750000002, 1.4780156249999998, 1.3271875, 1.45603125, 1.44740625, 1.482125, 1.472796875, 1.467984375, 1.468578125, 1.47590625, 1.482234375, 1.41125, 1.4623593750000001, 1.45625, 1.4773125, 1.466875, 1.4743906249999998, 1.46025, 1.471984375, 1.475609375, 1.4650625000000002, 1.450140625, 1.472609375, 1.4742031249999998, 1.473203125, 1.4793125, 1.47890625, 1.47971875, 1.47390625, 1.4355625, 1.460140625, 1.471796875, 1.4440781249999999, 1.456140625, 1.4432968750000001, 1.463875, 1.435484375, 1.4432968750000001, 1.476609375, 1.4725000000000001, 1.4255624999999998, 1.33621875, 1.465578125, 1.485640625, 1.479125, 1.46728125, 1.4438906249999999, 1.4736875, 1.481828125, 1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.433065433208135, "mean_inference_ms": 1.8758596418275304, "mean_action_processing_ms": 0.11411549865647565, "mean_env_wait_ms": 0.16132143542775662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11203122138977051, "StateBufferConnector_ms": 0.008422613143920898, "ViewRequirementAgentConnector_ms": 0.13208246231079102}}, "episode_reward_max": 1.485640625, "episode_reward_min": 0.3009999999999998, "episode_reward_mean": 1.43426828125, "episode_len_mean": 75.11, "episodes_this_iter": 64, "policy_reward_min": {"red_0": 0.3009999999999998}, "policy_reward_max": {"red_0": 1.485640625}, "policy_reward_mean": {"red_0": 1.43426828125}, "hist_stats": {"episode_reward": [1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125, 1.405765625, 1.438453125, 1.480421875, 1.4411874999999998, 1.44940625, 1.4356718750000002, 1.4780156249999998, 1.3271875, 1.45603125, 1.44740625, 1.482125, 1.472796875, 1.467984375, 1.468578125, 1.47590625, 1.482234375, 1.41125, 1.4623593750000001, 1.45625, 1.4773125, 1.466875, 1.4743906249999998, 1.46025, 1.471984375, 1.475609375, 1.4650625000000002, 1.450140625, 1.472609375, 1.4742031249999998, 1.473203125, 1.4793125, 1.47890625, 1.47971875, 1.47390625, 1.4355625, 1.460140625, 1.471796875, 1.4440781249999999, 1.456140625, 1.4432968750000001, 1.463875, 1.435484375, 1.4432968750000001, 1.476609375, 1.4725000000000001, 1.4255624999999998, 1.33621875, 1.465578125, 1.485640625, 1.479125, 1.46728125, 1.4438906249999999, 1.4736875, 1.481828125, 1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625], "episode_lengths": [52, 1280, 35, 32, 54, 37, 49, 60, 55, 39, 48, 38, 45, 36, 49, 38, 1280, 44, 56, 33, 52, 51, 56, 127, 108, 57, 82, 43, 40, 31, 44, 47, 54, 34, 32, 60, 107, 79, 25, 68, 62, 73, 27, 196, 54, 62, 24, 33, 37, 39, 30, 21, 112, 45, 48, 28, 40, 35, 48, 37, 29, 44, 51, 29, 31, 31, 28, 30, 26, 30, 76, 51, 33, 71, 51, 65, 40, 69, 65, 29, 32, 76, 186, 39, 19, 24, 38, 67, 36, 23, 35, 72, 52, 115, 50, 44, 22, 37, 27, 30], "policy_red_0_reward": [1.4574375, 0.3009999999999998, 1.471390625, 1.4745, 1.4540312499999999, 1.470984375, 1.457546875, 1.4458125, 1.4553281249999999, 1.469578125, 1.45925, 1.46828125, 1.457359375, 1.4696875, 1.456546875, 1.46828125, 0.3009999999999998, 1.4680625, 1.454625, 1.474796875, 1.4534375, 1.457140625, 1.455625, 1.386703125, 1.4090625, 1.453921875, 1.4333437500000001, 1.461765625, 1.463875, 1.473203125, 1.4630625, 1.460953125, 1.4540312499999999, 1.47209375, 1.4735, 1.4508125, 1.405765625, 1.438453125, 1.480421875, 1.4411874999999998, 1.44940625, 1.4356718750000002, 1.4780156249999998, 1.3271875, 1.45603125, 1.44740625, 1.482125, 1.472796875, 1.467984375, 1.468578125, 1.47590625, 1.482234375, 1.41125, 1.4623593750000001, 1.45625, 1.4773125, 1.466875, 1.4743906249999998, 1.46025, 1.471984375, 1.475609375, 1.4650625000000002, 1.450140625, 1.472609375, 1.4742031249999998, 1.473203125, 1.4793125, 1.47890625, 1.47971875, 1.47390625, 1.4355625, 1.460140625, 1.471796875, 1.4440781249999999, 1.456140625, 1.4432968750000001, 1.463875, 1.435484375, 1.4432968750000001, 1.476609375, 1.4725000000000001, 1.4255624999999998, 1.33621875, 1.465578125, 1.485640625, 1.479125, 1.46728125, 1.4438906249999999, 1.4736875, 1.481828125, 1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.433065433208135, "mean_inference_ms": 1.8758596418275304, "mean_action_processing_ms": 0.11411549865647565, "mean_env_wait_ms": 0.16132143542775662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11203122138977051, "StateBufferConnector_ms": 0.008422613143920898, "ViewRequirementAgentConnector_ms": 0.13208246231079102}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.53208467290224, "num_env_steps_trained_throughput_per_sec": 209.53208467290224, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 18260.927, "sample_time_ms": 10633.605, "learn_time_ms": 7579.999, "learn_throughput": 527.705, "synch_weights_time_ms": 46.56}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 269, "training_iteration": 15, "trial_id": "a7088_00000", "date": "2023-09-10_12-01-51", "timestamp": 1694361711, "time_this_iter_s": 19.100820779800415, "time_total_s": 272.8736469745636, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1353f53a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 272.8736469745636, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.8, "ram_util_percent": 30.81290322580646}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8111390214413405, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01055881263782794, "policy_loss": -0.024281074440417192, "vf_loss": 0.031323258021924025, "vf_explained_var": 0.7499013967191179, "kl": 0.017583144871120265, "entropy": 1.3385616372028986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1.48634375, "episode_reward_min": 0.6847656249999998, "episode_reward_mean": 1.4586237499999997, "episode_len_mean": 49.36, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {"red_0": 0.6847656249999998}, "policy_reward_max": {"red_0": 1.48634375}, "policy_reward_mean": {"red_0": 1.4586237499999997}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625, 0.6847656249999998, 1.4745, 1.45121875, 1.48634375, 1.4782031249999998, 1.457328125, 1.4783125, 1.461953125, 1.4705781249999998, 1.483125, 1.480421875, 1.47771875, 1.47590625, 1.4667656249999999, 1.3934843749999999, 1.46646875, 1.481015625, 1.46328125, 1.4849375, 1.473203125, 1.467984375, 1.4819375, 1.4618437499999999, 1.453140625, 1.47490625, 1.4773125, 1.4780156249999998, 1.461953125, 1.47971875, 1.4654687499999999, 1.461140625, 1.47971875, 1.43978125, 1.47109375, 1.4591406249999999, 1.473203125, 1.475609375, 1.47109375, 1.4289375, 1.484234375, 1.479015625, 1.47490625, 1.4742031249999998, 1.484234375, 1.4753125, 1.474609375, 1.44359375, 1.475796875, 1.46325, 1.469578125, 1.471171875, 1.46746875, 1.464578125, 1.482125, 1.4769062499999999, 1.472390625, 1.470796875, 1.459734375, 1.464953125, 1.451921875, 1.4793125, 1.45503125, 1.45984375, 1.48353125, 1.4828281250000002, 1.4716875, 1.4654687499999999, 1.446296875, 1.452328125, 1.4773125, 1.2734843749999998, 1.4620625, 1.4716093749999999, 1.476609375, 1.47871875, 1.4648750000000001, 1.479015625, 1.465359375, 1.473390625, 1.47490625, 1.47971875, 1.477015625, 1.4832343749999999, 1.4706875, 1.482125, 1.4654687499999999, 1.466875, 1.468984375, 1.4688750000000002, 1.47871875], "episode_lengths": [35, 72, 52, 115, 50, 44, 22, 37, 27, 30, 875, 32, 58, 18, 31, 55, 28, 47, 39, 24, 25, 26, 30, 43, 133, 42, 27, 38, 20, 31, 37, 20, 50, 51, 30, 28, 27, 47, 26, 42, 51, 26, 70, 34, 51, 31, 29, 34, 84, 21, 27, 30, 31, 21, 28, 29, 66, 33, 48, 39, 41, 42, 39, 24, 30, 35, 33, 53, 47, 57, 28, 54, 50, 22, 23, 36, 42, 65, 55, 28, 261, 44, 29, 29, 26, 40, 27, 45, 35, 30, 26, 27, 21, 36, 24, 42, 40, 37, 40, 26], "policy_red_0_reward": [1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625, 0.6847656249999998, 1.4745, 1.45121875, 1.48634375, 1.4782031249999998, 1.457328125, 1.4783125, 1.461953125, 1.4705781249999998, 1.483125, 1.480421875, 1.47771875, 1.47590625, 1.4667656249999999, 1.3934843749999999, 1.46646875, 1.481015625, 1.46328125, 1.4849375, 1.473203125, 1.467984375, 1.4819375, 1.4618437499999999, 1.453140625, 1.47490625, 1.4773125, 1.4780156249999998, 1.461953125, 1.47971875, 1.4654687499999999, 1.461140625, 1.47971875, 1.43978125, 1.47109375, 1.4591406249999999, 1.473203125, 1.475609375, 1.47109375, 1.4289375, 1.484234375, 1.479015625, 1.47490625, 1.4742031249999998, 1.484234375, 1.4753125, 1.474609375, 1.44359375, 1.475796875, 1.46325, 1.469578125, 1.471171875, 1.46746875, 1.464578125, 1.482125, 1.4769062499999999, 1.472390625, 1.470796875, 1.459734375, 1.464953125, 1.451921875, 1.4793125, 1.45503125, 1.45984375, 1.48353125, 1.4828281250000002, 1.4716875, 1.4654687499999999, 1.446296875, 1.452328125, 1.4773125, 1.2734843749999998, 1.4620625, 1.4716093749999999, 1.476609375, 1.47871875, 1.4648750000000001, 1.479015625, 1.465359375, 1.473390625, 1.47490625, 1.47971875, 1.477015625, 1.4832343749999999, 1.4706875, 1.482125, 1.4654687499999999, 1.466875, 1.468984375, 1.4688750000000002, 1.47871875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43629300813979305, "mean_inference_ms": 1.9059474992495036, "mean_action_processing_ms": 0.11531137066764705, "mean_env_wait_ms": 0.16408240027786308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1084756851196289, "StateBufferConnector_ms": 0.00824594497680664, "ViewRequirementAgentConnector_ms": 0.13039135932922363}}, "episode_reward_max": 1.48634375, "episode_reward_min": 0.6847656249999998, "episode_reward_mean": 1.4586237499999997, "episode_len_mean": 49.36, "episodes_this_iter": 90, "policy_reward_min": {"red_0": 0.6847656249999998}, "policy_reward_max": {"red_0": 1.48634375}, "policy_reward_mean": {"red_0": 1.4586237499999997}, "hist_stats": {"episode_reward": [1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625, 0.6847656249999998, 1.4745, 1.45121875, 1.48634375, 1.4782031249999998, 1.457328125, 1.4783125, 1.461953125, 1.4705781249999998, 1.483125, 1.480421875, 1.47771875, 1.47590625, 1.4667656249999999, 1.3934843749999999, 1.46646875, 1.481015625, 1.46328125, 1.4849375, 1.473203125, 1.467984375, 1.4819375, 1.4618437499999999, 1.453140625, 1.47490625, 1.4773125, 1.4780156249999998, 1.461953125, 1.47971875, 1.4654687499999999, 1.461140625, 1.47971875, 1.43978125, 1.47109375, 1.4591406249999999, 1.473203125, 1.475609375, 1.47109375, 1.4289375, 1.484234375, 1.479015625, 1.47490625, 1.4742031249999998, 1.484234375, 1.4753125, 1.474609375, 1.44359375, 1.475796875, 1.46325, 1.469578125, 1.471171875, 1.46746875, 1.464578125, 1.482125, 1.4769062499999999, 1.472390625, 1.470796875, 1.459734375, 1.464953125, 1.451921875, 1.4793125, 1.45503125, 1.45984375, 1.48353125, 1.4828281250000002, 1.4716875, 1.4654687499999999, 1.446296875, 1.452328125, 1.4773125, 1.2734843749999998, 1.4620625, 1.4716093749999999, 1.476609375, 1.47871875, 1.4648750000000001, 1.479015625, 1.465359375, 1.473390625, 1.47490625, 1.47971875, 1.477015625, 1.4832343749999999, 1.4706875, 1.482125, 1.4654687499999999, 1.466875, 1.468984375, 1.4688750000000002, 1.47871875], "episode_lengths": [35, 72, 52, 115, 50, 44, 22, 37, 27, 30, 875, 32, 58, 18, 31, 55, 28, 47, 39, 24, 25, 26, 30, 43, 133, 42, 27, 38, 20, 31, 37, 20, 50, 51, 30, 28, 27, 47, 26, 42, 51, 26, 70, 34, 51, 31, 29, 34, 84, 21, 27, 30, 31, 21, 28, 29, 66, 33, 48, 39, 41, 42, 39, 24, 30, 35, 33, 53, 47, 57, 28, 54, 50, 22, 23, 36, 42, 65, 55, 28, 261, 44, 29, 29, 26, 40, 27, 45, 35, 30, 26, 27, 21, 36, 24, 42, 40, 37, 40, 26], "policy_red_0_reward": [1.471390625, 1.436375, 1.4584375, 1.405140625, 1.45984375, 1.4590625, 1.48153125, 1.4699843750000001, 1.4780156249999998, 1.47490625, 0.6847656249999998, 1.4745, 1.45121875, 1.48634375, 1.4782031249999998, 1.457328125, 1.4783125, 1.461953125, 1.4705781249999998, 1.483125, 1.480421875, 1.47771875, 1.47590625, 1.4667656249999999, 1.3934843749999999, 1.46646875, 1.481015625, 1.46328125, 1.4849375, 1.473203125, 1.467984375, 1.4819375, 1.4618437499999999, 1.453140625, 1.47490625, 1.4773125, 1.4780156249999998, 1.461953125, 1.47971875, 1.4654687499999999, 1.461140625, 1.47971875, 1.43978125, 1.47109375, 1.4591406249999999, 1.473203125, 1.475609375, 1.47109375, 1.4289375, 1.484234375, 1.479015625, 1.47490625, 1.4742031249999998, 1.484234375, 1.4753125, 1.474609375, 1.44359375, 1.475796875, 1.46325, 1.469578125, 1.471171875, 1.46746875, 1.464578125, 1.482125, 1.4769062499999999, 1.472390625, 1.470796875, 1.459734375, 1.464953125, 1.451921875, 1.4793125, 1.45503125, 1.45984375, 1.48353125, 1.4828281250000002, 1.4716875, 1.4654687499999999, 1.446296875, 1.452328125, 1.4773125, 1.2734843749999998, 1.4620625, 1.4716093749999999, 1.476609375, 1.47871875, 1.4648750000000001, 1.479015625, 1.465359375, 1.473390625, 1.47490625, 1.47971875, 1.477015625, 1.4832343749999999, 1.4706875, 1.482125, 1.4654687499999999, 1.466875, 1.468984375, 1.4688750000000002, 1.47871875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43629300813979305, "mean_inference_ms": 1.9059474992495036, "mean_action_processing_ms": 0.11531137066764705, "mean_env_wait_ms": 0.16408240027786308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1084756851196289, "StateBufferConnector_ms": 0.00824594497680664, "ViewRequirementAgentConnector_ms": 0.13039135932922363}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.99885144958287, "num_env_steps_trained_throughput_per_sec": 201.99885144958287, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 18444.857, "sample_time_ms": 10718.61, "learn_time_ms": 7678.278, "learn_throughput": 520.95, "synch_weights_time_ms": 47.195}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 359, "training_iteration": 16, "trial_id": "a7088_00000", "date": "2023-09-10_12-02-13", "timestamp": 1694361733, "time_this_iter_s": 19.81269884109497, "time_total_s": 292.68634581565857, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135deb280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 292.68634581565857, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.429032258064513, "ram_util_percent": 31.41290322580645}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.9907407407407407, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8156481943403682, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010761101589984416, "policy_loss": -0.028877867601113393, "vf_loss": 0.0359858728935554, "vf_explained_var": 0.6829099477579196, "kl": 0.018265480193805417, "entropy": 1.1972104058911404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1.48734375, "episode_reward_min": 0.34899999999999987, "episode_reward_mean": 1.462417679398148, "episode_len_mean": 45.00925925925926, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {"red_0": 0.34899999999999987}, "policy_reward_max": {"red_0": 1.48734375}, "policy_reward_mean": {"red_0": 1.462417679398148}, "custom_metrics": {"red_0/door_open_done_mean": 0.9907407407407407, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.471796875, 1.479015625, 1.4767187499999999, 1.4776093750000001, 1.4780156249999998, 1.4648750000000001, 1.4604374999999998, 1.479015625, 1.4780156249999998, 1.4453749999999999, 1.481421875, 1.4235, 1.47771875, 1.464953125, 1.46646875, 1.47971875, 1.468390625, 1.4849375, 1.472390625, 1.4726875000000001, 1.477015625, 1.47209375, 1.47771875, 1.4725000000000001, 1.4745, 1.468578125, 1.4742031249999998, 1.476203125, 1.4743125, 1.475609375, 1.457140625, 1.481828125, 1.460953125, 1.46328125, 1.481421875, 1.485234375, 1.454625, 1.4793125, 1.483125, 1.483828125, 1.4725000000000001, 1.4769062499999999, 1.481828125, 0.34899999999999987, 1.47771875, 1.479125, 1.4735, 1.481125, 1.481828125, 1.45925, 1.4801250000000001, 1.4696875, 1.4849375, 1.476203125, 1.481828125, 1.4665781249999998, 1.450328125, 1.4859375, 1.31390625, 1.482421875, 1.479828125, 1.4729062499999999, 1.474609375, 1.47009375, 1.482421875, 1.4829375, 1.475609375, 1.479015625, 1.47209375, 1.4807187499999999, 1.481828125, 1.4661718750000001, 1.4706875, 1.4699843750000001, 1.463953125, 1.480828125, 1.483125, 1.4839375000000001, 1.47590625, 1.4667656249999999, 1.4839375000000001, 1.473390625, 1.480421875, 1.4805312499999999, 1.477421875, 1.4805312499999999, 1.469390625, 1.4589531249999999, 1.4849375, 1.4776093750000001, 1.479015625, 1.479015625, 1.4773125, 1.480828125, 1.485640625, 1.479015625, 1.477421875, 1.4794218749999999, 1.48734375, 1.4849375, 1.4765000000000001, 1.4859375, 1.474609375, 1.4776093750000001, 1.470984375, 1.4627656249999998, 1.432046875, 1.4688750000000002], "episode_lengths": [33, 27, 26, 29, 27, 40, 52, 27, 27, 72, 25, 96, 26, 47, 42, 26, 35, 20, 35, 36, 27, 34, 26, 32, 32, 39, 31, 31, 28, 29, 51, 23, 47, 38, 25, 21, 56, 28, 24, 23, 32, 30, 23, 1280, 26, 24, 32, 24, 23, 48, 24, 36, 20, 31, 23, 39, 55, 20, 222, 25, 23, 30, 29, 34, 25, 20, 29, 27, 34, 26, 23, 41, 36, 37, 47, 23, 24, 20, 30, 43, 20, 35, 25, 22, 25, 22, 35, 47, 20, 29, 27, 27, 28, 23, 19, 27, 25, 25, 18, 20, 32, 20, 29, 29, 37, 43, 81, 40], "policy_red_0_reward": [1.471796875, 1.479015625, 1.4767187499999999, 1.4776093750000001, 1.4780156249999998, 1.4648750000000001, 1.4604374999999998, 1.479015625, 1.4780156249999998, 1.4453749999999999, 1.481421875, 1.4235, 1.47771875, 1.464953125, 1.46646875, 1.47971875, 1.468390625, 1.4849375, 1.472390625, 1.4726875000000001, 1.477015625, 1.47209375, 1.47771875, 1.4725000000000001, 1.4745, 1.468578125, 1.4742031249999998, 1.476203125, 1.4743125, 1.475609375, 1.457140625, 1.481828125, 1.460953125, 1.46328125, 1.481421875, 1.485234375, 1.454625, 1.4793125, 1.483125, 1.483828125, 1.4725000000000001, 1.4769062499999999, 1.481828125, 0.34899999999999987, 1.47771875, 1.479125, 1.4735, 1.481125, 1.481828125, 1.45925, 1.4801250000000001, 1.4696875, 1.4849375, 1.476203125, 1.481828125, 1.4665781249999998, 1.450328125, 1.4859375, 1.31390625, 1.482421875, 1.479828125, 1.4729062499999999, 1.474609375, 1.47009375, 1.482421875, 1.4829375, 1.475609375, 1.479015625, 1.47209375, 1.4807187499999999, 1.481828125, 1.4661718750000001, 1.4706875, 1.4699843750000001, 1.463953125, 1.480828125, 1.483125, 1.4839375000000001, 1.47590625, 1.4667656249999999, 1.4839375000000001, 1.473390625, 1.480421875, 1.4805312499999999, 1.477421875, 1.4805312499999999, 1.469390625, 1.4589531249999999, 1.4849375, 1.4776093750000001, 1.479015625, 1.479015625, 1.4773125, 1.480828125, 1.485640625, 1.479015625, 1.477421875, 1.4794218749999999, 1.48734375, 1.4849375, 1.4765000000000001, 1.4859375, 1.474609375, 1.4776093750000001, 1.470984375, 1.4627656249999998, 1.432046875, 1.4688750000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43808992097020294, "mean_inference_ms": 1.913681518959659, "mean_action_processing_ms": 0.11524736027243236, "mean_env_wait_ms": 0.16409347816469402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10508387177078812, "StateBufferConnector_ms": 0.00795567477190936, "ViewRequirementAgentConnector_ms": 0.12685325410630968}}, "episode_reward_max": 1.48734375, "episode_reward_min": 0.34899999999999987, "episode_reward_mean": 1.462417679398148, "episode_len_mean": 45.00925925925926, "episodes_this_iter": 108, "policy_reward_min": {"red_0": 0.34899999999999987}, "policy_reward_max": {"red_0": 1.48734375}, "policy_reward_mean": {"red_0": 1.462417679398148}, "hist_stats": {"episode_reward": [1.471796875, 1.479015625, 1.4767187499999999, 1.4776093750000001, 1.4780156249999998, 1.4648750000000001, 1.4604374999999998, 1.479015625, 1.4780156249999998, 1.4453749999999999, 1.481421875, 1.4235, 1.47771875, 1.464953125, 1.46646875, 1.47971875, 1.468390625, 1.4849375, 1.472390625, 1.4726875000000001, 1.477015625, 1.47209375, 1.47771875, 1.4725000000000001, 1.4745, 1.468578125, 1.4742031249999998, 1.476203125, 1.4743125, 1.475609375, 1.457140625, 1.481828125, 1.460953125, 1.46328125, 1.481421875, 1.485234375, 1.454625, 1.4793125, 1.483125, 1.483828125, 1.4725000000000001, 1.4769062499999999, 1.481828125, 0.34899999999999987, 1.47771875, 1.479125, 1.4735, 1.481125, 1.481828125, 1.45925, 1.4801250000000001, 1.4696875, 1.4849375, 1.476203125, 1.481828125, 1.4665781249999998, 1.450328125, 1.4859375, 1.31390625, 1.482421875, 1.479828125, 1.4729062499999999, 1.474609375, 1.47009375, 1.482421875, 1.4829375, 1.475609375, 1.479015625, 1.47209375, 1.4807187499999999, 1.481828125, 1.4661718750000001, 1.4706875, 1.4699843750000001, 1.463953125, 1.480828125, 1.483125, 1.4839375000000001, 1.47590625, 1.4667656249999999, 1.4839375000000001, 1.473390625, 1.480421875, 1.4805312499999999, 1.477421875, 1.4805312499999999, 1.469390625, 1.4589531249999999, 1.4849375, 1.4776093750000001, 1.479015625, 1.479015625, 1.4773125, 1.480828125, 1.485640625, 1.479015625, 1.477421875, 1.4794218749999999, 1.48734375, 1.4849375, 1.4765000000000001, 1.4859375, 1.474609375, 1.4776093750000001, 1.470984375, 1.4627656249999998, 1.432046875, 1.4688750000000002], "episode_lengths": [33, 27, 26, 29, 27, 40, 52, 27, 27, 72, 25, 96, 26, 47, 42, 26, 35, 20, 35, 36, 27, 34, 26, 32, 32, 39, 31, 31, 28, 29, 51, 23, 47, 38, 25, 21, 56, 28, 24, 23, 32, 30, 23, 1280, 26, 24, 32, 24, 23, 48, 24, 36, 20, 31, 23, 39, 55, 20, 222, 25, 23, 30, 29, 34, 25, 20, 29, 27, 34, 26, 23, 41, 36, 37, 47, 23, 24, 20, 30, 43, 20, 35, 25, 22, 25, 22, 35, 47, 20, 29, 27, 27, 28, 23, 19, 27, 25, 25, 18, 20, 32, 20, 29, 29, 37, 43, 81, 40], "policy_red_0_reward": [1.471796875, 1.479015625, 1.4767187499999999, 1.4776093750000001, 1.4780156249999998, 1.4648750000000001, 1.4604374999999998, 1.479015625, 1.4780156249999998, 1.4453749999999999, 1.481421875, 1.4235, 1.47771875, 1.464953125, 1.46646875, 1.47971875, 1.468390625, 1.4849375, 1.472390625, 1.4726875000000001, 1.477015625, 1.47209375, 1.47771875, 1.4725000000000001, 1.4745, 1.468578125, 1.4742031249999998, 1.476203125, 1.4743125, 1.475609375, 1.457140625, 1.481828125, 1.460953125, 1.46328125, 1.481421875, 1.485234375, 1.454625, 1.4793125, 1.483125, 1.483828125, 1.4725000000000001, 1.4769062499999999, 1.481828125, 0.34899999999999987, 1.47771875, 1.479125, 1.4735, 1.481125, 1.481828125, 1.45925, 1.4801250000000001, 1.4696875, 1.4849375, 1.476203125, 1.481828125, 1.4665781249999998, 1.450328125, 1.4859375, 1.31390625, 1.482421875, 1.479828125, 1.4729062499999999, 1.474609375, 1.47009375, 1.482421875, 1.4829375, 1.475609375, 1.479015625, 1.47209375, 1.4807187499999999, 1.481828125, 1.4661718750000001, 1.4706875, 1.4699843750000001, 1.463953125, 1.480828125, 1.483125, 1.4839375000000001, 1.47590625, 1.4667656249999999, 1.4839375000000001, 1.473390625, 1.480421875, 1.4805312499999999, 1.477421875, 1.4805312499999999, 1.469390625, 1.4589531249999999, 1.4849375, 1.4776093750000001, 1.479015625, 1.479015625, 1.4773125, 1.480828125, 1.485640625, 1.479015625, 1.477421875, 1.4794218749999999, 1.48734375, 1.4849375, 1.4765000000000001, 1.4859375, 1.474609375, 1.4776093750000001, 1.470984375, 1.4627656249999998, 1.432046875, 1.4688750000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.43808992097020294, "mean_inference_ms": 1.913681518959659, "mean_action_processing_ms": 0.11524736027243236, "mean_env_wait_ms": 0.16409347816469402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10508387177078812, "StateBufferConnector_ms": 0.00795567477190936, "ViewRequirementAgentConnector_ms": 0.12685325410630968}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.72840467706783, "num_env_steps_trained_throughput_per_sec": 219.72840467706783, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 18510.737, "sample_time_ms": 10822.823, "learn_time_ms": 7639.942, "learn_throughput": 523.564, "synch_weights_time_ms": 47.208}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 467, "training_iteration": 17, "trial_id": "a7088_00000", "date": "2023-09-10_12-02-34", "timestamp": 1694361754, "time_this_iter_s": 18.21451997756958, "time_total_s": 310.90086579322815, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13523b1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 310.90086579322815, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.810344827586206, "ram_util_percent": 31.39655172413793}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6285194841523964, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.002995734959404217, "policy_loss": -0.021199567250247735, "vf_loss": 0.015156217849774596, "vf_explained_var": 0.7848446482792497, "kl": 0.015238070725922625, "entropy": 1.026545686647296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 1.1142656249999998, "episode_reward_mean": 1.4764311655405407, "episode_len_mean": 29.81081081081081, "episode_media": {}, "episodes_this_iter": 148, "policy_reward_min": {"red_0": 1.1142656249999998}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4764311655405407}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4755, 1.476609375, 1.4849375, 1.48534375, 1.482125, 1.47971875, 1.4828281250000002, 1.485234375, 1.477421875, 1.4866406250000002, 1.481828125, 1.4765000000000001, 1.4769062499999999, 1.4783125, 1.4769062499999999, 1.484234375, 1.417390625, 1.4828281250000002, 1.471984375, 1.4743906249999998, 1.4660625, 1.475609375, 1.476015625, 1.475203125, 1.483828125, 1.4753125, 1.47490625, 1.48534375, 1.48253125, 1.4877500000000001, 1.48153125, 1.48153125, 1.48253125, 1.475609375, 1.4859375, 1.4866406250000002, 1.4849375, 1.47490625, 1.488046875, 1.4870468749999999, 1.482234375, 1.483125, 1.483828125, 1.484234375, 1.482234375, 1.478421875, 1.4654687499999999, 1.4773125, 1.473390625, 1.48353125, 1.472390625, 1.465390625, 1.4859375, 1.4765000000000001, 1.478609375, 1.3485468749999998, 1.4769062499999999, 1.488046875, 1.4828281250000002, 1.481125, 1.48734375, 1.47790625, 1.480015625, 1.4801250000000001, 1.4828281250000002, 1.475203125, 1.4866406250000002, 1.4866406250000002, 1.477421875, 1.4839375000000001, 1.4807187499999999, 1.48634375, 1.47890625, 1.4703906249999998, 1.4832343749999999, 1.47590625, 1.4828281250000002, 1.4809375, 1.4839375000000001, 1.4688750000000002, 1.481421875, 1.47771875, 1.484234375, 1.4828281250000002, 1.484234375, 1.4793125, 1.47871875, 1.4839375000000001, 1.483828125, 1.48734375, 1.4661718750000001, 1.483640625, 1.48253125, 1.475203125, 1.4849375, 1.477015625, 1.4832343749999999, 1.48634375, 1.468984375, 1.4801250000000001, 1.4828281250000002, 1.4780156249999998, 1.482421875, 1.4767187499999999, 1.475796875, 1.485234375, 1.4832343749999999, 1.484234375, 1.472796875, 1.476609375, 1.471796875, 1.482125, 1.47509375, 1.471984375, 1.481421875, 1.480828125, 1.48171875, 1.485640625, 1.485234375, 1.4849375, 1.4849375, 1.4828281250000002, 1.4828281250000002, 1.4832343749999999, 1.4794218749999999, 1.4578437499999999, 1.4783125, 1.482125, 1.480421875, 1.482125, 1.48634375, 1.47609375, 1.481828125, 1.479609375, 1.481015625, 1.48534375, 1.481421875, 1.4828281250000002, 1.1142656249999998, 1.48734375, 1.472796875, 1.4866406250000002, 1.47871875, 1.484640625, 1.481125, 1.479015625, 1.485640625, 1.4735], "episode_lengths": [32, 29, 20, 18, 24, 26, 23, 21, 25, 19, 23, 32, 30, 28, 30, 21, 99, 23, 37, 35, 44, 29, 27, 31, 23, 28, 30, 18, 22, 16, 22, 22, 22, 29, 20, 19, 20, 30, 17, 17, 21, 24, 23, 21, 21, 25, 42, 28, 35, 22, 35, 35, 20, 32, 29, 177, 30, 17, 23, 24, 18, 30, 27, 24, 23, 31, 19, 19, 25, 20, 26, 18, 30, 35, 21, 30, 23, 20, 20, 40, 25, 26, 21, 23, 21, 28, 26, 20, 23, 18, 41, 19, 22, 31, 20, 27, 21, 18, 37, 24, 23, 27, 25, 26, 33, 21, 21, 21, 33, 29, 33, 24, 34, 37, 25, 23, 26, 19, 21, 20, 20, 23, 23, 21, 25, 50, 28, 24, 25, 24, 18, 34, 23, 29, 27, 18, 25, 23, 459, 18, 33, 19, 26, 19, 24, 27, 19, 32], "policy_red_0_reward": [1.4755, 1.476609375, 1.4849375, 1.48534375, 1.482125, 1.47971875, 1.4828281250000002, 1.485234375, 1.477421875, 1.4866406250000002, 1.481828125, 1.4765000000000001, 1.4769062499999999, 1.4783125, 1.4769062499999999, 1.484234375, 1.417390625, 1.4828281250000002, 1.471984375, 1.4743906249999998, 1.4660625, 1.475609375, 1.476015625, 1.475203125, 1.483828125, 1.4753125, 1.47490625, 1.48534375, 1.48253125, 1.4877500000000001, 1.48153125, 1.48153125, 1.48253125, 1.475609375, 1.4859375, 1.4866406250000002, 1.4849375, 1.47490625, 1.488046875, 1.4870468749999999, 1.482234375, 1.483125, 1.483828125, 1.484234375, 1.482234375, 1.478421875, 1.4654687499999999, 1.4773125, 1.473390625, 1.48353125, 1.472390625, 1.465390625, 1.4859375, 1.4765000000000001, 1.478609375, 1.3485468749999998, 1.4769062499999999, 1.488046875, 1.4828281250000002, 1.481125, 1.48734375, 1.47790625, 1.480015625, 1.4801250000000001, 1.4828281250000002, 1.475203125, 1.4866406250000002, 1.4866406250000002, 1.477421875, 1.4839375000000001, 1.4807187499999999, 1.48634375, 1.47890625, 1.4703906249999998, 1.4832343749999999, 1.47590625, 1.4828281250000002, 1.4809375, 1.4839375000000001, 1.4688750000000002, 1.481421875, 1.47771875, 1.484234375, 1.4828281250000002, 1.484234375, 1.4793125, 1.47871875, 1.4839375000000001, 1.483828125, 1.48734375, 1.4661718750000001, 1.483640625, 1.48253125, 1.475203125, 1.4849375, 1.477015625, 1.4832343749999999, 1.48634375, 1.468984375, 1.4801250000000001, 1.4828281250000002, 1.4780156249999998, 1.482421875, 1.4767187499999999, 1.475796875, 1.485234375, 1.4832343749999999, 1.484234375, 1.472796875, 1.476609375, 1.471796875, 1.482125, 1.47509375, 1.471984375, 1.481421875, 1.480828125, 1.48171875, 1.485640625, 1.485234375, 1.4849375, 1.4849375, 1.4828281250000002, 1.4828281250000002, 1.4832343749999999, 1.4794218749999999, 1.4578437499999999, 1.4783125, 1.482125, 1.480421875, 1.482125, 1.48634375, 1.47609375, 1.481828125, 1.479609375, 1.481015625, 1.48534375, 1.481421875, 1.4828281250000002, 1.1142656249999998, 1.48734375, 1.472796875, 1.4866406250000002, 1.47871875, 1.484640625, 1.481125, 1.479015625, 1.485640625, 1.4735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44031863772093316, "mean_inference_ms": 1.9138046457837308, "mean_action_processing_ms": 0.11517996460280674, "mean_env_wait_ms": 0.16439437889476785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11018192445909655, "StateBufferConnector_ms": 0.008520242330190298, "ViewRequirementAgentConnector_ms": 0.12416710724701753}}, "episode_reward_max": 1.488046875, "episode_reward_min": 1.1142656249999998, "episode_reward_mean": 1.4764311655405407, "episode_len_mean": 29.81081081081081, "episodes_this_iter": 148, "policy_reward_min": {"red_0": 1.1142656249999998}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4764311655405407}, "hist_stats": {"episode_reward": [1.4755, 1.476609375, 1.4849375, 1.48534375, 1.482125, 1.47971875, 1.4828281250000002, 1.485234375, 1.477421875, 1.4866406250000002, 1.481828125, 1.4765000000000001, 1.4769062499999999, 1.4783125, 1.4769062499999999, 1.484234375, 1.417390625, 1.4828281250000002, 1.471984375, 1.4743906249999998, 1.4660625, 1.475609375, 1.476015625, 1.475203125, 1.483828125, 1.4753125, 1.47490625, 1.48534375, 1.48253125, 1.4877500000000001, 1.48153125, 1.48153125, 1.48253125, 1.475609375, 1.4859375, 1.4866406250000002, 1.4849375, 1.47490625, 1.488046875, 1.4870468749999999, 1.482234375, 1.483125, 1.483828125, 1.484234375, 1.482234375, 1.478421875, 1.4654687499999999, 1.4773125, 1.473390625, 1.48353125, 1.472390625, 1.465390625, 1.4859375, 1.4765000000000001, 1.478609375, 1.3485468749999998, 1.4769062499999999, 1.488046875, 1.4828281250000002, 1.481125, 1.48734375, 1.47790625, 1.480015625, 1.4801250000000001, 1.4828281250000002, 1.475203125, 1.4866406250000002, 1.4866406250000002, 1.477421875, 1.4839375000000001, 1.4807187499999999, 1.48634375, 1.47890625, 1.4703906249999998, 1.4832343749999999, 1.47590625, 1.4828281250000002, 1.4809375, 1.4839375000000001, 1.4688750000000002, 1.481421875, 1.47771875, 1.484234375, 1.4828281250000002, 1.484234375, 1.4793125, 1.47871875, 1.4839375000000001, 1.483828125, 1.48734375, 1.4661718750000001, 1.483640625, 1.48253125, 1.475203125, 1.4849375, 1.477015625, 1.4832343749999999, 1.48634375, 1.468984375, 1.4801250000000001, 1.4828281250000002, 1.4780156249999998, 1.482421875, 1.4767187499999999, 1.475796875, 1.485234375, 1.4832343749999999, 1.484234375, 1.472796875, 1.476609375, 1.471796875, 1.482125, 1.47509375, 1.471984375, 1.481421875, 1.480828125, 1.48171875, 1.485640625, 1.485234375, 1.4849375, 1.4849375, 1.4828281250000002, 1.4828281250000002, 1.4832343749999999, 1.4794218749999999, 1.4578437499999999, 1.4783125, 1.482125, 1.480421875, 1.482125, 1.48634375, 1.47609375, 1.481828125, 1.479609375, 1.481015625, 1.48534375, 1.481421875, 1.4828281250000002, 1.1142656249999998, 1.48734375, 1.472796875, 1.4866406250000002, 1.47871875, 1.484640625, 1.481125, 1.479015625, 1.485640625, 1.4735], "episode_lengths": [32, 29, 20, 18, 24, 26, 23, 21, 25, 19, 23, 32, 30, 28, 30, 21, 99, 23, 37, 35, 44, 29, 27, 31, 23, 28, 30, 18, 22, 16, 22, 22, 22, 29, 20, 19, 20, 30, 17, 17, 21, 24, 23, 21, 21, 25, 42, 28, 35, 22, 35, 35, 20, 32, 29, 177, 30, 17, 23, 24, 18, 30, 27, 24, 23, 31, 19, 19, 25, 20, 26, 18, 30, 35, 21, 30, 23, 20, 20, 40, 25, 26, 21, 23, 21, 28, 26, 20, 23, 18, 41, 19, 22, 31, 20, 27, 21, 18, 37, 24, 23, 27, 25, 26, 33, 21, 21, 21, 33, 29, 33, 24, 34, 37, 25, 23, 26, 19, 21, 20, 20, 23, 23, 21, 25, 50, 28, 24, 25, 24, 18, 34, 23, 29, 27, 18, 25, 23, 459, 18, 33, 19, 26, 19, 24, 27, 19, 32], "policy_red_0_reward": [1.4755, 1.476609375, 1.4849375, 1.48534375, 1.482125, 1.47971875, 1.4828281250000002, 1.485234375, 1.477421875, 1.4866406250000002, 1.481828125, 1.4765000000000001, 1.4769062499999999, 1.4783125, 1.4769062499999999, 1.484234375, 1.417390625, 1.4828281250000002, 1.471984375, 1.4743906249999998, 1.4660625, 1.475609375, 1.476015625, 1.475203125, 1.483828125, 1.4753125, 1.47490625, 1.48534375, 1.48253125, 1.4877500000000001, 1.48153125, 1.48153125, 1.48253125, 1.475609375, 1.4859375, 1.4866406250000002, 1.4849375, 1.47490625, 1.488046875, 1.4870468749999999, 1.482234375, 1.483125, 1.483828125, 1.484234375, 1.482234375, 1.478421875, 1.4654687499999999, 1.4773125, 1.473390625, 1.48353125, 1.472390625, 1.465390625, 1.4859375, 1.4765000000000001, 1.478609375, 1.3485468749999998, 1.4769062499999999, 1.488046875, 1.4828281250000002, 1.481125, 1.48734375, 1.47790625, 1.480015625, 1.4801250000000001, 1.4828281250000002, 1.475203125, 1.4866406250000002, 1.4866406250000002, 1.477421875, 1.4839375000000001, 1.4807187499999999, 1.48634375, 1.47890625, 1.4703906249999998, 1.4832343749999999, 1.47590625, 1.4828281250000002, 1.4809375, 1.4839375000000001, 1.4688750000000002, 1.481421875, 1.47771875, 1.484234375, 1.4828281250000002, 1.484234375, 1.4793125, 1.47871875, 1.4839375000000001, 1.483828125, 1.48734375, 1.4661718750000001, 1.483640625, 1.48253125, 1.475203125, 1.4849375, 1.477015625, 1.4832343749999999, 1.48634375, 1.468984375, 1.4801250000000001, 1.4828281250000002, 1.4780156249999998, 1.482421875, 1.4767187499999999, 1.475796875, 1.485234375, 1.4832343749999999, 1.484234375, 1.472796875, 1.476609375, 1.471796875, 1.482125, 1.47509375, 1.471984375, 1.481421875, 1.480828125, 1.48171875, 1.485640625, 1.485234375, 1.4849375, 1.4849375, 1.4828281250000002, 1.4828281250000002, 1.4832343749999999, 1.4794218749999999, 1.4578437499999999, 1.4783125, 1.482125, 1.480421875, 1.482125, 1.48634375, 1.47609375, 1.481828125, 1.479609375, 1.481015625, 1.48534375, 1.481421875, 1.4828281250000002, 1.1142656249999998, 1.48734375, 1.472796875, 1.4866406250000002, 1.47871875, 1.484640625, 1.481125, 1.479015625, 1.485640625, 1.4735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.44031863772093316, "mean_inference_ms": 1.9138046457837308, "mean_action_processing_ms": 0.11517996460280674, "mean_env_wait_ms": 0.16439437889476785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11018192445909655, "StateBufferConnector_ms": 0.008520242330190298, "ViewRequirementAgentConnector_ms": 0.12416710724701753}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.59178956428548, "num_env_steps_trained_throughput_per_sec": 224.59178956428548, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 18513.701, "sample_time_ms": 10808.813, "learn_time_ms": 7656.572, "learn_throughput": 522.427, "synch_weights_time_ms": 47.529}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 615, "training_iteration": 18, "trial_id": "a7088_00000", "date": "2023-09-10_12-02-54", "timestamp": 1694361774, "time_this_iter_s": 17.82231330871582, "time_total_s": 328.72317910194397, "pid": 78135, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x135228a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 328.72317910194397, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.18965517241379, "ram_util_percent": 30.958620689655167}}
