{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5842028781150778, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004767944747921623, "policy_loss": -0.0179646820994094, "vf_loss": 0.010259405932447407, "vf_explained_var": 0.3411306730781992, "kl": 0.014686657771091018, "entropy": 1.9314761515706778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.9828003060799, "num_env_steps_trained_throughput_per_sec": 228.9828003060799, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 17468.398, "sample_time_ms": 9682.931, "learn_time_ms": 7740.598, "learn_throughput": 516.756, "synch_weights_time_ms": 44.205}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "60c49_00000", "date": "2023-09-10_12-09-30", "timestamp": 1694362170, "time_this_iter_s": 17.474212169647217, "time_total_s": 17.474212169647217, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1342b7550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 17.474212169647217, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 30.057692307692307, "ram_util_percent": 30.615384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6814840067488451, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01028844049142208, "policy_loss": -0.013994909262934622, "vf_loss": 0.0023207155987014024, "vf_explained_var": 0.5773406992976864, "kl": 0.006928762410402255, "entropy": 1.9212350624303023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.29270257912063, "num_env_steps_trained_throughput_per_sec": 223.29270257912063, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 17691.041, "sample_time_ms": 10001.137, "learn_time_ms": 7647.419, "learn_throughput": 523.052, "synch_weights_time_ms": 41.817}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "60c49_00000", "date": "2023-09-10_12-09-48", "timestamp": 1694362188, "time_this_iter_s": 17.91889524459839, "time_total_s": 35.393107414245605, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1335539d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35.393107414245605, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.161538461538463, "ram_util_percent": 30.48076923076923}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9118913696147501, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014295356719109501, "policy_loss": -0.021246627611496174, "vf_loss": 0.0037293146138229834, "vf_explained_var": 0.16173321157693862, "kl": 0.016109781296592615, "entropy": 1.8968479340275128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.5047187499999999, "episode_reward_mean": 0.5871328124999999, "episode_len_mean": 1093.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.5047187499999999}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.5871328124999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999], "episode_lengths": [1178, 1009], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41891404929307974, "mean_inference_ms": 1.734880384656412, "mean_action_processing_ms": 0.1038503488037211, "mean_env_wait_ms": 0.1605055314317333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0990152359008789, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.1119375228881836}}, "episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.5047187499999999, "episode_reward_mean": 0.5871328124999999, "episode_len_mean": 1093.5, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.5047187499999999}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.5871328124999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999], "episode_lengths": [1178, 1009], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41891404929307974, "mean_inference_ms": 1.734880384656412, "mean_action_processing_ms": 0.1038503488037211, "mean_env_wait_ms": 0.1605055314317333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0990152359008789, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 0.1119375228881836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.32308386605288, "num_env_steps_trained_throughput_per_sec": 234.32308386605288, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 17484.17, "sample_time_ms": 10008.321, "learn_time_ms": 7433.609, "learn_throughput": 538.097, "synch_weights_time_ms": 41.596}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 2, "training_iteration": 3, "trial_id": "60c49_00000", "date": "2023-09-10_12-10-06", "timestamp": 1694362206, "time_this_iter_s": 17.075057983398438, "time_total_s": 52.46816539764404, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x133711c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 52.46816539764404, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 25.976923076923075, "ram_util_percent": 30.43846153846154}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0283813653203349, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013831438485552402, "policy_loss": -0.02377801814242654, "vf_loss": 0.006699766398863479, "vf_explained_var": 0.5408570939054091, "kl": 0.016234063263431537, "entropy": 1.8860632286717494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38352656249999983, "episode_len_mean": 1242.7, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.38352656249999983}, "custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41823083796082594, "mean_inference_ms": 1.800047101705075, "mean_action_processing_ms": 0.1066683374697841, "mean_env_wait_ms": 0.16384839853750469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10093450546264648, "StateBufferConnector_ms": 0.008728504180908203, "ViewRequirementAgentConnector_ms": 0.12024402618408203}}, "episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38352656249999983, "episode_len_mean": 1242.7, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.38352656249999983}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41823083796082594, "mean_inference_ms": 1.800047101705075, "mean_action_processing_ms": 0.1066683374697841, "mean_env_wait_ms": 0.16384839853750469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10093450546264648, "StateBufferConnector_ms": 0.008728504180908203, "ViewRequirementAgentConnector_ms": 0.12024402618408203}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.81392119937297, "num_env_steps_trained_throughput_per_sec": 229.81392119937297, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17464.467, "sample_time_ms": 10031.143, "learn_time_ms": 7389.515, "learn_throughput": 541.308, "synch_weights_time_ms": 43.168}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "60c49_00000", "date": "2023-09-10_12-10-26", "timestamp": 1694362226, "time_this_iter_s": 17.41282892227173, "time_total_s": 69.88099431991577, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13381cf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 69.88099431991577, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 27.8, "ram_util_percent": 30.44285714285714}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8908539653134843, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013873252972431752, "policy_loss": -0.017918808152899146, "vf_loss": 0.0012474056453963083, "vf_explained_var": -0.2878989588469267, "kl": 0.013990747039803351, "entropy": 1.8744677412013213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38352656249999983, "episode_len_mean": 1242.7, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.38352656249999983}, "custom_metrics": {"red_0/door_open_done_mean": 0.2, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41823083796082594, "mean_inference_ms": 1.800047101705075, "mean_action_processing_ms": 0.1066683374697841, "mean_env_wait_ms": 0.16384839853750469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10093450546264648, "StateBufferConnector_ms": 0.008728504180908203, "ViewRequirementAgentConnector_ms": 0.12024402618408203}}, "episode_reward_max": 0.6695468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38352656249999983, "episode_len_mean": 1242.7, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.6695468749999999}, "policy_reward_mean": {"red_0": 0.38352656249999983}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41823083796082594, "mean_inference_ms": 1.800047101705075, "mean_action_processing_ms": 0.1066683374697841, "mean_env_wait_ms": 0.16384839853750469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10093450546264648, "StateBufferConnector_ms": 0.008728504180908203, "ViewRequirementAgentConnector_ms": 0.12024402618408203}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.17126718895722, "num_env_steps_trained_throughput_per_sec": 239.17126718895722, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 17316.453, "sample_time_ms": 9983.513, "learn_time_ms": 7288.817, "learn_throughput": 548.786, "synch_weights_time_ms": 43.458}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "60c49_00000", "date": "2023-09-10_12-10-44", "timestamp": 1694362244, "time_this_iter_s": 16.729629039764404, "time_total_s": 86.61062335968018, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1342650d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 86.61062335968018, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 25.807692307692314, "ram_util_percent": 30.51923076923077}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.25, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8725342870379488, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01556684719059073, "policy_loss": -0.018916060169552416, "vf_loss": 0.0008289052732531369, "vf_explained_var": 0.8122327665487925, "kl": 0.012601540001574681, "entropy": 1.8597018466641506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4235260416666666, "episode_len_mean": 1202.3333333333333, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.4235260416666666}, "custom_metrics": {"red_0/door_open_done_mean": 0.25, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183534623147686, "mean_inference_ms": 1.794583932340805, "mean_action_processing_ms": 0.10627307431503878, "mean_env_wait_ms": 0.16323585652120567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10273655255635579, "StateBufferConnector_ms": 0.008231401443481445, "ViewRequirementAgentConnector_ms": 0.11969407399495442}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4235260416666666, "episode_len_mean": 1202.3333333333333, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.4235260416666666}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183534623147686, "mean_inference_ms": 1.794583932340805, "mean_action_processing_ms": 0.10627307431503878, "mean_env_wait_ms": 0.16323585652120567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10273655255635579, "StateBufferConnector_ms": 0.008231401443481445, "ViewRequirementAgentConnector_ms": 0.11969407399495442}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.20645610618163, "num_env_steps_trained_throughput_per_sec": 232.20645610618163, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 17301.382, "sample_time_ms": 9953.487, "learn_time_ms": 7303.808, "learn_throughput": 547.659, "synch_weights_time_ms": 43.413}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 12, "training_iteration": 6, "trial_id": "60c49_00000", "date": "2023-09-10_12-11-04", "timestamp": 1694362264, "time_this_iter_s": 17.231690168380737, "time_total_s": 103.84231352806091, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1342b7280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 103.84231352806091, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 26.910714285714285, "ram_util_percent": 30.507142857142863}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.15, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0994710546607773, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009686362841966912, "policy_loss": -0.019302290707855718, "vf_loss": 0.0070815803372776525, "vf_explained_var": 0.5249796589836478, "kl": 0.012671738263444846, "entropy": 1.8415851816534996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3919156249999999, "episode_len_mean": 1233.4, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3919156249999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.15, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417735827699757, "mean_inference_ms": 1.7966123121633484, "mean_action_processing_ms": 0.1063197436660196, "mean_env_wait_ms": 0.1629952872391137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10184764862060547, "StateBufferConnector_ms": 0.008279085159301758, "ViewRequirementAgentConnector_ms": 0.12105703353881836}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3919156249999999, "episode_len_mean": 1233.4, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3919156249999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417735827699757, "mean_inference_ms": 1.7966123121633484, "mean_action_processing_ms": 0.1063197436660196, "mean_env_wait_ms": 0.1629952872391137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10184764862060547, "StateBufferConnector_ms": 0.008279085159301758, "ViewRequirementAgentConnector_ms": 0.12105703353881836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.55918086808947, "num_env_steps_trained_throughput_per_sec": 233.55918086808947, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 17276.364, "sample_time_ms": 9975.225, "learn_time_ms": 7257.298, "learn_throughput": 551.169, "synch_weights_time_ms": 43.159}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "60c49_00000", "date": "2023-09-10_12-11-23", "timestamp": 1694362283, "time_this_iter_s": 17.134533882141113, "time_total_s": 120.97684741020203, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x134062a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 120.97684741020203, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.537037037037038, "ram_util_percent": 30.588888888888896}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.15, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.105523487056295, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010617527020561587, "policy_loss": -0.013264259112960038, "vf_loss": 0.0009138772209704864, "vf_explained_var": -0.2730611883724729, "kl": 0.008664277189713706, "entropy": 1.827764445543289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3919156249999999, "episode_len_mean": 1233.4, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3919156249999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.15, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417735827699757, "mean_inference_ms": 1.7966123121633484, "mean_action_processing_ms": 0.1063197436660196, "mean_env_wait_ms": 0.1629952872391137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10184764862060547, "StateBufferConnector_ms": 0.008279085159301758, "ViewRequirementAgentConnector_ms": 0.12105703353881836}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3919156249999999, "episode_len_mean": 1233.4, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3919156249999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.417735827699757, "mean_inference_ms": 1.7966123121633484, "mean_action_processing_ms": 0.1063197436660196, "mean_env_wait_ms": 0.1629952872391137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10184764862060547, "StateBufferConnector_ms": 0.008279085159301758, "ViewRequirementAgentConnector_ms": 0.12105703353881836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.07438380737227, "num_env_steps_trained_throughput_per_sec": 233.07438380737227, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 17262.054, "sample_time_ms": 9973.212, "learn_time_ms": 7245.112, "learn_throughput": 552.096, "synch_weights_time_ms": 43.062}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "60c49_00000", "date": "2023-09-10_12-11-43", "timestamp": 1694362303, "time_this_iter_s": 17.166978120803833, "time_total_s": 138.14382553100586, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1342b73a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 138.14382553100586, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.207142857142856, "ram_util_percent": 30.66071428571428}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.13636363636363635, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0668438970732192, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009546371256025548, "policy_loss": -0.011640559865433412, "vf_loss": 0.0001862392595436783, "vf_explained_var": 0.0903087900330623, "kl": 0.009539745501562417, "entropy": 1.7988208254178366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38883238636363626, "episode_len_mean": 1237.6363636363637, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.38883238636363626}, "custom_metrics": {"red_0/door_open_done_mean": 0.13636363636363635, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41766387115313147, "mean_inference_ms": 1.7928397564111962, "mean_action_processing_ms": 0.10610565501692619, "mean_env_wait_ms": 0.1626203061220708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10153055191040039, "StateBufferConnector_ms": 0.008380413055419922, "ViewRequirementAgentConnector_ms": 0.12116648934104225}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.38883238636363626, "episode_len_mean": 1237.6363636363637, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.38883238636363626}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41766387115313147, "mean_inference_ms": 1.7928397564111962, "mean_action_processing_ms": 0.10610565501692619, "mean_env_wait_ms": 0.1626203061220708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10153055191040039, "StateBufferConnector_ms": 0.008380413055419922, "ViewRequirementAgentConnector_ms": 0.12116648934104225}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.35310125836344, "num_env_steps_trained_throughput_per_sec": 232.35310125836344, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 17256.843, "sample_time_ms": 9984.361, "learn_time_ms": 7228.834, "learn_throughput": 553.34, "synch_weights_time_ms": 42.988}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 22, "training_iteration": 9, "trial_id": "60c49_00000", "date": "2023-09-10_12-12-02", "timestamp": 1694362322, "time_this_iter_s": 17.220584869384766, "time_total_s": 155.36441040039062, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13419aa60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 155.36441040039062, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 24.78148148148148, "ram_util_percent": 30.8}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2391693846943477, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012653852422105653, "policy_loss": -0.01849195005161164, "vf_loss": 0.003462823881333558, "vf_explained_var": 0.7261511535073321, "kl": 0.011876368382122122, "entropy": 1.752919052913785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3848437499999999, "episode_len_mean": 1248.9333333333334, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3848437499999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41772589151100126, "mean_inference_ms": 1.7978058020959395, "mean_action_processing_ms": 0.10627790661183457, "mean_env_wait_ms": 0.16275125330794166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10113318761189778, "StateBufferConnector_ms": 0.008167425791422525, "ViewRequirementAgentConnector_ms": 0.12129704157511394}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3848437499999999, "episode_len_mean": 1248.9333333333334, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3848437499999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41772589151100126, "mean_inference_ms": 1.7978058020959395, "mean_action_processing_ms": 0.10627790661183457, "mean_env_wait_ms": 0.16275125330794166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10113318761189778, "StateBufferConnector_ms": 0.008167425791422525, "ViewRequirementAgentConnector_ms": 0.12129704157511394}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.81643712823853, "num_env_steps_trained_throughput_per_sec": 231.81643712823853, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 17256.659, "sample_time_ms": 10031.659, "learn_time_ms": 7181.28, "learn_throughput": 557.004, "synch_weights_time_ms": 43.051}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "60c49_00000", "date": "2023-09-10_12-12-21", "timestamp": 1694362341, "time_this_iter_s": 17.261316776275635, "time_total_s": 172.62572717666626, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x133780700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 172.62572717666626, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 27.3, "ram_util_percent": 30.721428571428564}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.086754538739721, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01647440458170119, "policy_loss": -0.018967818273813462, "vf_loss": 0.00019947307364039565, "vf_explained_var": -0.08985814160356918, "kl": 0.011469700917819984, "entropy": 1.7228784977147977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3848437499999999, "episode_len_mean": 1248.9333333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3848437499999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41772589151100126, "mean_inference_ms": 1.7978058020959395, "mean_action_processing_ms": 0.10627790661183457, "mean_env_wait_ms": 0.16275125330794166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10113318761189778, "StateBufferConnector_ms": 0.008167425791422525, "ViewRequirementAgentConnector_ms": 0.12129704157511394}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3848437499999999, "episode_len_mean": 1248.9333333333334, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3848437499999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41772589151100126, "mean_inference_ms": 1.7978058020959395, "mean_action_processing_ms": 0.10627790661183457, "mean_env_wait_ms": 0.16275125330794166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10113318761189778, "StateBufferConnector_ms": 0.008167425791422525, "ViewRequirementAgentConnector_ms": 0.12129704157511394}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 231.01795151747868, "num_env_steps_trained_throughput_per_sec": 231.01795151747868, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 17241.285, "sample_time_ms": 10058.564, "learn_time_ms": 7139.314, "learn_throughput": 560.278, "synch_weights_time_ms": 42.731}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "60c49_00000", "date": "2023-09-10_12-12-41", "timestamp": 1694362361, "time_this_iter_s": 17.31998109817505, "time_total_s": 189.9457082748413, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13419ab80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 189.9457082748413, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 27.922222222222224, "ram_util_percent": 30.71111111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2208817689679563, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015139325627630266, "policy_loss": -0.018151831513872216, "vf_loss": 0.0007656294146120975, "vf_explained_var": 0.7010221024975181, "kl": 0.011234381398731936, "entropy": 1.6719680270800987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3934648437499999, "episode_len_mean": 1243.25, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3934648437499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4177638750948466, "mean_inference_ms": 1.7970272806234893, "mean_action_processing_ms": 0.1062638880483292, "mean_env_wait_ms": 0.16276717825912804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10083690285682678, "StateBufferConnector_ms": 0.008080899715423584, "ViewRequirementAgentConnector_ms": 0.12124702334403992}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.3934648437499999, "episode_len_mean": 1243.25, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.3934648437499999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4177638750948466, "mean_inference_ms": 1.7970272806234893, "mean_action_processing_ms": 0.1062638880483292, "mean_env_wait_ms": 0.16276717825912804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10083690285682678, "StateBufferConnector_ms": 0.008080899715423584, "ViewRequirementAgentConnector_ms": 0.12124702334403992}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.95698605652237, "num_env_steps_trained_throughput_per_sec": 226.95698605652237, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 17212.36, "sample_time_ms": 10044.512, "learn_time_ms": 7123.052, "learn_throughput": 561.557, "synch_weights_time_ms": 44.016}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 32, "training_iteration": 12, "trial_id": "60c49_00000", "date": "2023-09-10_12-13-00", "timestamp": 1694362380, "time_this_iter_s": 17.63144302368164, "time_total_s": 207.57715129852295, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1337800d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 207.57715129852295, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.139285714285716, "ram_util_percent": 30.767857142857146}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3556389788165688, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01673866710564956, "policy_loss": -0.02194512720440495, "vf_loss": 0.0026025433908822984, "vf_explained_var": 0.7930234628419082, "kl": 0.01301958364437403, "entropy": 1.666475552568833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.39801054687499987, "episode_len_mean": 1245.425, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.39801054687499987}, "custom_metrics": {"red_0/door_open_done_mean": 0.125, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41810738232179717, "mean_inference_ms": 1.8011645585282903, "mean_action_processing_ms": 0.10638120808106577, "mean_env_wait_ms": 0.1628209248058487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09917795658111572, "StateBufferConnector_ms": 0.008096098899841309, "ViewRequirementAgentConnector_ms": 0.12095332145690918}}, "episode_reward_max": 0.8980468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.39801054687499987, "episode_len_mean": 1245.425, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 0.8980468749999999}, "policy_reward_mean": {"red_0": 0.39801054687499987}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41810738232179717, "mean_inference_ms": 1.8011645585282903, "mean_action_processing_ms": 0.10638120808106577, "mean_env_wait_ms": 0.1628209248058487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09917795658111572, "StateBufferConnector_ms": 0.008096098899841309, "ViewRequirementAgentConnector_ms": 0.12095332145690918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.74760770890867, "num_env_steps_trained_throughput_per_sec": 221.74760770890867, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 17309.168, "sample_time_ms": 10104.79, "learn_time_ms": 7159.34, "learn_throughput": 558.711, "synch_weights_time_ms": 44.235}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "60c49_00000", "date": "2023-09-10_12-13-21", "timestamp": 1694362401, "time_this_iter_s": 18.044729709625244, "time_total_s": 225.6218810081482, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1336da700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 225.6218810081482, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 26.70689655172414, "ram_util_percent": 30.74137931034482}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.14634146341463414, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4256682163104415, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007903179617642309, "policy_loss": -0.018231607801862993, "vf_loss": 0.00757074851753714, "vf_explained_var": 0.2119725516686837, "kl": 0.013788396798948574, "entropy": 1.6574850253760816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.420341463414634, "episode_len_mean": 1220.6829268292684, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.420341463414634}, "custom_metrics": {"red_0/door_open_done_mean": 0.14634146341463414, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4181697455982658, "mean_inference_ms": 1.8007423399780786, "mean_action_processing_ms": 0.10640089288976724, "mean_env_wait_ms": 0.16280650027971394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10000031168867902, "StateBufferConnector_ms": 0.008089367936297161, "ViewRequirementAgentConnector_ms": 0.12114978418117617}}, "episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.420341463414634, "episode_len_mean": 1220.6829268292684, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.420341463414634}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4181697455982658, "mean_inference_ms": 1.8007423399780786, "mean_action_processing_ms": 0.10640089288976724, "mean_env_wait_ms": 0.16280650027971394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10000031168867902, "StateBufferConnector_ms": 0.008089367936297161, "ViewRequirementAgentConnector_ms": 0.12114978418117617}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.2480537105512, "num_env_steps_trained_throughput_per_sec": 230.2480537105512, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 17305.886, "sample_time_ms": 10119.417, "learn_time_ms": 7142.042, "learn_throughput": 560.064, "synch_weights_time_ms": 43.626}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 41, "training_iteration": 14, "trial_id": "60c49_00000", "date": "2023-09-10_12-13-40", "timestamp": 1694362420, "time_this_iter_s": 17.378365993499756, "time_total_s": 243.00024700164795, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13419a160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 243.00024700164795, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.575000000000006, "ram_util_percent": 30.707142857142852}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.18181818181818182, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5033547897512713, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011105057128588669, "policy_loss": -0.018589993615751154, "vf_loss": 0.0052869988872165175, "vf_explained_var": 0.37394695561379193, "kl": 0.0109896883706521, "entropy": 1.6440974704921245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.43575177556818173, "episode_len_mean": 1207.4318181818182, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.43575177556818173}, "custom_metrics": {"red_0/door_open_done_mean": 0.18181818181818182, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41825052130733786, "mean_inference_ms": 1.8062915368545027, "mean_action_processing_ms": 0.10652556569180373, "mean_env_wait_ms": 0.16304987264566367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0999396497553045, "StateBufferConnector_ms": 0.00797239216891202, "ViewRequirementAgentConnector_ms": 0.12078718705610796}}, "episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.43575177556818173, "episode_len_mean": 1207.4318181818182, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.43575177556818173}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41825052130733786, "mean_inference_ms": 1.8062915368545027, "mean_action_processing_ms": 0.10652556569180373, "mean_env_wait_ms": 0.16304987264566367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0999396497553045, "StateBufferConnector_ms": 0.00797239216891202, "ViewRequirementAgentConnector_ms": 0.12078718705610796}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.93547921966882, "num_env_steps_trained_throughput_per_sec": 236.93547921966882, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 17321.668, "sample_time_ms": 10123.254, "learn_time_ms": 7154.181, "learn_throughput": 559.114, "synch_weights_time_ms": 43.442}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 44, "training_iteration": 15, "trial_id": "60c49_00000", "date": "2023-09-10_12-13-59", "timestamp": 1694362439, "time_this_iter_s": 16.888302087783813, "time_total_s": 259.88854908943176, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13381c430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 259.88854908943176, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.244444444444444, "ram_util_percent": 30.781481481481485}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.16, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4342821417065958, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014473114162198424, "policy_loss": -0.019141787806195982, "vf_loss": 0.0019277350547478515, "vf_explained_var": 0.0936233326792717, "kl": 0.013704693661927727, "entropy": 1.600123094022274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4292415624999999, "episode_len_mean": 1216.14, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.4292415624999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.16, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183707859820898, "mean_inference_ms": 1.8040050052920156, "mean_action_processing_ms": 0.10651862575201482, "mean_env_wait_ms": 0.16295004194594312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10242843627929688, "StateBufferConnector_ms": 0.007922172546386719, "ViewRequirementAgentConnector_ms": 0.12045145034790039}}, "episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4292415624999999, "episode_len_mean": 1216.14, "episodes_this_iter": 6, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.4292415624999999}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4183707859820898, "mean_inference_ms": 1.8040050052920156, "mean_action_processing_ms": 0.10651862575201482, "mean_env_wait_ms": 0.16295004194594312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10242843627929688, "StateBufferConnector_ms": 0.007922172546386719, "ViewRequirementAgentConnector_ms": 0.12045145034790039}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.28521183608157, "num_env_steps_trained_throughput_per_sec": 226.28521183608157, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 17366.743, "sample_time_ms": 10182.351, "learn_time_ms": 7139.627, "learn_throughput": 560.253, "synch_weights_time_ms": 43.989}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "60c49_00000", "date": "2023-09-10_12-14-19", "timestamp": 1694362459, "time_this_iter_s": 17.683178901672363, "time_total_s": 277.5717279911041, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x133fab9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 277.5717279911041, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 27.039285714285715, "ram_util_percent": 30.66785714285715}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2037037037037037, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6932656768709422, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0012278016519606657, "policy_loss": -0.018941317375962777, "vf_loss": 0.015103548017699116, "vf_explained_var": 0.3949850369244814, "kl": 0.013049838889391322, "entropy": 1.5982147863755622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4650543981481481, "episode_len_mean": 1177.2592592592594, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.4650543981481481}, "custom_metrics": {"red_0/door_open_done_mean": 0.2037037037037037, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4184023782909546, "mean_inference_ms": 1.8022592236067363, "mean_action_processing_ms": 0.10647747808561273, "mean_env_wait_ms": 0.16288184128065716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10217913874873409, "StateBufferConnector_ms": 0.008035147631609882, "ViewRequirementAgentConnector_ms": 0.12115946522465458}}, "episode_reward_max": 1.3135781249999998, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.4650543981481481, "episode_len_mean": 1177.2592592592594, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.3135781249999998}, "policy_reward_mean": {"red_0": 0.4650543981481481}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4184023782909546, "mean_inference_ms": 1.8022592236067363, "mean_action_processing_ms": 0.10647747808561273, "mean_env_wait_ms": 0.16288184128065716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10217913874873409, "StateBufferConnector_ms": 0.008035147631609882, "ViewRequirementAgentConnector_ms": 0.12115946522465458}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.1759007916213, "num_env_steps_trained_throughput_per_sec": 229.1759007916213, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 17399.5, "sample_time_ms": 10174.754, "learn_time_ms": 7179.881, "learn_throughput": 557.112, "synch_weights_time_ms": 44.095}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 54, "training_iteration": 17, "trial_id": "60c49_00000", "date": "2023-09-10_12-14-39", "timestamp": 1694362479, "time_this_iter_s": 17.460315227508545, "time_total_s": 295.03204321861267, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1340620d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 295.03204321861267, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.6, "ram_util_percent": 30.757142857142856}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.2903225806451613, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6720660490294297, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.004484921244875295, "policy_loss": -0.02007230142141149, "vf_loss": 0.02203205057545953, "vf_explained_var": 0.3273728134731452, "kl": 0.012625857564125549, "entropy": 1.5862289565304915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 1.395890625, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.5275405745967742, "episode_len_mean": 1109.5967741935483, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.395890625}, "policy_reward_mean": {"red_0": 0.5275405745967742}, "custom_metrics": {"red_0/door_open_done_mean": 0.2903225806451613, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418590691522399, "mean_inference_ms": 1.8098604654485315, "mean_action_processing_ms": 0.10670335785782956, "mean_env_wait_ms": 0.16323440419921842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1029079960238549, "StateBufferConnector_ms": 0.008073545271350492, "ViewRequirementAgentConnector_ms": 0.12155655891664567}}, "episode_reward_max": 1.395890625, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.5275405745967742, "episode_len_mean": 1109.5967741935483, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.395890625}, "policy_reward_mean": {"red_0": 0.5275405745967742}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.418590691522399, "mean_inference_ms": 1.8098604654485315, "mean_action_processing_ms": 0.10670335785782956, "mean_env_wait_ms": 0.16323440419921842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1029079960238549, "StateBufferConnector_ms": 0.008073545271350492, "ViewRequirementAgentConnector_ms": 0.12155655891664567}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.59765548876766, "num_env_steps_trained_throughput_per_sec": 224.59765548876766, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 17464.272, "sample_time_ms": 10206.961, "learn_time_ms": 7212.663, "learn_throughput": 554.58, "synch_weights_time_ms": 43.859}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 62, "training_iteration": 18, "trial_id": "60c49_00000", "date": "2023-09-10_12-14-58", "timestamp": 1694362498, "time_this_iter_s": 17.816385984420776, "time_total_s": 312.84842920303345, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1342b73a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 312.84842920303345, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 28.25714285714286, "ram_util_percent": 30.86785714285714}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.37142857142857144, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7571701134865483, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.006446415764124443, "policy_loss": -0.017829213584142658, "vf_loss": 0.021531130558772323, "vf_explained_var": 0.41203830478092035, "kl": 0.013722494405267616, "entropy": 1.5482372231781483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 1.4085468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.5962957589285712, "episode_len_mean": 1034.9571428571428, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.4085468749999999}, "policy_reward_mean": {"red_0": 0.5962957589285712}, "custom_metrics": {"red_0/door_open_done_mean": 0.37142857142857144, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186823049956596, "mean_inference_ms": 1.815806410615927, "mean_action_processing_ms": 0.1068512638291161, "mean_env_wait_ms": 0.16355903745056002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10219131197248187, "StateBufferConnector_ms": 0.008225100381033761, "ViewRequirementAgentConnector_ms": 0.12214285986764091}}, "episode_reward_max": 1.4085468749999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.5962957589285712, "episode_len_mean": 1034.9571428571428, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.4085468749999999}, "policy_reward_mean": {"red_0": 0.5962957589285712}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4186823049956596, "mean_inference_ms": 1.815806410615927, "mean_action_processing_ms": 0.1068512638291161, "mean_env_wait_ms": 0.16355903745056002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10219131197248187, "StateBufferConnector_ms": 0.008225100381033761, "ViewRequirementAgentConnector_ms": 0.12214285986764091}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.86780430944836, "num_env_steps_trained_throughput_per_sec": 206.86780430944836, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 17676.356, "sample_time_ms": 10276.152, "learn_time_ms": 7355.011, "learn_throughput": 543.847, "synch_weights_time_ms": 44.378}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 70, "training_iteration": 19, "trial_id": "60c49_00000", "date": "2023-09-10_12-15-20", "timestamp": 1694362520, "time_this_iter_s": 19.343668937683105, "time_total_s": 332.19209814071655, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1337110d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 332.19209814071655, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.493548387096777, "ram_util_percent": 31.10645161290322}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.5268817204301075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0254381105303763, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0328004202429535, "policy_loss": -0.025539609674403132, "vf_loss": 0.0549958987821204, "vf_explained_var": 0.40068282298743724, "kl": 0.01672065327488784, "entropy": 1.5084687631577254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 1.4692812499999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.7659007056451611, "episode_len_mean": 844.8494623655914, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.4692812499999999}, "policy_reward_mean": {"red_0": 0.7659007056451611}, "custom_metrics": {"red_0/door_open_done_mean": 0.5268817204301075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850, 50, 88, 209, 93, 188, 57, 195, 276, 66, 354, 207, 629, 49, 77, 96, 769, 724, 1169, 155, 457, 88, 90, 38], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41911051490893936, "mean_inference_ms": 1.8198848870511408, "mean_action_processing_ms": 0.10704743358558981, "mean_env_wait_ms": 0.16407807737617675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10283582953996556, "StateBufferConnector_ms": 0.008222877338368406, "ViewRequirementAgentConnector_ms": 0.12178805566603138}}, "episode_reward_max": 1.4692812499999999, "episode_reward_min": 0.31799999999999984, "episode_reward_mean": 0.7659007056451611, "episode_len_mean": 844.8494623655914, "episodes_this_iter": 23, "policy_reward_min": {"red_0": 0.31799999999999984}, "policy_reward_max": {"red_0": 1.4692812499999999}, "policy_reward_mean": {"red_0": 0.7659007056451611}, "hist_stats": {"episode_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999], "episode_lengths": [1178, 1009, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 721, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1036, 1280, 1280, 1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850, 50, 88, 209, 93, 188, 57, 195, 276, 66, 354, 207, 629, 49, 77, 96, 769, 724, 1169, 155, 457, 88, 90, 38], "policy_red_0_reward": [0.5047187499999999, 0.6695468749999999, 0.31799999999999984, 0.32299999999999984, 0.34099999999999986, 0.32899999999999985, 0.32799999999999985, 0.33499999999999985, 0.34599999999999986, 0.34099999999999986, 0.8980468749999999, 0.34899999999999987, 0.33899999999999986, 0.34199999999999986, 0.33799999999999986, 0.33099999999999985, 0.3639999999999999, 0.33199999999999985, 0.34999999999999987, 0.3599999999999999, 0.3639999999999999, 0.35199999999999987, 0.3819999999999999, 0.3719999999999999, 0.3659999999999999, 0.35599999999999987, 0.3649999999999999, 0.3819999999999999, 0.3669999999999999, 0.4009999999999999, 0.6675625, 0.3779999999999999, 0.3909999999999999, 0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.41911051490893936, "mean_inference_ms": 1.8198848870511408, "mean_action_processing_ms": 0.10704743358558981, "mean_env_wait_ms": 0.16407807737617675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10283582953996556, "StateBufferConnector_ms": 0.008222877338368406, "ViewRequirementAgentConnector_ms": 0.12178805566603138}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 235.5241448166916, "num_env_steps_trained_throughput_per_sec": 235.5241448166916, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 17649.192, "sample_time_ms": 10221.454, "learn_time_ms": 7382.564, "learn_throughput": 541.817, "synch_weights_time_ms": 44.358}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 93, "training_iteration": 20, "trial_id": "60c49_00000", "date": "2023-09-10_12-15-39", "timestamp": 1694362539, "time_this_iter_s": 16.991547107696533, "time_total_s": 349.1836452484131, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1340c68b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 349.1836452484131, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.55555555555556, "ram_util_percent": 31.32592592592593}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.85, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0420559935892624, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04040353665550356, "policy_loss": -0.022824388346634805, "vf_loss": 0.0600349228673925, "vf_explained_var": 0.4418280609572927, "kl": 0.015965010212898582, "entropy": 1.4245975290735562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 1.47590625, "episode_reward_min": 0.3599999999999999, "episode_reward_mean": 1.1440626562499998, "episode_len_mean": 421.87, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.3599999999999999}, "policy_reward_max": {"red_0": 1.47590625}, "policy_reward_mean": {"red_0": 1.1440626562499998}, "custom_metrics": {"red_0/door_open_done_mean": 0.85, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002], "episode_lengths": [1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850, 50, 88, 209, 93, 188, 57, 195, 276, 66, 354, 207, 629, 49, 77, 96, 769, 724, 1169, 155, 457, 88, 90, 38, 190, 84, 30, 38, 113, 293, 156, 81, 85, 52, 49, 1199, 61, 66, 102, 75, 93, 93, 96, 130, 45, 112, 64, 72, 37, 32, 143, 74, 52, 133, 82, 61, 48, 119, 76, 124, 86, 93, 68, 73], "policy_red_0_reward": [0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204103144499445, "mean_inference_ms": 1.8281822206885232, "mean_action_processing_ms": 0.10747638816660189, "mean_env_wait_ms": 0.16498528630266418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10561227798461914, "StateBufferConnector_ms": 0.008193254470825195, "ViewRequirementAgentConnector_ms": 0.12215685844421387}}, "episode_reward_max": 1.47590625, "episode_reward_min": 0.3599999999999999, "episode_reward_mean": 1.1440626562499998, "episode_len_mean": 421.87, "episodes_this_iter": 40, "policy_reward_min": {"red_0": 0.3599999999999999}, "policy_reward_max": {"red_0": 1.47590625}, "policy_reward_mean": {"red_0": 1.1440626562499998}, "hist_stats": {"episode_reward": [0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002], "episode_lengths": [1280, 1280, 1280, 1073, 1280, 1280, 1280, 231, 599, 1200, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 286, 704, 1280, 495, 1280, 131, 445, 436, 412, 1234, 750, 535, 346, 113, 906, 300, 551, 277, 309, 850, 50, 88, 209, 93, 188, 57, 195, 276, 66, 354, 207, 629, 49, 77, 96, 769, 724, 1169, 155, 457, 88, 90, 38, 190, 84, 30, 38, 113, 293, 156, 81, 85, 52, 49, 1199, 61, 66, 102, 75, 93, 93, 96, 130, 45, 112, 64, 72, 37, 32, 143, 74, 52, 133, 82, 61, 48, 119, 76, 124, 86, 93, 68, 73], "policy_red_0_reward": [0.3959999999999999, 0.3929999999999999, 0.3769999999999999, 0.629546875, 0.3749999999999999, 0.3909999999999999, 0.3769999999999999, 1.3135781249999998, 1.0138281249999999, 0.5352499999999999, 0.3899999999999999, 0.4029999999999999, 0.3679999999999999, 0.3759999999999999, 0.3599999999999999, 0.3929999999999999, 0.3889999999999999, 1.26890625, 0.9109999999999998, 0.3809999999999999, 1.0899531249999999, 0.3609999999999999, 1.395890625, 1.1231093749999999, 1.1374374999999999, 1.1703124999999999, 0.48734374999999985, 0.8826562499999999, 1.036828125, 1.23271875, 1.4085468749999999, 0.75096875, 1.2480625, 1.0515781249999998, 1.2742343749999998, 1.2557343749999998, 0.8113437499999999, 1.46284375, 1.4341249999999999, 1.324046875, 1.429609375, 1.3548125, 1.452921875, 1.332890625, 1.2759375, 1.44559375, 1.1950937499999998, 1.3334531250000001, 1.003734375, 1.456546875, 1.432859375, 1.4235, 0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4204103144499445, "mean_inference_ms": 1.8281822206885232, "mean_action_processing_ms": 0.10747638816660189, "mean_env_wait_ms": 0.16498528630266418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10561227798461914, "StateBufferConnector_ms": 0.008193254470825195, "ViewRequirementAgentConnector_ms": 0.12215685844421387}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.73114896236592, "num_env_steps_trained_throughput_per_sec": 222.73114896236592, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 17713.612, "sample_time_ms": 10243.122, "learn_time_ms": 7425.339, "learn_throughput": 538.696, "synch_weights_time_ms": 44.334}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 133, "training_iteration": 21, "trial_id": "60c49_00000", "date": "2023-09-10_12-15-59", "timestamp": 1694362559, "time_this_iter_s": 17.967444896697998, "time_total_s": 367.1510901451111, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1337809d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 367.1510901451111, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.60344827586207, "ram_util_percent": 31.117241379310347}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.007602876921495, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03189841848191766, "policy_loss": -0.025768720011789505, "vf_loss": 0.05392861887230538, "vf_explained_var": 0.5164465470860402, "kl": 0.018692596303160187, "entropy": 1.3934857567151389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 1.483828125, "episode_reward_min": 0.5279531249999998, "episode_reward_mean": 1.39842890625, "episode_len_mean": 123.55, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {"red_0": 0.5279531249999998}, "policy_reward_max": {"red_0": 1.483828125}, "policy_reward_mean": {"red_0": 1.39842890625}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002, 1.428859375, 1.428234375, 1.4732812499999999, 1.4249062499999998, 1.47046875, 1.4623593750000001, 1.303953125, 1.45503125, 1.463953125, 1.468578125, 1.4438906249999999, 1.4562187500000001, 1.4473281249999999, 1.46065625, 1.46646875, 1.4755, 1.4159531250000001, 1.4385625, 1.464765625, 1.483828125, 1.4449999999999998, 1.4270156250000001, 1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375], "episode_lengths": [769, 724, 1169, 155, 457, 88, 90, 38, 190, 84, 30, 38, 113, 293, 156, 81, 85, 52, 49, 1199, 61, 66, 102, 75, 93, 93, 96, 130, 45, 112, 64, 72, 37, 32, 143, 74, 52, 133, 82, 61, 48, 119, 76, 124, 86, 93, 68, 73, 77, 85, 38, 94, 42, 45, 239, 54, 47, 39, 67, 58, 55, 46, 42, 32, 111, 76, 43, 23, 64, 91, 43, 77, 242, 36, 62, 51, 322, 36, 363, 36, 302, 39, 61, 87, 31, 45, 57, 42, 113, 109, 31, 159, 53, 48, 26, 49, 38, 49, 58, 52], "policy_red_0_reward": [0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002, 1.428859375, 1.428234375, 1.4732812499999999, 1.4249062499999998, 1.47046875, 1.4623593750000001, 1.303953125, 1.45503125, 1.463953125, 1.468578125, 1.4438906249999999, 1.4562187500000001, 1.4473281249999999, 1.46065625, 1.46646875, 1.4755, 1.4159531250000001, 1.4385625, 1.464765625, 1.483828125, 1.4449999999999998, 1.4270156250000001, 1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42121992721703205, "mean_inference_ms": 1.8239212307638824, "mean_action_processing_ms": 0.10745031218168453, "mean_env_wait_ms": 0.16541374829808567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10458517074584961, "StateBufferConnector_ms": 0.007990121841430664, "ViewRequirementAgentConnector_ms": 0.12079596519470215}}, "episode_reward_max": 1.483828125, "episode_reward_min": 0.5279531249999998, "episode_reward_mean": 1.39842890625, "episode_len_mean": 123.55, "episodes_this_iter": 52, "policy_reward_min": {"red_0": 0.5279531249999998}, "policy_reward_max": {"red_0": 1.483828125}, "policy_reward_mean": {"red_0": 1.39842890625}, "hist_stats": {"episode_reward": [0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002, 1.428859375, 1.428234375, 1.4732812499999999, 1.4249062499999998, 1.47046875, 1.4623593750000001, 1.303953125, 1.45503125, 1.463953125, 1.468578125, 1.4438906249999999, 1.4562187500000001, 1.4473281249999999, 1.46065625, 1.46646875, 1.4755, 1.4159531250000001, 1.4385625, 1.464765625, 1.483828125, 1.4449999999999998, 1.4270156250000001, 1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375], "episode_lengths": [769, 724, 1169, 155, 457, 88, 90, 38, 190, 84, 30, 38, 113, 293, 156, 81, 85, 52, 49, 1199, 61, 66, 102, 75, 93, 93, 96, 130, 45, 112, 64, 72, 37, 32, 143, 74, 52, 133, 82, 61, 48, 119, 76, 124, 86, 93, 68, 73, 77, 85, 38, 94, 42, 45, 239, 54, 47, 39, 67, 58, 55, 46, 42, 32, 111, 76, 43, 23, 64, 91, 43, 77, 242, 36, 62, 51, 322, 36, 363, 36, 302, 39, 61, 87, 31, 45, 57, 42, 113, 109, 31, 159, 53, 48, 26, 49, 38, 49, 58, 52], "policy_red_0_reward": [0.8782968749999999, 0.9049374999999998, 0.5670468749999998, 1.3730156249999999, 1.093671875, 1.424125, 1.41971875, 1.4692812499999999, 1.34040625, 1.4169375, 1.47590625, 1.47028125, 1.4085468749999999, 1.252984375, 1.3763125, 1.430046875, 1.434234375, 1.4574375, 1.4585468750000001, 0.5279531249999998, 1.454109375, 1.4445937500000001, 1.41828125, 1.435265625, 1.425609375, 1.4236093749999998, 1.4205, 1.38959375, 1.464359375, 1.40625, 1.447, 1.438375, 1.470984375, 1.4755, 1.3844531249999998, 1.44396875, 1.4564374999999998, 1.397484375, 1.43234375, 1.450109375, 1.46425, 1.397328125, 1.4385625, 1.3958125, 1.42453125, 1.420609375, 1.4501875, 1.4396718750000002, 1.428859375, 1.428234375, 1.4732812499999999, 1.4249062499999998, 1.47046875, 1.4623593750000001, 1.303953125, 1.45503125, 1.463953125, 1.468578125, 1.4438906249999999, 1.4562187500000001, 1.4473281249999999, 1.46065625, 1.46646875, 1.4755, 1.4159531250000001, 1.4385625, 1.464765625, 1.483828125, 1.4449999999999998, 1.4270156250000001, 1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42121992721703205, "mean_inference_ms": 1.8239212307638824, "mean_action_processing_ms": 0.10745031218168453, "mean_env_wait_ms": 0.16541374829808567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10458517074584961, "StateBufferConnector_ms": 0.007990121841430664, "ViewRequirementAgentConnector_ms": 0.12079596519470215}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.72472096014, "num_env_steps_trained_throughput_per_sec": 233.72472096014, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 17662.581, "sample_time_ms": 10253.696, "learn_time_ms": 7364.547, "learn_throughput": 543.143, "synch_weights_time_ms": 43.625}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 185, "training_iteration": 22, "trial_id": "60c49_00000", "date": "2023-09-10_12-16-19", "timestamp": 1694362579, "time_this_iter_s": 17.123533964157104, "time_total_s": 384.2746241092682, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x1337808b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 384.2746241092682, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.244444444444444, "ram_util_percent": 31.08518518518519}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0762623088434338, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0209123189390084, "policy_loss": -0.025516067050678732, "vf_loss": 0.04350827582335721, "vf_explained_var": 0.5493449208016197, "kl": 0.014600551681192354, "entropy": 1.3368169064323108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 1.484234375, "episode_reward_min": 1.19159375, "episode_reward_mean": 1.4463637500000002, "episode_len_mean": 66.0, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {"red_0": 1.19159375}, "policy_reward_max": {"red_0": 1.484234375}, "policy_reward_mean": {"red_0": 1.4463637500000002}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375, 1.4472968750000001, 1.456328125, 1.484234375, 1.472203125, 1.4253125, 1.4665781249999998, 1.47109375, 1.4119843749999998, 1.4491874999999999, 1.463359375, 1.4310156250000001, 1.46828125, 1.467578125, 1.481828125, 1.4591406249999999, 1.467875, 1.449109375, 1.40425, 1.4407812500000001, 1.481828125, 1.456515625, 1.463171875, 1.4739843750000001, 1.46428125, 1.4769062499999999, 1.476609375, 1.453625, 1.294375, 1.4650625000000002, 1.43615625, 1.482421875, 1.467359375, 1.4650625000000002, 1.46728125, 1.457140625, 1.484234375, 1.4625468750000001, 1.472390625, 1.452109375, 1.481828125, 1.45884375, 1.47490625, 1.443859375, 1.4215, 1.38675, 1.4773125, 1.4730937499999999, 1.471578125, 1.475609375, 1.4243125, 1.48171875, 1.472390625, 1.402921875, 1.472984375, 1.45503125, 1.45140625, 1.457328125, 1.4733125, 1.463359375, 1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375], "episode_lengths": [43, 77, 242, 36, 62, 51, 322, 36, 363, 36, 302, 39, 61, 87, 31, 45, 57, 42, 113, 109, 31, 159, 53, 48, 26, 49, 38, 49, 58, 52, 65, 55, 21, 31, 92, 39, 34, 101, 68, 45, 91, 38, 39, 23, 51, 40, 61, 112, 70, 23, 59, 41, 37, 38, 30, 29, 56, 264, 44, 78, 25, 45, 44, 38, 51, 21, 49, 35, 61, 23, 50, 30, 77, 96, 144, 28, 34, 39, 29, 92, 26, 35, 121, 37, 54, 62, 55, 28, 45, 75, 49, 130, 37, 39, 48, 64, 36, 44, 43, 69], "policy_red_0_reward": [1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375, 1.4472968750000001, 1.456328125, 1.484234375, 1.472203125, 1.4253125, 1.4665781249999998, 1.47109375, 1.4119843749999998, 1.4491874999999999, 1.463359375, 1.4310156250000001, 1.46828125, 1.467578125, 1.481828125, 1.4591406249999999, 1.467875, 1.449109375, 1.40425, 1.4407812500000001, 1.481828125, 1.456515625, 1.463171875, 1.4739843750000001, 1.46428125, 1.4769062499999999, 1.476609375, 1.453625, 1.294375, 1.4650625000000002, 1.43615625, 1.482421875, 1.467359375, 1.4650625000000002, 1.46728125, 1.457140625, 1.484234375, 1.4625468750000001, 1.472390625, 1.452109375, 1.481828125, 1.45884375, 1.47490625, 1.443859375, 1.4215, 1.38675, 1.4773125, 1.4730937499999999, 1.471578125, 1.475609375, 1.4243125, 1.48171875, 1.472390625, 1.402921875, 1.472984375, 1.45503125, 1.45140625, 1.457328125, 1.4733125, 1.463359375, 1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4232785730191319, "mean_inference_ms": 1.8096924825580138, "mean_action_processing_ms": 0.10768785211457046, "mean_env_wait_ms": 0.16553558130120327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10289478302001953, "StateBufferConnector_ms": 0.00800776481628418, "ViewRequirementAgentConnector_ms": 0.12493181228637695}}, "episode_reward_max": 1.484234375, "episode_reward_min": 1.19159375, "episode_reward_mean": 1.4463637500000002, "episode_len_mean": 66.0, "episodes_this_iter": 70, "policy_reward_min": {"red_0": 1.19159375}, "policy_reward_max": {"red_0": 1.484234375}, "policy_reward_mean": {"red_0": 1.4463637500000002}, "hist_stats": {"episode_reward": [1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375, 1.4472968750000001, 1.456328125, 1.484234375, 1.472203125, 1.4253125, 1.4665781249999998, 1.47109375, 1.4119843749999998, 1.4491874999999999, 1.463359375, 1.4310156250000001, 1.46828125, 1.467578125, 1.481828125, 1.4591406249999999, 1.467875, 1.449109375, 1.40425, 1.4407812500000001, 1.481828125, 1.456515625, 1.463171875, 1.4739843750000001, 1.46428125, 1.4769062499999999, 1.476609375, 1.453625, 1.294375, 1.4650625000000002, 1.43615625, 1.482421875, 1.467359375, 1.4650625000000002, 1.46728125, 1.457140625, 1.484234375, 1.4625468750000001, 1.472390625, 1.452109375, 1.481828125, 1.45884375, 1.47490625, 1.443859375, 1.4215, 1.38675, 1.4773125, 1.4730937499999999, 1.471578125, 1.475609375, 1.4243125, 1.48171875, 1.472390625, 1.402921875, 1.472984375, 1.45503125, 1.45140625, 1.457328125, 1.4733125, 1.463359375, 1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375], "episode_lengths": [43, 77, 242, 36, 62, 51, 322, 36, 363, 36, 302, 39, 61, 87, 31, 45, 57, 42, 113, 109, 31, 159, 53, 48, 26, 49, 38, 49, 58, 52, 65, 55, 21, 31, 92, 39, 34, 101, 68, 45, 91, 38, 39, 23, 51, 40, 61, 112, 70, 23, 59, 41, 37, 38, 30, 29, 56, 264, 44, 78, 25, 45, 44, 38, 51, 21, 49, 35, 61, 23, 50, 30, 77, 96, 144, 28, 34, 39, 29, 92, 26, 35, 121, 37, 54, 62, 55, 28, 45, 75, 49, 130, 37, 39, 48, 64, 36, 44, 43, 69], "policy_red_0_reward": [1.469765625, 1.439859375, 1.28984375, 1.4686875000000001, 1.45140625, 1.458140625, 1.19159375, 1.4726875000000001, 1.2207656249999999, 1.4736875, 1.24765625, 1.468578125, 1.4511093750000001, 1.429828125, 1.476203125, 1.465359375, 1.447921875, 1.46846875, 1.413546875, 1.405359375, 1.476203125, 1.364203125, 1.4507343750000001, 1.46225, 1.4807187499999999, 1.4585468750000001, 1.47228125, 1.463546875, 1.45021875, 1.4594375, 1.4472968750000001, 1.456328125, 1.484234375, 1.472203125, 1.4253125, 1.4665781249999998, 1.47109375, 1.4119843749999998, 1.4491874999999999, 1.463359375, 1.4310156250000001, 1.46828125, 1.467578125, 1.481828125, 1.4591406249999999, 1.467875, 1.449109375, 1.40425, 1.4407812500000001, 1.481828125, 1.456515625, 1.463171875, 1.4739843750000001, 1.46428125, 1.4769062499999999, 1.476609375, 1.453625, 1.294375, 1.4650625000000002, 1.43615625, 1.482421875, 1.467359375, 1.4650625000000002, 1.46728125, 1.457140625, 1.484234375, 1.4625468750000001, 1.472390625, 1.452109375, 1.481828125, 1.45884375, 1.47490625, 1.443859375, 1.4215, 1.38675, 1.4773125, 1.4730937499999999, 1.471578125, 1.475609375, 1.4243125, 1.48171875, 1.472390625, 1.402921875, 1.472984375, 1.45503125, 1.45140625, 1.457328125, 1.4733125, 1.463359375, 1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4232785730191319, "mean_inference_ms": 1.8096924825580138, "mean_action_processing_ms": 0.10768785211457046, "mean_env_wait_ms": 0.16553558130120327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10289478302001953, "StateBufferConnector_ms": 0.00800776481628418, "ViewRequirementAgentConnector_ms": 0.12493181228637695}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.8590587799024, "num_env_steps_trained_throughput_per_sec": 215.8590587799024, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 17711.789, "sample_time_ms": 10319.213, "learn_time_ms": 7348.531, "learn_throughput": 544.327, "synch_weights_time_ms": 43.35}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 255, "training_iteration": 23, "trial_id": "60c49_00000", "date": "2023-09-10_12-16-39", "timestamp": 1694362599, "time_this_iter_s": 18.539572954177856, "time_total_s": 402.81419706344604, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x133fabaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 402.81419706344604, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.348275862068963, "ram_util_percent": 31.18275862068966}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9864211039617659, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01371313590631568, "policy_loss": -0.02067226856064129, "vf_loss": 0.031697219404547165, "vf_explained_var": 0.742954123703142, "kl": 0.013440927106504512, "entropy": 1.296840450540185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 1.488046875, "episode_reward_min": 1.140171875, "episode_reward_mean": 1.4639493749999999, "episode_len_mean": 45.0, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {"red_0": 1.140171875}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4639493749999999}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375, 1.140171875, 1.4730937499999999, 1.471984375, 1.471984375, 1.4346406250000001, 1.471796875, 1.4807187499999999, 1.4481875, 1.474796875, 1.46665625, 1.468578125, 1.484640625, 1.452328125, 1.4775, 1.45040625, 1.470984375, 1.362390625, 1.4773125, 1.466984375, 1.4765000000000001, 1.4359375, 1.4491874999999999, 1.467875, 1.47409375, 1.4763125000000001, 1.480015625, 1.488046875, 1.4324531249999999, 1.46828125, 1.465765625, 1.4725000000000001, 1.460953125, 1.47490625, 1.476609375, 1.47490625, 1.46365625, 1.483828125, 1.4424843749999998, 1.4610625000000002, 1.4478125, 1.48153125, 1.48534375, 1.469578125, 1.476609375, 1.481421875, 1.47128125, 1.4849375, 1.468578125, 1.4699843750000001, 1.449703125, 1.48153125, 1.483125, 1.46665625, 1.47509375, 1.461546875, 1.4828281250000002, 1.47509375, 1.4801250000000001, 1.47790625, 1.4625468750000001, 1.466875, 1.4737968750000001, 1.469390625, 1.46365625, 1.473390625, 1.4585468750000001, 1.48253125, 1.4737968750000001, 1.47871875, 1.472796875, 1.4780156249999998, 1.4688750000000002, 1.468984375, 1.448734375, 1.480828125, 1.48353125, 1.4528124999999998, 1.470875, 1.4801250000000001, 1.4648750000000001, 1.483125, 1.47871875, 1.4845312499999999, 1.477203125, 1.47790625, 1.47028125, 1.4701718750000001, 1.460140625, 1.4807187499999999], "episode_lengths": [75, 49, 130, 37, 39, 48, 64, 36, 44, 43, 69, 425, 34, 37, 37, 83, 33, 26, 68, 33, 46, 39, 19, 55, 32, 62, 37, 163, 28, 37, 32, 84, 68, 40, 34, 28, 27, 17, 79, 38, 43, 32, 47, 30, 29, 30, 46, 23, 69, 44, 60, 22, 18, 39, 29, 25, 38, 20, 39, 37, 63, 22, 24, 46, 34, 49, 23, 34, 24, 30, 49, 40, 33, 35, 46, 35, 49, 22, 33, 26, 33, 27, 40, 37, 53, 23, 22, 60, 40, 24, 40, 24, 26, 22, 31, 30, 38, 41, 51, 26], "policy_red_0_reward": [1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375, 1.140171875, 1.4730937499999999, 1.471984375, 1.471984375, 1.4346406250000001, 1.471796875, 1.4807187499999999, 1.4481875, 1.474796875, 1.46665625, 1.468578125, 1.484640625, 1.452328125, 1.4775, 1.45040625, 1.470984375, 1.362390625, 1.4773125, 1.466984375, 1.4765000000000001, 1.4359375, 1.4491874999999999, 1.467875, 1.47409375, 1.4763125000000001, 1.480015625, 1.488046875, 1.4324531249999999, 1.46828125, 1.465765625, 1.4725000000000001, 1.460953125, 1.47490625, 1.476609375, 1.47490625, 1.46365625, 1.483828125, 1.4424843749999998, 1.4610625000000002, 1.4478125, 1.48153125, 1.48534375, 1.469578125, 1.476609375, 1.481421875, 1.47128125, 1.4849375, 1.468578125, 1.4699843750000001, 1.449703125, 1.48153125, 1.483125, 1.46665625, 1.47509375, 1.461546875, 1.4828281250000002, 1.47509375, 1.4801250000000001, 1.47790625, 1.4625468750000001, 1.466875, 1.4737968750000001, 1.469390625, 1.46365625, 1.473390625, 1.4585468750000001, 1.48253125, 1.4737968750000001, 1.47871875, 1.472796875, 1.4780156249999998, 1.4688750000000002, 1.468984375, 1.448734375, 1.480828125, 1.48353125, 1.4528124999999998, 1.470875, 1.4801250000000001, 1.4648750000000001, 1.483125, 1.47871875, 1.4845312499999999, 1.477203125, 1.47790625, 1.47028125, 1.4701718750000001, 1.460140625, 1.4807187499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4248851792624256, "mean_inference_ms": 1.8159632276653508, "mean_action_processing_ms": 0.10747933334959978, "mean_env_wait_ms": 0.16589518743855472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10336518287658691, "StateBufferConnector_ms": 0.008940458297729492, "ViewRequirementAgentConnector_ms": 0.11987495422363281}}, "episode_reward_max": 1.488046875, "episode_reward_min": 1.140171875, "episode_reward_mean": 1.4639493749999999, "episode_len_mean": 45.0, "episodes_this_iter": 89, "policy_reward_min": {"red_0": 1.140171875}, "policy_reward_max": {"red_0": 1.488046875}, "policy_reward_mean": {"red_0": 1.4639493749999999}, "hist_stats": {"episode_reward": [1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375, 1.140171875, 1.4730937499999999, 1.471984375, 1.471984375, 1.4346406250000001, 1.471796875, 1.4807187499999999, 1.4481875, 1.474796875, 1.46665625, 1.468578125, 1.484640625, 1.452328125, 1.4775, 1.45040625, 1.470984375, 1.362390625, 1.4773125, 1.466984375, 1.4765000000000001, 1.4359375, 1.4491874999999999, 1.467875, 1.47409375, 1.4763125000000001, 1.480015625, 1.488046875, 1.4324531249999999, 1.46828125, 1.465765625, 1.4725000000000001, 1.460953125, 1.47490625, 1.476609375, 1.47490625, 1.46365625, 1.483828125, 1.4424843749999998, 1.4610625000000002, 1.4478125, 1.48153125, 1.48534375, 1.469578125, 1.476609375, 1.481421875, 1.47128125, 1.4849375, 1.468578125, 1.4699843750000001, 1.449703125, 1.48153125, 1.483125, 1.46665625, 1.47509375, 1.461546875, 1.4828281250000002, 1.47509375, 1.4801250000000001, 1.47790625, 1.4625468750000001, 1.466875, 1.4737968750000001, 1.469390625, 1.46365625, 1.473390625, 1.4585468750000001, 1.48253125, 1.4737968750000001, 1.47871875, 1.472796875, 1.4780156249999998, 1.4688750000000002, 1.468984375, 1.448734375, 1.480828125, 1.48353125, 1.4528124999999998, 1.470875, 1.4801250000000001, 1.4648750000000001, 1.483125, 1.47871875, 1.4845312499999999, 1.477203125, 1.47790625, 1.47028125, 1.4701718750000001, 1.460140625, 1.4807187499999999], "episode_lengths": [75, 49, 130, 37, 39, 48, 64, 36, 44, 43, 69, 425, 34, 37, 37, 83, 33, 26, 68, 33, 46, 39, 19, 55, 32, 62, 37, 163, 28, 37, 32, 84, 68, 40, 34, 28, 27, 17, 79, 38, 43, 32, 47, 30, 29, 30, 46, 23, 69, 44, 60, 22, 18, 39, 29, 25, 38, 20, 39, 37, 63, 22, 24, 46, 34, 49, 23, 34, 24, 30, 49, 40, 33, 35, 46, 35, 49, 22, 33, 26, 33, 27, 40, 37, 53, 23, 22, 60, 40, 24, 40, 24, 26, 22, 31, 30, 38, 41, 51, 26], "policy_red_0_reward": [1.4362656249999999, 1.4585468750000001, 1.40059375, 1.4699843750000001, 1.468578125, 1.46425, 1.45, 1.4736875, 1.4630625, 1.4667656249999999, 1.445484375, 1.140171875, 1.4730937499999999, 1.471984375, 1.471984375, 1.4346406250000001, 1.471796875, 1.4807187499999999, 1.4481875, 1.474796875, 1.46665625, 1.468578125, 1.484640625, 1.452328125, 1.4775, 1.45040625, 1.470984375, 1.362390625, 1.4773125, 1.466984375, 1.4765000000000001, 1.4359375, 1.4491874999999999, 1.467875, 1.47409375, 1.4763125000000001, 1.480015625, 1.488046875, 1.4324531249999999, 1.46828125, 1.465765625, 1.4725000000000001, 1.460953125, 1.47490625, 1.476609375, 1.47490625, 1.46365625, 1.483828125, 1.4424843749999998, 1.4610625000000002, 1.4478125, 1.48153125, 1.48534375, 1.469578125, 1.476609375, 1.481421875, 1.47128125, 1.4849375, 1.468578125, 1.4699843750000001, 1.449703125, 1.48153125, 1.483125, 1.46665625, 1.47509375, 1.461546875, 1.4828281250000002, 1.47509375, 1.4801250000000001, 1.47790625, 1.4625468750000001, 1.466875, 1.4737968750000001, 1.469390625, 1.46365625, 1.473390625, 1.4585468750000001, 1.48253125, 1.4737968750000001, 1.47871875, 1.472796875, 1.4780156249999998, 1.4688750000000002, 1.468984375, 1.448734375, 1.480828125, 1.48353125, 1.4528124999999998, 1.470875, 1.4801250000000001, 1.4648750000000001, 1.483125, 1.47871875, 1.4845312499999999, 1.477203125, 1.47790625, 1.47028125, 1.4701718750000001, 1.460140625, 1.4807187499999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4248851792624256, "mean_inference_ms": 1.8159632276653508, "mean_action_processing_ms": 0.10747933334959978, "mean_env_wait_ms": 0.16589518743855472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10336518287658691, "StateBufferConnector_ms": 0.008940458297729492, "ViewRequirementAgentConnector_ms": 0.11987495422363281}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.66000434199, "num_env_steps_trained_throughput_per_sec": 228.66000434199, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 17723.854, "sample_time_ms": 10267.077, "learn_time_ms": 7412.743, "learn_throughput": 539.611, "synch_weights_time_ms": 43.335}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 344, "training_iteration": 24, "trial_id": "60c49_00000", "date": "2023-09-10_12-16-59", "timestamp": 1694362619, "time_this_iter_s": 17.50243616104126, "time_total_s": 420.3166332244873, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x134062af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 420.3166332244873, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 31.135714285714283}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8632748836651445, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0030648386159252065, "policy_loss": -0.02068659185776293, "vf_loss": 0.014215208960861977, "vf_explained_var": 0.7323789368694027, "kl": 0.017032720735634634, "entropy": 1.1832644534607728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 1.48875, "episode_reward_min": 0.9658437499999999, "episode_reward_mean": 1.46940368852459, "episode_len_mean": 37.63934426229508, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {"red_0": 0.9658437499999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.46940368852459}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.46065625, 1.465578125, 1.478609375, 1.46828125, 1.4849375, 1.4783125, 1.4845312499999999, 1.478609375, 1.46325, 1.4716875, 1.476203125, 1.488046875, 1.474796875, 1.485234375, 1.476203125, 1.4773125, 1.4705, 1.4621718750000001, 1.481421875, 1.481421875, 1.4845312499999999, 1.4629531249999999, 1.4743906249999998, 1.474796875, 1.4828281250000002, 1.4549218750000001, 1.4769062499999999, 1.4807187499999999, 1.482125, 1.480828125, 1.48171875, 1.45984375, 1.4794218749999999, 1.4793125, 1.473390625, 1.47771875, 1.471984375, 1.479015625, 1.485640625, 1.249328125, 1.4610625000000002, 1.4726875000000001, 1.47971875, 1.480015625, 1.484640625, 1.482125, 1.441890625, 1.478421875, 1.484234375, 1.48171875, 1.4769062499999999, 1.468578125, 1.478421875, 1.4807187499999999, 1.485640625, 1.4828281250000002, 1.4703906249999998, 1.45703125, 1.480421875, 1.48875, 1.4829375, 1.47590625, 1.4753125, 1.479015625, 1.472984375, 1.47790625, 1.476203125, 1.4801250000000001, 1.459359375, 1.481421875, 1.479015625, 1.4753125, 1.470984375, 1.4666875, 1.472390625, 1.47771875, 1.4699843750000001, 1.483828125, 1.4654687499999999, 1.47971875, 1.477203125, 1.460546875, 1.47409375, 1.4807187499999999, 1.474796875, 1.476203125, 1.4648750000000001, 0.9658437499999999, 1.471578125, 1.482125, 1.4828281250000002, 1.477203125, 1.4870468749999999, 1.481015625, 1.4706875, 1.482125, 1.4755, 1.483828125, 1.484234375, 1.488046875, 1.47590625, 1.4828281250000002, 1.479015625, 1.4859375, 1.48253125, 1.4735, 1.4794218749999999, 1.472796875, 1.480421875, 1.4699843750000001, 1.476203125, 1.471390625, 1.4773125, 1.485640625, 1.48353125, 1.3669375000000001, 1.47209375, 1.46446875, 1.48253125, 1.482125, 1.475796875, 1.4877500000000001], "episode_lengths": [46, 39, 29, 38, 20, 28, 22, 29, 48, 36, 31, 17, 33, 21, 31, 28, 32, 41, 25, 25, 22, 47, 35, 33, 23, 57, 30, 26, 24, 23, 26, 50, 25, 28, 35, 26, 37, 27, 19, 247, 44, 36, 26, 27, 19, 24, 67, 25, 21, 26, 30, 39, 25, 26, 19, 23, 35, 54, 25, 16, 20, 30, 28, 27, 37, 30, 31, 24, 45, 25, 27, 28, 37, 36, 35, 26, 37, 23, 42, 26, 31, 49, 34, 26, 33, 31, 40, 626, 39, 24, 23, 31, 17, 27, 36, 24, 32, 23, 21, 17, 30, 23, 27, 20, 22, 32, 25, 33, 25, 37, 31, 35, 28, 19, 22, 148, 34, 42, 22, 24, 33, 16], "policy_red_0_reward": [1.46065625, 1.465578125, 1.478609375, 1.46828125, 1.4849375, 1.4783125, 1.4845312499999999, 1.478609375, 1.46325, 1.4716875, 1.476203125, 1.488046875, 1.474796875, 1.485234375, 1.476203125, 1.4773125, 1.4705, 1.4621718750000001, 1.481421875, 1.481421875, 1.4845312499999999, 1.4629531249999999, 1.4743906249999998, 1.474796875, 1.4828281250000002, 1.4549218750000001, 1.4769062499999999, 1.4807187499999999, 1.482125, 1.480828125, 1.48171875, 1.45984375, 1.4794218749999999, 1.4793125, 1.473390625, 1.47771875, 1.471984375, 1.479015625, 1.485640625, 1.249328125, 1.4610625000000002, 1.4726875000000001, 1.47971875, 1.480015625, 1.484640625, 1.482125, 1.441890625, 1.478421875, 1.484234375, 1.48171875, 1.4769062499999999, 1.468578125, 1.478421875, 1.4807187499999999, 1.485640625, 1.4828281250000002, 1.4703906249999998, 1.45703125, 1.480421875, 1.48875, 1.4829375, 1.47590625, 1.4753125, 1.479015625, 1.472984375, 1.47790625, 1.476203125, 1.4801250000000001, 1.459359375, 1.481421875, 1.479015625, 1.4753125, 1.470984375, 1.4666875, 1.472390625, 1.47771875, 1.4699843750000001, 1.483828125, 1.4654687499999999, 1.47971875, 1.477203125, 1.460546875, 1.47409375, 1.4807187499999999, 1.474796875, 1.476203125, 1.4648750000000001, 0.9658437499999999, 1.471578125, 1.482125, 1.4828281250000002, 1.477203125, 1.4870468749999999, 1.481015625, 1.4706875, 1.482125, 1.4755, 1.483828125, 1.484234375, 1.488046875, 1.47590625, 1.4828281250000002, 1.479015625, 1.4859375, 1.48253125, 1.4735, 1.4794218749999999, 1.472796875, 1.480421875, 1.4699843750000001, 1.476203125, 1.471390625, 1.4773125, 1.485640625, 1.48353125, 1.3669375000000001, 1.47209375, 1.46446875, 1.48253125, 1.482125, 1.475796875, 1.4877500000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42583664112874264, "mean_inference_ms": 1.8249683302777624, "mean_action_processing_ms": 0.10759883339864053, "mean_env_wait_ms": 0.16637379003062236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10363606155895796, "StateBufferConnector_ms": 0.008420084343581904, "ViewRequirementAgentConnector_ms": 0.12083288098944993}}, "episode_reward_max": 1.48875, "episode_reward_min": 0.9658437499999999, "episode_reward_mean": 1.46940368852459, "episode_len_mean": 37.63934426229508, "episodes_this_iter": 122, "policy_reward_min": {"red_0": 0.9658437499999999}, "policy_reward_max": {"red_0": 1.48875}, "policy_reward_mean": {"red_0": 1.46940368852459}, "hist_stats": {"episode_reward": [1.46065625, 1.465578125, 1.478609375, 1.46828125, 1.4849375, 1.4783125, 1.4845312499999999, 1.478609375, 1.46325, 1.4716875, 1.476203125, 1.488046875, 1.474796875, 1.485234375, 1.476203125, 1.4773125, 1.4705, 1.4621718750000001, 1.481421875, 1.481421875, 1.4845312499999999, 1.4629531249999999, 1.4743906249999998, 1.474796875, 1.4828281250000002, 1.4549218750000001, 1.4769062499999999, 1.4807187499999999, 1.482125, 1.480828125, 1.48171875, 1.45984375, 1.4794218749999999, 1.4793125, 1.473390625, 1.47771875, 1.471984375, 1.479015625, 1.485640625, 1.249328125, 1.4610625000000002, 1.4726875000000001, 1.47971875, 1.480015625, 1.484640625, 1.482125, 1.441890625, 1.478421875, 1.484234375, 1.48171875, 1.4769062499999999, 1.468578125, 1.478421875, 1.4807187499999999, 1.485640625, 1.4828281250000002, 1.4703906249999998, 1.45703125, 1.480421875, 1.48875, 1.4829375, 1.47590625, 1.4753125, 1.479015625, 1.472984375, 1.47790625, 1.476203125, 1.4801250000000001, 1.459359375, 1.481421875, 1.479015625, 1.4753125, 1.470984375, 1.4666875, 1.472390625, 1.47771875, 1.4699843750000001, 1.483828125, 1.4654687499999999, 1.47971875, 1.477203125, 1.460546875, 1.47409375, 1.4807187499999999, 1.474796875, 1.476203125, 1.4648750000000001, 0.9658437499999999, 1.471578125, 1.482125, 1.4828281250000002, 1.477203125, 1.4870468749999999, 1.481015625, 1.4706875, 1.482125, 1.4755, 1.483828125, 1.484234375, 1.488046875, 1.47590625, 1.4828281250000002, 1.479015625, 1.4859375, 1.48253125, 1.4735, 1.4794218749999999, 1.472796875, 1.480421875, 1.4699843750000001, 1.476203125, 1.471390625, 1.4773125, 1.485640625, 1.48353125, 1.3669375000000001, 1.47209375, 1.46446875, 1.48253125, 1.482125, 1.475796875, 1.4877500000000001], "episode_lengths": [46, 39, 29, 38, 20, 28, 22, 29, 48, 36, 31, 17, 33, 21, 31, 28, 32, 41, 25, 25, 22, 47, 35, 33, 23, 57, 30, 26, 24, 23, 26, 50, 25, 28, 35, 26, 37, 27, 19, 247, 44, 36, 26, 27, 19, 24, 67, 25, 21, 26, 30, 39, 25, 26, 19, 23, 35, 54, 25, 16, 20, 30, 28, 27, 37, 30, 31, 24, 45, 25, 27, 28, 37, 36, 35, 26, 37, 23, 42, 26, 31, 49, 34, 26, 33, 31, 40, 626, 39, 24, 23, 31, 17, 27, 36, 24, 32, 23, 21, 17, 30, 23, 27, 20, 22, 32, 25, 33, 25, 37, 31, 35, 28, 19, 22, 148, 34, 42, 22, 24, 33, 16], "policy_red_0_reward": [1.46065625, 1.465578125, 1.478609375, 1.46828125, 1.4849375, 1.4783125, 1.4845312499999999, 1.478609375, 1.46325, 1.4716875, 1.476203125, 1.488046875, 1.474796875, 1.485234375, 1.476203125, 1.4773125, 1.4705, 1.4621718750000001, 1.481421875, 1.481421875, 1.4845312499999999, 1.4629531249999999, 1.4743906249999998, 1.474796875, 1.4828281250000002, 1.4549218750000001, 1.4769062499999999, 1.4807187499999999, 1.482125, 1.480828125, 1.48171875, 1.45984375, 1.4794218749999999, 1.4793125, 1.473390625, 1.47771875, 1.471984375, 1.479015625, 1.485640625, 1.249328125, 1.4610625000000002, 1.4726875000000001, 1.47971875, 1.480015625, 1.484640625, 1.482125, 1.441890625, 1.478421875, 1.484234375, 1.48171875, 1.4769062499999999, 1.468578125, 1.478421875, 1.4807187499999999, 1.485640625, 1.4828281250000002, 1.4703906249999998, 1.45703125, 1.480421875, 1.48875, 1.4829375, 1.47590625, 1.4753125, 1.479015625, 1.472984375, 1.47790625, 1.476203125, 1.4801250000000001, 1.459359375, 1.481421875, 1.479015625, 1.4753125, 1.470984375, 1.4666875, 1.472390625, 1.47771875, 1.4699843750000001, 1.483828125, 1.4654687499999999, 1.47971875, 1.477203125, 1.460546875, 1.47409375, 1.4807187499999999, 1.474796875, 1.476203125, 1.4648750000000001, 0.9658437499999999, 1.471578125, 1.482125, 1.4828281250000002, 1.477203125, 1.4870468749999999, 1.481015625, 1.4706875, 1.482125, 1.4755, 1.483828125, 1.484234375, 1.488046875, 1.47590625, 1.4828281250000002, 1.479015625, 1.4859375, 1.48253125, 1.4735, 1.4794218749999999, 1.472796875, 1.480421875, 1.4699843750000001, 1.476203125, 1.471390625, 1.4773125, 1.485640625, 1.48353125, 1.3669375000000001, 1.47209375, 1.46446875, 1.48253125, 1.482125, 1.475796875, 1.4877500000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42583664112874264, "mean_inference_ms": 1.8249683302777624, "mean_action_processing_ms": 0.10759883339864053, "mean_env_wait_ms": 0.16637379003062236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10363606155895796, "StateBufferConnector_ms": 0.008420084343581904, "ViewRequirementAgentConnector_ms": 0.12083288098944993}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.425608530423, "num_env_steps_trained_throughput_per_sec": 224.425608530423, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 17817.959, "sample_time_ms": 10315.888, "learn_time_ms": 7457.776, "learn_throughput": 536.353, "synch_weights_time_ms": 43.595}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 466, "training_iteration": 25, "trial_id": "60c49_00000", "date": "2023-09-10_12-17-19", "timestamp": 1694362639, "time_this_iter_s": 17.833628177642822, "time_total_s": 438.1502614021301, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x133fabd30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 438.1502614021301, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.83103448275862, "ram_util_percent": 31.13793103448276}}
{"custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.745357086509466, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01737380031942545, "policy_loss": -0.03035102044013911, "vf_loss": 0.00915008239535382, "vf_explained_var": 0.7831429456671078, "kl": 0.019135688643055655, "entropy": 1.0502924642215172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 1.49015625, "episode_reward_min": 1.40709375, "episode_reward_mean": 1.4778356604609928, "episode_len_mean": 27.851063829787233, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {"red_0": 1.40709375}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4778356604609928}, "custom_metrics": {"red_0/door_open_done_mean": 1.0, "red_0/door_open_done_min": 1, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [1.45646875, 1.47771875, 1.475609375, 1.4783125, 1.476203125, 1.4828281250000002, 1.47209375, 1.475796875, 1.479125, 1.476796875, 1.4610625000000002, 1.4783125, 1.4870468749999999, 1.475609375, 1.4807187499999999, 1.485640625, 1.481421875, 1.480828125, 1.4828281250000002, 1.48153125, 1.4699843750000001, 1.480828125, 1.47971875, 1.450515625, 1.4819375, 1.4769062499999999, 1.4733125, 1.4859375, 1.488453125, 1.4859375, 1.4832343749999999, 1.476203125, 1.48734375, 1.4705781249999998, 1.4807187499999999, 1.478421875, 1.484234375, 1.481125, 1.4807187499999999, 1.472796875, 1.4737968750000001, 1.482421875, 1.488453125, 1.463875, 1.48634375, 1.4832343749999999, 1.481421875, 1.485234375, 1.4866406250000002, 1.480015625, 1.483828125, 1.4769062499999999, 1.4780156249999998, 1.4829375, 1.476203125, 1.48171875, 1.478421875, 1.47490625, 1.48734375, 1.4725000000000001, 1.473609375, 1.4828281250000002, 1.4773125, 1.468984375, 1.4775, 1.4783125, 1.485640625, 1.480421875, 1.4692812499999999, 1.485640625, 1.47790625, 1.48734375, 1.485640625, 1.47590625, 1.468578125, 1.40709375, 1.47028125, 1.4663593750000001, 1.4725000000000001, 1.479015625, 1.4755, 1.47490625, 1.4807187499999999, 1.48634375, 1.488046875, 1.4845312499999999, 1.48634375, 1.475796875, 1.4486249999999998, 1.47971875, 1.4699843750000001, 1.475609375, 1.4849375, 1.463359375, 1.482421875, 1.488046875, 1.482125, 1.475203125, 1.48171875, 1.484234375, 1.48875, 1.4773125, 1.4776093750000001, 1.480828125, 1.4743906249999998, 1.465171875, 1.4849375, 1.472390625, 1.478609375, 1.45965625, 1.479125, 1.488046875, 1.48634375, 1.474609375, 1.49015625, 1.484640625, 1.46828125, 1.4730937499999999, 1.4745, 1.47790625, 1.478421875, 1.4735, 1.484640625, 1.4839375000000001, 1.47590625, 1.4591406249999999, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.485640625, 1.483125, 1.4807187499999999, 1.4746875, 1.4828281250000002, 1.4794218749999999, 1.476015625, 1.48153125, 1.486046875, 1.4769062499999999, 1.476609375, 1.48875], "episode_lengths": [42, 26, 29, 28, 31, 23, 34, 33, 24, 33, 44, 28, 17, 29, 26, 19, 25, 23, 23, 22, 37, 23, 26, 59, 20, 30, 28, 20, 15, 20, 21, 31, 18, 39, 26, 25, 21, 24, 26, 33, 33, 25, 15, 40, 18, 21, 25, 21, 19, 27, 23, 30, 27, 20, 31, 26, 25, 30, 18, 32, 29, 23, 28, 37, 32, 28, 19, 25, 38, 19, 30, 18, 19, 30, 39, 98, 38, 45, 32, 27, 32, 30, 26, 18, 17, 22, 18, 33, 56, 26, 37, 29, 20, 45, 25, 17, 24, 31, 26, 21, 16, 28, 29, 23, 35, 41, 20, 35, 29, 46, 24, 17, 18, 29, 14, 19, 38, 34, 32, 30, 25, 32, 19, 20, 30, 51, 17, 36, 32, 19, 24, 26, 36, 23, 25, 27, 22, 17, 30, 29, 16], "policy_red_0_reward": [1.45646875, 1.47771875, 1.475609375, 1.4783125, 1.476203125, 1.4828281250000002, 1.47209375, 1.475796875, 1.479125, 1.476796875, 1.4610625000000002, 1.4783125, 1.4870468749999999, 1.475609375, 1.4807187499999999, 1.485640625, 1.481421875, 1.480828125, 1.4828281250000002, 1.48153125, 1.4699843750000001, 1.480828125, 1.47971875, 1.450515625, 1.4819375, 1.4769062499999999, 1.4733125, 1.4859375, 1.488453125, 1.4859375, 1.4832343749999999, 1.476203125, 1.48734375, 1.4705781249999998, 1.4807187499999999, 1.478421875, 1.484234375, 1.481125, 1.4807187499999999, 1.472796875, 1.4737968750000001, 1.482421875, 1.488453125, 1.463875, 1.48634375, 1.4832343749999999, 1.481421875, 1.485234375, 1.4866406250000002, 1.480015625, 1.483828125, 1.4769062499999999, 1.4780156249999998, 1.4829375, 1.476203125, 1.48171875, 1.478421875, 1.47490625, 1.48734375, 1.4725000000000001, 1.473609375, 1.4828281250000002, 1.4773125, 1.468984375, 1.4775, 1.4783125, 1.485640625, 1.480421875, 1.4692812499999999, 1.485640625, 1.47790625, 1.48734375, 1.485640625, 1.47590625, 1.468578125, 1.40709375, 1.47028125, 1.4663593750000001, 1.4725000000000001, 1.479015625, 1.4755, 1.47490625, 1.4807187499999999, 1.48634375, 1.488046875, 1.4845312499999999, 1.48634375, 1.475796875, 1.4486249999999998, 1.47971875, 1.4699843750000001, 1.475609375, 1.4849375, 1.463359375, 1.482421875, 1.488046875, 1.482125, 1.475203125, 1.48171875, 1.484234375, 1.48875, 1.4773125, 1.4776093750000001, 1.480828125, 1.4743906249999998, 1.465171875, 1.4849375, 1.472390625, 1.478609375, 1.45965625, 1.479125, 1.488046875, 1.48634375, 1.474609375, 1.49015625, 1.484640625, 1.46828125, 1.4730937499999999, 1.4745, 1.47790625, 1.478421875, 1.4735, 1.484640625, 1.4839375000000001, 1.47590625, 1.4591406249999999, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.485640625, 1.483125, 1.4807187499999999, 1.4746875, 1.4828281250000002, 1.4794218749999999, 1.476015625, 1.48153125, 1.486046875, 1.4769062499999999, 1.476609375, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42850352158931443, "mean_inference_ms": 1.8255698223570636, "mean_action_processing_ms": 0.10780138986917392, "mean_env_wait_ms": 0.1670388908647308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10477566549963985, "StateBufferConnector_ms": 0.008541641505897467, "ViewRequirementAgentConnector_ms": 0.12464844588692306}}, "episode_reward_max": 1.49015625, "episode_reward_min": 1.40709375, "episode_reward_mean": 1.4778356604609928, "episode_len_mean": 27.851063829787233, "episodes_this_iter": 141, "policy_reward_min": {"red_0": 1.40709375}, "policy_reward_max": {"red_0": 1.49015625}, "policy_reward_mean": {"red_0": 1.4778356604609928}, "hist_stats": {"episode_reward": [1.45646875, 1.47771875, 1.475609375, 1.4783125, 1.476203125, 1.4828281250000002, 1.47209375, 1.475796875, 1.479125, 1.476796875, 1.4610625000000002, 1.4783125, 1.4870468749999999, 1.475609375, 1.4807187499999999, 1.485640625, 1.481421875, 1.480828125, 1.4828281250000002, 1.48153125, 1.4699843750000001, 1.480828125, 1.47971875, 1.450515625, 1.4819375, 1.4769062499999999, 1.4733125, 1.4859375, 1.488453125, 1.4859375, 1.4832343749999999, 1.476203125, 1.48734375, 1.4705781249999998, 1.4807187499999999, 1.478421875, 1.484234375, 1.481125, 1.4807187499999999, 1.472796875, 1.4737968750000001, 1.482421875, 1.488453125, 1.463875, 1.48634375, 1.4832343749999999, 1.481421875, 1.485234375, 1.4866406250000002, 1.480015625, 1.483828125, 1.4769062499999999, 1.4780156249999998, 1.4829375, 1.476203125, 1.48171875, 1.478421875, 1.47490625, 1.48734375, 1.4725000000000001, 1.473609375, 1.4828281250000002, 1.4773125, 1.468984375, 1.4775, 1.4783125, 1.485640625, 1.480421875, 1.4692812499999999, 1.485640625, 1.47790625, 1.48734375, 1.485640625, 1.47590625, 1.468578125, 1.40709375, 1.47028125, 1.4663593750000001, 1.4725000000000001, 1.479015625, 1.4755, 1.47490625, 1.4807187499999999, 1.48634375, 1.488046875, 1.4845312499999999, 1.48634375, 1.475796875, 1.4486249999999998, 1.47971875, 1.4699843750000001, 1.475609375, 1.4849375, 1.463359375, 1.482421875, 1.488046875, 1.482125, 1.475203125, 1.48171875, 1.484234375, 1.48875, 1.4773125, 1.4776093750000001, 1.480828125, 1.4743906249999998, 1.465171875, 1.4849375, 1.472390625, 1.478609375, 1.45965625, 1.479125, 1.488046875, 1.48634375, 1.474609375, 1.49015625, 1.484640625, 1.46828125, 1.4730937499999999, 1.4745, 1.47790625, 1.478421875, 1.4735, 1.484640625, 1.4839375000000001, 1.47590625, 1.4591406249999999, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.485640625, 1.483125, 1.4807187499999999, 1.4746875, 1.4828281250000002, 1.4794218749999999, 1.476015625, 1.48153125, 1.486046875, 1.4769062499999999, 1.476609375, 1.48875], "episode_lengths": [42, 26, 29, 28, 31, 23, 34, 33, 24, 33, 44, 28, 17, 29, 26, 19, 25, 23, 23, 22, 37, 23, 26, 59, 20, 30, 28, 20, 15, 20, 21, 31, 18, 39, 26, 25, 21, 24, 26, 33, 33, 25, 15, 40, 18, 21, 25, 21, 19, 27, 23, 30, 27, 20, 31, 26, 25, 30, 18, 32, 29, 23, 28, 37, 32, 28, 19, 25, 38, 19, 30, 18, 19, 30, 39, 98, 38, 45, 32, 27, 32, 30, 26, 18, 17, 22, 18, 33, 56, 26, 37, 29, 20, 45, 25, 17, 24, 31, 26, 21, 16, 28, 29, 23, 35, 41, 20, 35, 29, 46, 24, 17, 18, 29, 14, 19, 38, 34, 32, 30, 25, 32, 19, 20, 30, 51, 17, 36, 32, 19, 24, 26, 36, 23, 25, 27, 22, 17, 30, 29, 16], "policy_red_0_reward": [1.45646875, 1.47771875, 1.475609375, 1.4783125, 1.476203125, 1.4828281250000002, 1.47209375, 1.475796875, 1.479125, 1.476796875, 1.4610625000000002, 1.4783125, 1.4870468749999999, 1.475609375, 1.4807187499999999, 1.485640625, 1.481421875, 1.480828125, 1.4828281250000002, 1.48153125, 1.4699843750000001, 1.480828125, 1.47971875, 1.450515625, 1.4819375, 1.4769062499999999, 1.4733125, 1.4859375, 1.488453125, 1.4859375, 1.4832343749999999, 1.476203125, 1.48734375, 1.4705781249999998, 1.4807187499999999, 1.478421875, 1.484234375, 1.481125, 1.4807187499999999, 1.472796875, 1.4737968750000001, 1.482421875, 1.488453125, 1.463875, 1.48634375, 1.4832343749999999, 1.481421875, 1.485234375, 1.4866406250000002, 1.480015625, 1.483828125, 1.4769062499999999, 1.4780156249999998, 1.4829375, 1.476203125, 1.48171875, 1.478421875, 1.47490625, 1.48734375, 1.4725000000000001, 1.473609375, 1.4828281250000002, 1.4773125, 1.468984375, 1.4775, 1.4783125, 1.485640625, 1.480421875, 1.4692812499999999, 1.485640625, 1.47790625, 1.48734375, 1.485640625, 1.47590625, 1.468578125, 1.40709375, 1.47028125, 1.4663593750000001, 1.4725000000000001, 1.479015625, 1.4755, 1.47490625, 1.4807187499999999, 1.48634375, 1.488046875, 1.4845312499999999, 1.48634375, 1.475796875, 1.4486249999999998, 1.47971875, 1.4699843750000001, 1.475609375, 1.4849375, 1.463359375, 1.482421875, 1.488046875, 1.482125, 1.475203125, 1.48171875, 1.484234375, 1.48875, 1.4773125, 1.4776093750000001, 1.480828125, 1.4743906249999998, 1.465171875, 1.4849375, 1.472390625, 1.478609375, 1.45965625, 1.479125, 1.488046875, 1.48634375, 1.474609375, 1.49015625, 1.484640625, 1.46828125, 1.4730937499999999, 1.4745, 1.47790625, 1.478421875, 1.4735, 1.484640625, 1.4839375000000001, 1.47590625, 1.4591406249999999, 1.488046875, 1.4726875000000001, 1.4725000000000001, 1.485640625, 1.483125, 1.4807187499999999, 1.4746875, 1.4828281250000002, 1.4794218749999999, 1.476015625, 1.48153125, 1.486046875, 1.4769062499999999, 1.476609375, 1.48875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.42850352158931443, "mean_inference_ms": 1.8255698223570636, "mean_action_processing_ms": 0.10780138986917392, "mean_env_wait_ms": 0.1670388908647308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10477566549963985, "StateBufferConnector_ms": 0.008541641505897467, "ViewRequirementAgentConnector_ms": 0.12464844588692306}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.59076734329236, "num_env_steps_trained_throughput_per_sec": 224.59076734329236, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 17831.295, "sample_time_ms": 10350.291, "learn_time_ms": 7436.799, "learn_throughput": 537.866, "synch_weights_time_ms": 43.503}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 607, "training_iteration": 26, "trial_id": "60c49_00000", "date": "2023-09-10_12-17-39", "timestamp": 1694362659, "time_this_iter_s": 17.823339700698853, "time_total_s": 455.973601102829, "pid": 78465, "hostname": "str-mac-3541", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.001}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x13410e790>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 455.973601102829, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 27.28275862068965, "ram_util_percent": 31.08275862068966}}
